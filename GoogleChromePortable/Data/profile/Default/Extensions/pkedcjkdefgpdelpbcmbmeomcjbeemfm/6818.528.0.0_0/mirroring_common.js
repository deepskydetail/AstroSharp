'use strict';var Mf;var Nf=chrome.i18n.getMessage("545449835455981095");r("mr.IssueSeverity",{Gt:"fatal",Ox:"warning",Av:"notification"});r("mr.IssueAction",{vt:"dismiss",Nu:"learn_more"});var Of=function(a,b){this.routeId=null;this.severity=b;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},Qf=function(){var a=new Of(Pf,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},Rf=function(a){a.isBlocking=!0;return a};var Sf=function(a,b){var c=this;this.f=void 0===b?null:b;this.b=new Promise(function(b,e){var d=function(a){c.f=null;e(a)};c.h=d;a(function(a){c.f=null;b(a)},d)})};Sf.prototype.cancel=function(a){this.h(a);if(this.f){var b=this.f;this.f=null;setTimeout(function(){return b(a)},0)}};var Tf=function(a,b,c){c=void 0===c?null:c;return new Sf(function(d,e){a.b.then(function(a){if(b)try{d(b(a))}catch(h){e(h)}else d(a)},function(a){if(c)try{d(c(a))}catch(h){e(h)}else e(a)})},function(b){a.cancel(b)})};
Sf.prototype.then=function(a,b){return Tf(this,a,void 0===b?null:b)};Sf.prototype.catch=function(a){return Tf(this,null,a)};var Uf=function(a){return new Sf(function(b){b(a)})},Vf=function(a){return new Sf(function(b,c){c(a)})},Wf=function(a){return new Sf(function(b,c){a.then(b,c)})},Xf=function(a,b){var c=!1,d=null;return new Sf(function(e,f){a.then(function(a){c||(d=b(a),d.b.then(e,f))},f)},function(a){d?d.cancel(a):c=!0})};var Yf={Is:0,Gs:1,Ks:2,Hs:3,hs:4,Js:5,hu:6,sx:7,pt:8,qk:9},Zf=function(a,b){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=b&&9>=b?b:9};l(Zf,Error);var $f=function(){var a=la(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},ag=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var bg=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=ag()),cg=["ChromeOS","Windows"].includes(ag());var dg=function(a,b,c,d){this.f=a;this.b=b;this.h=c||null;this.presentationId=d||null},gg=function(a,b){if("tab"==a.f)a=eg(a);else if("offscreen_tab"==a.f)b=eg(a),b.presentationId=a.presentationId,a=b;else{var c={audio:!1,video:!1};a.b.shouldCaptureVideo?(c.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b}},fg(a,c.video.mandatory),cg&&a.b.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:b}})):a.b.shouldCaptureAudio&&(c.audio={mandatory:{chromeMediaSource:"system"}});
a=c}return a},eg=function(a){var b={audio:a.b.shouldCaptureAudio,video:a.b.shouldCaptureVideo};a.b.shouldCaptureVideo&&(b.videoConstraints={mandatory:{enableAutoThrottling:!0}},fg(a,b.videoConstraints.mandatory));return b},fg=function(a,b){var c=a.b.minWidth,d=a.b.minHeight;if(a.b.senderSideLetterboxing){c=a.b;if(0==c.minHeight||0==c.maxHeight?0:Math.floor(100*c.minWidth/c.minHeight)==Math.floor(100*c.maxWidth/c.maxHeight))c={width:c.minWidth,height:c.minHeight};else{d=c.maxWidth;for(var e=c.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=c.maxWidth/d;d=c.maxHeight/d;if(e<c.minWidth||d<c.minHeight)if(f=Math.max(c.minWidth/e,c.minHeight/d),e*=f,d*=f,e>c.maxWidth||d>c.maxHeight)e=c.maxWidth,d=c.maxHeight;e=Math.round(e);d=Math.round(d);c={width:e,height:d}}d=c;c=d.width;d=d.height}Object.assign(b,{minWidth:c,minHeight:d,maxWidth:a.b.maxWidth,maxHeight:a.b.maxHeight,minFrameRate:a.b.minFrameRate,maxFrameRate:a.b.maxFrameRate})};var hg=function(a){this.b=a;this.f=this.Gf=null;this.l=vb("mr.mirror.MirrorMediaStream")};hg.prototype.start=function(){return"tab"==this.b.f?ig(this):"offscreen_tab"==this.b.f?jg(this):kg(this)};var ig=function(a){var b=gg(a.b);a.l.info("Starting tab capture with constraints "+JSON.stringify(b));return new Promise(function(c,d){chrome.tabCapture.capture(b,function(b){b?(lg(a,b),c(a)):d(mg())});window.setTimeout(function(){d(new Zf("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
hg.prototype.h=function(a){a&&this.l.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var mg=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Zf(chrome.runtime.lastError.message,7):new Zf("empty_stream",0)},og=function(){var a=void 0===a?6E4:a;return new Promise(function(b,c){var d=["screen","audio"];"Linux"==ag()&&d.push("window");var e=window.setTimeout(function(){f&&chrome.desktopCapture.cancelChooseDesktopMedia(f);c(new Zf("timeout",1))},a);var f=chrome.desktopCapture.chooseDesktopMedia(d,function(a){window.clearTimeout(e);a?b(a):c(new Zf("User cancelled capture dialog",
3))})})},pg=function(a,b){return new Promise(function(c,d){a.l.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(b)});navigator.mediaDevices.getUserMedia(b).then(function(b){b||d(new Zf("empty_stream",8));lg(a,b);c(b)},function(a){var b=8;"NotAllowedError"==a.name&&(b=3);d(new Zf(a.name+" "+a.constraintName+": "+a.message,b))})})},kg=function(a){return cg&&a.b.b.shouldCaptureAudio&&!a.b.b.shouldCaptureVideo?pg(a,gg(a.b)).then(function(){return a}):og().then(function(b){b=
gg(a.b,b);return pg(a,b).then(function(){return a})})},jg=function(a){var b=gg(a.b);a.l.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(b)});return new Promise(function(c,d){chrome.tabCapture.captureOffscreenTab(a.b.h.toString(),b,function(b){b?(lg(a,b),c(a)):d(mg())})})},lg=function(a,b){a.f=b;b.getAudioTracks().length||b.getVideoTracks();b.getTracks().forEach(function(b){b.onended=a.h.bind(a)})};
hg.prototype.stop=function(){this.f&&(this.f.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.f=null,this.Gf&&this.Gf())};var qg=function(){},ug=function(a){var b=rg.get(a)||null;if(b)return Promise.resolve(b);b=sg.get(a);b||(b=new Tb,sg.set(a,b),tg(a,b));return b.b},tg=function(a,b){var c=vg.get(a)||null;if(!c)b.reject(Error("No corresponding bundle for "+a));else if(!wg.has(c)){var d=xg.get(c);d||(yg.info("Loading bundle "+c+" for module "+a),d=zg(c),xg.set(c,d));d.catch(function(a){b.reject(a)})}},zg=function(a){var b=new Tb;b.b.then(function(){yg.info("Bundle "+a+" loaded")},function(b){yg.error("Failed to load bundle "+
a);throw b;});var c=document.createElement("script");c.src=chrome.extension.getURL(a);c.setAttribute("type","text/javascript");c.async=!0;c.onload=function(){return b.resolve(void 0)};c.onerror=function(){return b.reject(Error("Failed to load bundle "+a))};document.head.appendChild(c);return b.b},Ag=function(a,b){if(rg.has(a))throw Error("Duplicate module "+a);rg.set(a,b);(a=sg.get(a))&&a.resolve(b)};
qg.prototype.handleEvent=function(a,b){for(var c=1;c<arguments.length;++c);throw Error("Not implemented");};
var vg=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),wg=new Set(["background_script.js"]),yg=vb("mr.Module"),rg=new Map,sg=new Map,xg=new Map;var Bg,Cg={Vu:0,Ls:1,Ms:2,rt:3,st:4,Ot:5,iu:6,Tu:7,sv:8,tv:9,rw:10,Rw:11,Sw:12,dx:13,rx:14},Dg=function(a){void 0==Bg&&(Rb("MediaRouter.Provider.WakeEvent",a,Cg),Bg=a)};var Gg=function(a){return Eg(a)||Fg(a)},Hg=function(a){if(!a.startsWith("http:")&&!a.startsWith("https:"))return!1;var b=document.createElement("a");b.href=a;return"http:"!=b.protocol&&"https:"!=b.protocol?!1:-1==b.hash.indexOf("__castAppId__")},Ig=["https://docs.google.com"],Eg=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},Fg=function(a){return"urn:x-org.chromium.media:source:desktop"==a},Jg=function(a){var b=a.search("urn:x-org.chromium.media:source:tab:");
return-1==b?null:parseInt(a.substr(b+36),10)||null};var Kg=function(a,b){this.D=a;this.j=b||null;this.f=this.b=null;this.J=vb("mr.mirror.Service."+a);this.A=this.L.bind(this);this.g=!1};l(Kg,qg);Kg.prototype.Za=function(a){this.g||(this.j=a,this.g=!0,this.rh())};Kg.prototype.rh=function(){};Kg.prototype.getName=function(){return this.D};
var Og=function(a,b,c,d,e,f){a.J.info("Start mirroring on route "+b.id);if(!a.g)return Vf(Error("Not initialized"));var h=new Promise(function(h,n){Lg(a).then(function(){var a=Mg(c,d,e);return(new hg(a)).start()}).then(function(c){if(a.f)throw c.stop(),new Zf("Cannot start multiple streams");a.f=c;c=a.s.bind(a);a.f.Gf=c;return f?f(b).b:b}).then(function(b){if(a.b)throw new Zf("Cannot start multiple sessions");if(!a.f)throw new Zf("Media stream ended before session could start.");a.b=a.lh(d,b);b.zb.dc=
a.b.dc;b=a.j.nl.bind(a.j);a.b.la=b;return a.b.start(a.f.f)}).then(function(){Eg(c)&&!chrome.tabs.onUpdated.hasListener(a.A)&&chrome.tabs.onUpdated.addListener(a.A);return a.F(b,c,d)}).then(function(){h(b)}).catch(function(b){Ng(a,b);return a.s().then(function(){n(b)})})});return Wf(h)},Pg=function(a,b,c,d,e,f){if(!a.b)return Promise.reject(new Zf("No session to update streams on",7));if(!a.b.zm())return Promise.reject(new Zf("Session does not support updating stream",7));var h=!1;return new Promise(function(k,
n){var u=Mg(c,d,e);(new hg(u)).start().then(function(c){a.f&&(a.f.Gf=null,a.f.stop(),a.Eg());a.f=c;c=a.s.bind(a);a.f.Gf=c;h=!0;return f?f(b).b:b}).then(function(){if(!a.b)throw new Zf("Session ended while updating stream");if(!a.f)throw new Zf("Media stream ended before session could be updated.");return a.b.Dm(a.f.f)}).then(a.F.bind(a,b,c,d)).then(function(){return k(b)}).catch(function(b){Ng(a,b);if(h)return a.s().then(function(){n(b)});n(b)})})};
Kg.prototype.F=function(a,b,c){var d=this;return new Promise(function(e,f){d.b?(Eg(b)?(Qg(d.b,a.zb.tabId),d.Vh()):Hg(b)?(Qg(d.b,a.zb.tabId),d.uj()):d.Sh(),f=d.f,c.shouldCaptureAudio&&f.f&&!f.f.getAudioTracks().length&&d.j.xd(new Of(Nf,"notification")),Rg(d.b),e()):f(new Zf("Session gone before executing post-startup steps",7))})};
var Ng=function(a,b){b.reason=null!=b.reason?b.reason:9;a.J.error("Failed to start mirroring: "+b.message+(",  reason = "+b.reason+": "+b.stack));a.Uh(b.reason)},Lg=function(a){return a.g?a.s().then(function(b){b&&a.Th();return b}):Promise.reject("Not initialized")};
Kg.prototype.s=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.A);var b=this.f;this.f=null;b&&(b.Gf=null);var c=this.b;this.b=null;var d;c?d=this.oi(c).catch(function(b){return a.J.error("Error in before-cleanup steps",b)}).then(function(){return c.stop()}).catch(function(b){return a.J.error("Error stopping session",b)}).then(function(){a.j.ej(c.h.id)}).catch(function(b){return a.J.error("Error in ended callbacks",b)}).then(function(){return!0}):d=Promise.resolve(!1);b&&(d=d.then(function(c){b.stop();
a.Eg();return c}));return d};Kg.prototype.oi=function(){return Promise.resolve()};Kg.prototype.L=function(a,b,c){Dg(14);if(this.b){var d=this.b;a==d.tabId&&("complete"==b.status||b.favIconUrl&&"complete"==c.status)&&(d.u=c,Rg(d))}};var Mg=function(a,b,c){if(Eg(a))return new dg("tab",b);if(Fg(a))return new dg("desktop",b);if(Hg(a)){if(!c)throw new Zf("Missing offscreen tab presentation id");return new dg("offscreen_tab",b,a,c)}throw new Zf("Source URN does not suggest a known capture type.");};g=Kg.prototype;
g.lh=function(){};g.Vh=function(){};g.Sh=function(){};g.uj=function(){};g.Th=function(){};g.Uh=function(){};g.Eg=function(){};g.cj=function(){return sb()};g.createMediaRouteController=function(){return sb()};var Sg=function(a,b,c){this.f=a;this.g=b;this.b=void 0===c?null:c;this.h=null},Tg=function(a){switch(a.f){case "mirror_tab":return a.b?"Casting tab ("+a.b+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.b?"Casting media ("+a.b+")":"Casting media";case "presentation":return"Casting "+(a.b||"site");default:return""}},Ug=function(a){if(a.g)return"Casting active";switch(a.f){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var Vg=function(a){return(new Promise(function(b){chrome.tabs.get(a,b)})).then(function(b){if(!b)throw Error("No such tab "+a);return b})};var Wg=function(a,b){this.h=a;this.la=void 0===b?null:b;b=null;var c=a.mediaSource;if(Hg(c)){var d="presentation";b=(new URL(c)).origin}else Eg(c)?d="mirror_tab":Fg(c)&&(d="mirror_desktop");this.dc=new Sg(d,a.offTheRecord,b);this.u=this.tabId=null;this.L=!1},Qg=function(a,b){a.tabId!=b?(a.tabId=b,Vg(b).then(function(b){a.u=b;Rg(a)})):Promise.resolve()},Rg=function(a){if(a.u){a.dc.h=a.u.title;a.dc.g=a.u.incognito;var b=new URL(a.u.url);"file:"==b.protocol?(a.dc.f="mirror_file",a.dc.b=null):(a.dc.f=
a.L?"media_remoting":"mirror_tab",a.dc.b="https:"==b.protocol?b.origin.substr(8):b.origin)}a.h.description=Tg(a.dc);a.la&&a.la(a.h,a.dc);a.im()};g=Wg.prototype;g.start=function(){};g.zm=function(){return!1};g.Dm=function(){};g.stop=function(){return Promise.resolve()};g.im=function(){};var $g=function(){var a=this;this.maxWidth=1920;this.maxHeight=1080;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.maxLatencyMillis=800;this.animatedLatencyMillis=this.minLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(ag())||$f();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var b=window.localStorage?
window.localStorage.getItem(Xg):null;if(b)try{var c=JSON.parse(String(b));if(c instanceof Object)Yg(this,c),v(vb("mr.mirror.Settings"),function(){return"Initial mr.mirror.Settings overridden to: "+Zg(a)});else throw Error("localStorage["+Xg+"] "+("does not parse as an Object: "+b));}catch(d){throw vb("mr.mirror.Settings").error(Xg+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
$g.prototype.clone=function(){var a=new $g;Yg(a,this);return a};
var Zg=function(a){return JSON.stringify(a,function(a,c){if(0==a.length||!a.endsWith("_"))return c})},Yg=function(a,b){for(var c=la(Object.keys(b)),d=c.next();!d.done;d=c.next())d=d.value,d.endsWith("_")||typeof b[d]!==typeof a[d]||(a[d]=b[d])},ah=function(a){var b=screen.width,c=screen.height;a.maxHeight*b<a.maxWidth*c?(b=Math.min(a.maxWidth,b),b-=b%160,c=90*b/160):(c=Math.min(a.maxHeight,c),c-=c%90,b=160*c/90);if(b<Math.max(160,a.minWidth)||c<Math.max(90,a.minHeight))b=Math.max(160,a.minWidth),
c=Math.max(90,a.minHeight);a.maxWidth=b;a.maxHeight=c},Xg="mr.mirror.Settings.Overrides";var bh=function(a,b){this.type=a;this.data=b},ch=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new bh(a.type,a.data)},dh=function(a,b,c,d,e){this.description=a;this.settings=b||null;this.mediaConstraints=c||null;this.presentationUrl=d||null;this.presentationId=e||null};var gh=function(a,b){this.l=vb("cv2.PeerConnection");this.D=eh;this.b=fh(this,b);this.j=this.b.createDataChannel(a,{reliable:!1});this.C=new Tb;this.o=!1;this.g=0;this.h=null;this.u=this.s=0;this.f=!1;this.F=function(){};this.m=function(){};this.B=function(){};this.A=function(){}},hh=function(a,b){a.m=b},ih=function(a,b){a.B=b},jh=function(a,b){a.A=b},kh=function(a,b){a.F=b},lh=function(a,b){a.j.onmessage=function(a){b(a.data)}},mh=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return b},fh=function(a,b){var c=mh(b);b=new webkitRTCPeerConnection(c);b.onicecandidate=a.la.bind(a);b.b=a.M.bind(a);b.oniceconnectionstatechange=a.K.bind(a);a.l.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(c)});return b};gh.prototype.start=function(){this.f||(this.f=!0,nh(this))};gh.prototype.stop=function(){this.l.info("Stopping peer connection...");this.f&&(this.f=!1,"closed"!=this.b.signalingState&&this.b.close());this.b=null};
var nh=function(a){a.l.info("Sending offer to peer.");a.s=Date.now();a.b.createOffer(a.L.bind(a),function(b){v(a.l,"Error creating offer.",b)},a.D);a.C.b.then(function(b){a.F(b)})};gh.prototype.L=function(a){var b=this;this.l.info(function(){return"Setting local description: "+JSON.stringify(a)});this.b.setLocalDescription(a,function(){b.l.info("Local description set successfully")},function(a){v(b.l,"Error setting local description.",a)})};
var oh=function(a,b){Cb(a.l,function(){return"<===: "+JSON.stringify(b)});var c=new RTCSessionDescription(b);a.l.info(function(){return"Setting remote description: "+JSON.stringify(c)});a.b.setRemoteDescription(c,function(){a.l.info("Remote description set successfully.")},function(b){v(a.l,"Error setting remote description.",b)})};
gh.prototype.la=function(a){var b=this;a.candidate?(this.g++,this.u=Date.now(),1==this.g?this.h=setTimeout(function(){b.l.info("ICE candidate gathering timed out.");b.h=null;ph(b)},5E3):this.o&&v(this.l,"Received ICE candidate after resolving session description.")):(this.l.info("End of ICE candidates."),Ib("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.s),ph(this),0<this.g&&Ib("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.u-this.s))};
gh.prototype.M=function(){"completed"==this.b.iceGatheringState&&ph(this)};var ph=function(a){clearTimeout(a.h);a.h=null;if(!a.o){a.l.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var b=a.b.localDescription;a.C.resolve({type:b.type,sdp:b.sdp});a.o=!0}};
gh.prototype.K=function(a){var b=this;if(this.b){var c=this.b.iceConnectionState;this.l.info("New ICE connection state: "+c+".");"connected"==c?this.m("iceconnected"):"completed"==c?this.m("icecompleted"):"failed"==c?(v(this.l,function(){return"Ice connection failed: "+JSON.stringify(a)}),this.B("icefailed")):"closed"==c?this.A("iceclosed"):"disconnected"==c&&(v(this.l,"Ice connection state is bad."),this.f&&(this.l.info("Restarting ICE."),this.b.createOffer(this.L.bind(this),function(a){v(b.l,"Error creating new offer.",
a)},qh)))}};var eh={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},qh={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var rh=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return cc(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")},sh=function(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b},th=function(a){for(var b=
[],c=0,d=0;c<a.length;){var e=a[c++];if(128>e)b[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[c++];b[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[c++];var h=a[c++],k=a[c++];e=((e&7)<<18|(f&63)<<12|(h&63)<<6|k&63)-65536;b[d++]=String.fromCharCode(55296+(e>>10));b[d++]=String.fromCharCode(56320+(e&1023))}else f=a[c++],h=a[c++],b[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|h&63)}return b.join("")};var uh=ed("Firefox"),vh=zd()||ed("iPod"),wh=ed("iPad"),xh=ed("Android")&&!(yd()||ed("Firefox")||ed("Opera")||ed("Silk")),yh=yd(),zh=ed("Safari")&&!(yd()||ed("Coast")||ed("Opera")||ed("Edge")||ed("Silk")||ed("Android"))&&!Ad();var Ah=null,Bh=null,Dh=function(a){Ch();for(var b=Ah,c=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,h=f?a[d+1]:0,k=d+2<a.length,n=k?a[d+2]:0,u=e>>2;e=(e&3)<<4|h>>4;h=(h&15)<<2|n>>6;n&=63;k||(n=64,f||(h=64));c.push(b[u],b[e],b[h],b[n])}return c.join("")},Fh=function(a){var b=a.length,c=0;"="===a[b-2]?c=2:"="===a[b-1]&&(c=1);var d=new Uint8Array(Math.ceil(3*b/4)-c),e=0;Eh(a,function(a){d[e++]=a});return d.subarray(0,e)},Eh=function(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=Bh[c];
if(null!=e)return e;if(!Kc(c))throw Error("Unknown base64 encoding at char: "+c);}return b}Ch();for(var d=0;;){var e=c(-1),f=c(0),h=c(64),k=c(64);if(64===k&&-1===e)break;b(e<<2|f>>4);64!=h&&(b(f<<4&240|h>>2),64!=k&&b(h<<6&192|k))}},Ch=function(){if(!Ah){Ah={};Bh={};for(var a=0;65>a;a++)Ah[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Bh[Ah[a]]=a,62<=a&&(Bh["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}};var Gh=0,Hh=0,Ih=function(a){var b=0>a;a=Math.abs(a);var c=a>>>0;a=Math.floor((a-c)/4294967296);a>>>=0;b&&(a=~a>>>0,c=(~c>>>0)+1,4294967295<c&&(c=0,a++,4294967295<a&&(a=0)));Gh=c;Hh=a},Jh=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return Fh(a);Xb("Type not convertible to Uint8Array.");return new Uint8Array(0)};var Lh=function(a,b,c){this.h=null;this.o=this.u=this.b=this.g=this.j=0;this.s=!1;a&&Kh(this,a,b,c)},Mh=[],Nh=function(a,b,c){if(Mh.length){var d=Mh.pop();a&&Kh(d,a,b,c);return d}return new Lh(a,b,c)};Lh.prototype.clone=function(){return Nh(this.h,this.j,this.g-this.j)};Lh.prototype.clear=function(){this.h=null;this.b=this.g=this.j=0;this.s=!1};var Kh=function(a,b,c,d){a.h=Jh(b);a.j=Qa(c)?c:0;a.g=Qa(d)?a.j+d:a.h.length;a.b=a.j};Lh.prototype.reset=function(){this.b=this.j};
Lh.prototype.f=function(){var a=this.h;var b=a[this.b+0];var c=b&127;if(128>b)return this.b+=1,c;b=a[this.b+1];c|=(b&127)<<7;if(128>b)return this.b+=2,c;b=a[this.b+2];c|=(b&127)<<14;if(128>b)return this.b+=3,c;b=a[this.b+3];c|=(b&127)<<21;if(128>b)return this.b+=4,c;b=a[this.b+4];c|=(b&15)<<28;if(128>b)return this.b+=5,c>>>0;this.b+=5;128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&this.b++;return c};Lh.prototype.m=Lh.prototype.f;Lh.prototype.A=function(){return this.m()};var Oh=function(a){this.b=Nh(a,void 0,void 0);this.g=this.f=-1;this.j=!1},Ph=function(a){return 4==a.g};Oh.prototype.reset=function(){this.b.reset();this.g=this.f=-1};
var Qh=function(a){var b=a.b;if(b.b==b.g)return!1;(b=a.j)||(b=a.b,b=b.s||0>b.b||b.b>b.g);if(b)return Xb("Decoder hit an error"),!1;var c=a.b.f();b=c>>>3;c&=7;if(0!=c&&5!=c&&1!=c&&2!=c&&3!=c&&4!=c)return Xb("Invalid wire type"),a.j=!0,!1;a.f=b;a.g=c;return!0},Rh=function(a){switch(a.g){case 0:if(0!=a.g)Xb("Invalid wire type for skipVarintField"),Rh(a);else{for(a=a.b;a.h[a.b]&128;)a.b++;a.b++}break;case 1:1!=a.g?(Xb("Invalid wire type for skipFixed64Field"),Rh(a)):(a=a.b,a.b+=8);break;case 2:if(2!=
a.g)Xb("Invalid wire type for skipDelimitedField"),Rh(a);else{var b=a.b.f();a=a.b;a.b+=b}break;case 5:5!=a.g?(Xb("Invalid wire type for skipFixed32Field"),Rh(a)):(a=a.b,a.b+=4);break;case 3:b=[a.f];do{if(!Qh(a)){Xb("Unmatched start-group tag: stream EOF");a.j=!0;break}if(3==a.g)b.push(a.f);else if(4==a.g&&a.f!=b.pop()){Xb("Unmatched end-group tag");a.j=!0;break}}while(0<b.length);break;default:Xb("Invalid wire encoding for field.")}};
Oh.prototype.h=function(a,b){var c=this.b.g,d=this.b.f();d=this.b.b+d;this.b.g=d;b(a,this);this.b.b=d;this.b.g=c};
var Sh=function(a){a=a.b;a:{for(var b,c=0,d,e=0;4>e;e++)if(b=a.h[a.b++],c|=(b&127)<<7*e,128>b){a.u=c>>>0;a.o=0;break a}b=a.h[a.b++];c|=(b&127)<<28;d=0|(b&127)>>4;if(128>b)a.u=c>>>0,a.o=d>>>0;else{for(e=0;5>e;e++)if(b=a.h[a.b++],d|=(b&127)<<7*e+3,128>b){a.u=c>>>0;a.o=d>>>0;break a}Xb("Failed to read varint, encoding is invalid.");a.s=!0}}b=a.u;c=a.o;if(a=c&2147483648)b=~b+1>>>0,c=~c>>>0,0==b&&(c=c+1>>>0);b=4294967296*c+b;return a?-b:b},Th=function(a){var b=a.b.f();a=a.b;var c=a.h,d=a.b,e=d+b,f=[];
for(b="";d<e;){var h=c[d++];if(128>h)f.push(h);else if(192>h)continue;else if(224>h){var k=c[d++];f.push((h&31)<<6|k&63)}else if(240>h){k=c[d++];var n=c[d++];f.push((h&15)<<12|(k&63)<<6|n&63)}else if(248>h){k=c[d++];n=c[d++];var u=c[d++];h=(h&7)<<18|(k&63)<<12|(n&63)<<6|u&63;h-=65536;f.push((h>>10&1023)+55296,(h&1023)+56320)}8192<=f.length&&(b+=String.fromCharCode.apply(null,f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{c="";for(e=0;e<f.length;e+=8192)c+=String.fromCharCode.apply(null,
xc(f,e,e+8192));f=c}a.b=d;return b+f},Uh=function(a,b){var c=a.b.f();c=a.b.b+c;for(var d=[];a.b.b<c;)d.push(b.call(a.b));return d};var Vh=function(a,b){this.b=a;this.f=b},Wh=function(a){return new Vh((a.b>>>1|(a.f&1)<<31)>>>0,a.f>>>1>>>0)},Xh=function(a){return new Vh(a.b<<1>>>0,(a.f<<1|a.b>>>31)>>>0)};Vh.prototype.add=function(a){return new Vh((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};Vh.prototype.sub=function(a){return new Vh((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};
var Yh=function(a){var b=a&65535,c=a>>>16;a=10*b+65536*(0*b&65535)+65536*(10*c&65535);for(b=0*c+(0*b>>>16)+(10*c>>>16);4294967296<=a;)a-=4294967296,b+=1;return new Vh(a>>>0,b>>>0)};
Vh.prototype.toString=function(){for(var a="",b=this;0!=b.b||0!=b.f;){var c=new Vh(0,0);b=new Vh(b.b,b.f);for(var d=new Vh(10,0),e=new Vh(1,0);!(d.f&2147483648);)d=Xh(d),e=Xh(e);for(;0!=e.b||0!=e.f;)0>=(d.f<b.f||d.f==b.f&&d.b<b.b?-1:d.f==b.f&&d.b==b.b?0:1)&&(c=c.add(e),b=b.sub(d)),d=Wh(d),e=Wh(e);c=[c,b];b=c[0];a=c[1].b+a}""==a&&(a="0");return a};
var Zh=function(a){for(var b=new Vh(0,0),c=new Vh(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;c.b=parseInt(a[d],10);var e=Yh(b.b);b=Yh(b.f);b.f=b.b;b.b=0;b=e.add(b).add(c)}return b};Vh.prototype.clone=function(){return new Vh(this.b,this.f)};var $h=function(a,b){this.b=a;this.f=b};$h.prototype.add=function(a){return new $h((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};
$h.prototype.sub=function(a){return new $h((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};$h.prototype.clone=function(){return new $h(this.b,this.f)};$h.prototype.toString=function(){var a=0!=(this.f&2147483648),b=new Vh(this.b,this.f);a&&(b=(new Vh(0,0)).sub(b));return(a?"-":"")+b.toString()};var ai=function(){this.b=[]};ai.prototype.length=function(){return this.b.length};var bi=function(a){var b=a.b;a.b=[];return b},ci=function(a,b,c){for(;0<c||127<b;)a.b.push(b&127|128),b=(b>>>7|c<<25)>>>0,c>>>=7;a.b.push(b)},di=function(a,b){for(;127<b;)a.b.push(b&127|128),b>>>=7;a.b.push(b)},ei=function(a,b){if(0<=b)di(a,b);else{for(var c=0;9>c;c++)a.b.push(b&127|128),b>>=7;a.b.push(1)}},fi=function(a,b){a.b.push(b>>>0&255);a.b.push(b>>>8&255);a.b.push(b>>>16&255);a.b.push(b>>>24&255)};var y=function(){this.g=[];this.h=0;this.f=new ai},hi=function(a,b){gi(a,b,2);b=bi(a.f);a.g.push(b);a.h+=b.length;b.push(a.h);return b},ii=function(a,b){var c=b.pop();for(c=a.h+a.f.length()-c;127<c;)b.push(c&127|128),c>>>=7,a.h++;b.push(c);a.h++};y.prototype.reset=function(){this.g=[];bi(this.f);this.h=0};
var A=function(a){for(var b=new Uint8Array(a.h+a.f.length()),c=a.g,d=c.length,e=0,f=0;f<d;f++){var h=c[f];b.set(h,e);e+=h.length}c=bi(a.f);b.set(c,e);a.g=[b];return b},gi=function(a,b,c){di(a.f,8*b+c)},C=function(a,b,c){null!=c&&null!=c&&(gi(a,b,0),ei(a.f,c))},D=function(a,b,c){null!=c&&null!=c&&(gi(a,b,0),a=a.f,Ih(c),ci(a,Gh,Hh))},ji=function(a,b,c){if(null!=c){var d=c;(c=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=Zh(d);null===d?c=null:(c&&(d=(new Vh(0,0)).sub(d)),c=new $h(d.b,d.f));gi(a,b,0);
ci(a.f,c.b,c.f)}},ki=function(a,b,c){null!=c&&null!=c&&(gi(a,b,0),di(a.f,c))},li=function(a,b,c){null!=c&&null!=c&&(gi(a,b,0),a=a.f,Ih(c),ci(a,Gh,Hh))},mi=function(a,b,c){null!=c&&(c=Zh(c),gi(a,b,0),ci(a.f,c.b,c.f))},ni=function(a,b,c){null!=c&&(gi(a,b,5),fi(a.f,c))},oi=function(a,b,c){if(null!=c){gi(a,b,5);a=a.f;var d=c;d=(c=0>d?1:0)?-d:d;0===d?0<1/d?Gh=Hh=0:(Hh=0,Gh=2147483648):isNaN(d)?(Hh=0,Gh=2147483647):3.4028234663852886E38<d?(Hh=0,Gh=(c<<31|2139095040)>>>0):1.1754943508222875E-38>d?(d=Math.round(d/
Math.pow(2,-149)),Hh=0,Gh=(c<<31|d)>>>0):(b=Math.floor(Math.log(d)/Math.LN2),d*=Math.pow(2,-b),d=Math.round(8388608*d)&8388607,Hh=0,Gh=(c<<31|b+127<<23|d)>>>0);fi(a,Gh)}},F=function(a,b,c){null!=c&&(gi(a,b,0),a.f.b.push(c?1:0))},G=function(a,b,c){null!=c&&(gi(a,b,0),ei(a.f,c))},J=function(a,b,c){if(null!=c){b=hi(a,b);for(var d=a.f,e=0;e<c.length;e++){var f=c.charCodeAt(e);if(128>f)d.b.push(f);else if(2048>f)d.b.push(f>>6|192),d.b.push(f&63|128);else if(65536>f)if(55296<=f&&56319>=f&&e+1<c.length){var h=
c.charCodeAt(e+1);56320<=h&&57343>=h&&(f=1024*(f-55296)+h-56320+65536,d.b.push(f>>18|240),d.b.push(f>>12&63|128),d.b.push(f>>6&63|128),d.b.push(f&63|128),e++)}else d.b.push(f>>12|224),d.b.push(f>>6&63|128),d.b.push(f&63|128)}ii(a,b)}},pi=function(a,b,c){null!=c&&(c=Jh(c),gi(a,b,2),di(a.f,c.length),b=bi(a.f),a.g.push(b),a.g.push(c),a.h+=b.length+c.length)};y.prototype.b=function(a,b,c){null!=b&&(a=hi(this,a),c(b,this),ii(this,a))};
var qi=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(gi(e,b,0),ei(e.f,f))}},ri=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(gi(e,b,0),e=e.f,Ih(f),ci(e,Gh,Hh))}},si=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++){var e=a,f=c[d];null!=f&&(gi(e,b,0),di(e.f,f))}},ti=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)ni(a,b,c[d])},ui=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)G(a,b,c[d])},vi=function(a,b,c){if(null!=
c)for(var d=0;d<c.length;d++)J(a,b,c[d])},wi=function(a,b,c){if(null!=c)for(var d=0;d<c.length;d++)pi(a,b,c[d])},K=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++){var f=hi(a,b);d(c[e],a);ii(a,f)}},xi=function(a,b,c,d){if(null!=c)for(var e=0;e<c.length;e++)gi(a,b,3),d(c[e],a),gi(a,b,4)},yi=function(a,b,c){if(null!=c&&c.length){b=hi(a,b);for(var d=0;d<c.length;d++)ei(a.f,c[d]);ii(a,b)}};var M=function(){},zi="function"==typeof Uint8Array,N=function(a,b,c,d,e){a.b=null;b||(b=c?[c]:[]);a.F=c?String(c):void 0;a.g=0===c?-1:0;a.f=b;a:{c=a.f.length;b=-1;if(c&&(b=c-1,(c=a.f[b])&&"object"==typeof c&&!eb(c)&&!(zi&&c instanceof Uint8Array))){a.j=b-a.g;a.h=c;break a}-1<d?(a.j=Math.max(d,b+1-a.g),a.h=null):a.j=Number.MAX_VALUE}a.C={};if(e)for(d=0;d<e.length;d++)b=e[d],b<a.j?(b+=a.g,a.f[b]=a.f[b]||Ai):(Bi(a),a.h[b]=a.h[b]||Ai)},Ai=Object.freeze?Object.freeze([]):[],Bi=function(a){var b=a.j+a.g;
a.f[b]||(a.h=a.f[b]={})},Ci=function(a,b,c,d){for(var e in c){var f=c[e],h=f.lp;if(!f.ri)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,h);if(null!=k)if(h.xe)if(f.Fk)f.ri.call(b,h.yi,k,f.Fk);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.ri.call(b,h.yi,k)}},O=function(a,b){if(b<a.j){b+=a.g;var c=a.f[b];return c===Ai?a.f[b]=[]:c}if(a.h)return c=
a.h[b],c===Ai?a.h[b]=[]:c},P=function(a,b){if(b<a.j){b+=a.g;var c=a.f[b];return c===Ai?a.f[b]=[]:c}c=a.h[b];return c===Ai?a.h[b]=[]:c},Di=function(a,b){a=O(a,b);return null==a?a:+a},Ei=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ra(a))return Fh(a);Xb("Cannot coerce to Uint8Array: "+cb(a));return null},Gi=function(a){Fi(a);return!a.length||a[0]instanceof Uint8Array?a:cc(a,Ei)},Fi=function(a){if(a&&1<a.length){var b=cb(a[0]);w(a,function(a){cb(a)!=b&&Xb("Inconsistent type in JSPB repeated field array. Got "+
cb(a)+" expected "+b)})}},R=function(a,b,c){a=O(a,b);return null==a?c:a},S=function(a,b,c){b<a.j?a.f[b+a.g]=c:(Bi(a),a.h[b]=c)},Ii=function(a,b,c){Hi(a,b,c,"")},Ji=function(a,b,c){Hi(a,b,c,0)},Hi=function(a,b,c,d){c!=d?S(a,b,c):a.f[b+a.g]=null},T=function(a,b,c,d){a.b||(a.b={});if(!a.b[c]){var e=O(a,c);if(d||e)a.b[c]=new b(e)}return a.b[c]},U=function(a,b,c){Ki(a,b,c);b=a.b[c];b==Ai&&(b=a.b[c]=[]);return b},Ki=function(a,b,c){a.b||(a.b={});if(!a.b[c]){for(var d=P(a,c),e=[],f=0;f<d.length;f++)e[f]=
new b(d[f]);a.b[c]=e}},V=function(a,b,c){a.b||(a.b={});var d=c?Li(c):c;a.b[b]=c;S(a,b,d)},Mi=function(a,b,c){a.b||(a.b={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=Li(c[e]);a.b[b]=c;S(a,b,d)},Ni=function(a,b,c,d,e){Ki(a,d,b);var f=a.b[b];f||(f=a.b[b]=[]);c=c?c:new d;a=P(a,b);void 0!=e?(f.splice(e,0,c),a.splice(e,0,Li(c))):(f.push(c),a.push(Li(c)));return c},Oi=function(a){if(a.b)for(var b in a.b){var c=a.b[b];if(eb(c))for(var d=0;d<c.length;d++)c[d]&&Li(c[d]);else c&&Li(c)}},Li=function(a){Oi(a);
return a.f};M.prototype.za=zi?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return Dh(this)};try{return JSON.stringify(this.f&&Li(this),Pi)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.f&&Li(this),Pi)};var Pi=function(a,b){return m(b)&&(isNaN(b)||Infinity===b||-Infinity===b)?String(b):b},Ri=function(a){var b=Qi[a[0]];if(!b)throw Error("Unknown JsPb message type: "+a[0]);return new b(a)};
M.prototype.toString=function(){Oi(this);return this.f.toString()};M.prototype.m=function(a){if(this.h){this.b||(this.b={});var b=a.yi;if(a.b){if(a.xe)return this.b[b]||(this.b[b]=cc(this.h[b]||[],function(b){return new a.xe(b)})),this.b[b]}else if(a.xe)return!this.b[b]&&this.h[b]&&(this.b[b]=new a.xe(this.h[b])),this.b[b];return this.h[b]}};
var Ti=function(a,b){a=a||{};b=b||{};var c={},d;for(d in a)c[d]=0;for(d in b)c[d]=0;for(d in c)if(!Si(a[d],b[d]))return!1;return!0},Si=function(a,b){if(a==b)return!0;if(!jb(a)||!jb(b))return m(a)&&isNaN(a)||m(b)&&isNaN(b)?String(a)==String(b):!1;if(a.constructor!=b.constructor)return!1;if(zi&&a.constructor===Uint8Array){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,b.length);for(c=0;c<f;c++){var h=
a[c],k=b[c];h&&h.constructor==Object&&(d=h,h=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!Si(h,k))return!1}return d||e?(d=d||{},e=e||{},Ti(d,e)):!0}if(a.constructor===Object)return Ti(a,b);throw Error("Invalid type in JSPB array");};M.prototype.clone=function(){return Ui(this)};
var Ui=function(a){return new a.constructor(Vi(Li(a)))},Vi=function(a){if(eb(a)){for(var b=Array(a.length),c=0;c<a.length;c++){var d=a[c];null!=d&&(b[c]="object"==typeof d?Vi(d):d)}return b}if(zi&&a instanceof Uint8Array)return new Uint8Array(a);b={};for(c in a)d=a[c],null!=d&&(b[c]="object"==typeof d?Vi(d):d);return b},Wi=function(a,b){Qi[a]=b;b.messageId=a},Qi={};var Xi=function(a){N(this,a,0,-1,null)};t(Xi,M);Xi.prototype.w=function(){var a=new y;Yi(this,a);return A(a)};var Yi=function(a,b){var c=O(a,1);null!=c&&D(b,1,c);c=O(a,2);null!=c&&J(b,2,c);c=T(a,Zi,3);null!=c&&b.b(3,c,$i)},Zi=function(a){N(this,a,0,-1,null)};t(Zi,M);Zi.prototype.w=function(){var a=new y;$i(this,a);return A(a)};var $i=function(a,b){var c=O(a,1);null!=c&&J(b,1,c);c=O(a,2);null!=c&&D(b,2,c)};Xi.prototype.vc=function(){return O(this,1)};var aj=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};r("castApp.eventPage.Message",aj);var bj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};aj.DeviceData=bj;aj.DeviceJustSetUp=function(a,b,c,d){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=d};aj.DeviceCapabilities=function(){};
aj.LogRecord=function(a,b,c,d){this.levelValue=a;this.msg=b;this.loggerName=c;this.time=d};var cj=function(a,b){this.type=a;this.entryPoint=b};r("castApp.frontEnd.ExtensionMessage",cj);var dj=function(a){return"urn:x-cast:com.google.cast."+a},ej=dj("tp.connection"),fj=dj("receiver"),gj=dj("remoting"),hj=dj("media"),ij=dj("webrtc"),jj=dj("broadcast"),kj=ud({vx:ej,wx:dj("tp.heartbeat"),ww:fj,Aw:gj,Uu:hj,Xu:dj("media.universalRemote.optIn"),Qx:ij,us:jj});var lj=function(a){return"available"==a||"available_rescan"==a};var mj=function(a,b,c,d,e){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var nj=window.localStorage,oj=0,qj=function(a){return(a=window.localStorage.getItem(pj(a,!1)))?JSON.parse(a):null},rj=function(a){return(a=window.localStorage.getItem(pj(a,!0)))?JSON.parse(a):null},tj=function(a){if(sj.has(a.va()))throw Error("Duplicate instance name "+a.va());sj.set(a.va(),a);a.ab()},zj=function(a){for(var b=0,c=la(Object.keys(nj)),d=c.next();!d.done;d=c.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?oj+=e:b+=e}uj=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||vj(a))&&wj();xj.info("initialize: "+oj+" chars used, "+b+" other chars");chrome.runtime.onSuspend.addListener(yj)},uj=null,xj=vb("mr.PersistentDataManager"),sj=new Map,pj=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.va()},vj=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},yj=function(){xj.info("onSuspend");Aj("version",chrome.runtime.getManifest().version);
uj&&Aj("mrInstanceId",uj);for(var a=sj.get("LogManager"),b=la(sj),c=b.next();!c.done;c=b.next())c=la(c.value),c.next(),c=c.next().value,c!=a&&Bj(c);a&&Bj(a)},Bj=function(a){try{var b=a.Ta();b&&void 0!=b[0]&&Aj(pj(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&Aj(pj(a,!0),JSON.stringify(b[1]))}catch(c){xj.error("Error while saving data for "+a.va()+": "+c.message)}},Aj=function(a,b){var c=window.localStorage.getItem(a);c=null!=c?b.length-c.length:a.length+b.length;52E5<oj+c&&(v(xj,"Unable to write "+
c+" chars"),wj());if(52E5<oj+c)throw xj.error("Unable to write "+c+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,b)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}oj+=c},Cj=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(b,c){var d=new FileReader;d.onloadend=
function(){if(d.error)c(d.error);else try{for(var a=d.result,f=[],h=0,k=a.byteLength;h<k;h+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(a,h,Math.min(k-h,8192)/2)));Aj("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));b()}catch(n){c(n)}};d.readAsArrayBuffer(a)})},wj=function(){for(var a=la(Object.keys(nj)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&(oj-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);xj.info("removeTemporary_: "+
oj+" chars used")};var Dj=(new Map).set("+","-").set("/","_").set("=","."),Ej=(new Map).set("-","+").set("_","/").set(".","="),Fj=function(a){return atob(a.replace(/[-_.]/g,function(a){return Ej.get(a)}))},Gj=function(a){return btoa(String.fromCharCode.apply(String,Na(a))).replace(/[+/=]/g,function(a){return Dj.get(a)})};var Hj=function(){this.b=[];this.j=[];this.s=[];this.h=[];this.h[0]=128;for(var a=1;64>a;++a)this.h[a]=0;this.g=this.f=0;this.reset()};Hj.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.g=this.f=0};
var Ij=function(a,b,c){c=void 0===c?0:c;var d=a.s;if("string"===typeof b)for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(b=16;80>b;b++)c=d[b-3]^d[b-8]^d[b-14]^d[b-16],d[b]=(c<<1|c>>>31)&4294967295;b=a.b[0];c=a.b[1];e=a.b[2];for(var f=a.b[3],h=a.b[4],k,n,u=0;80>u;u++)40>u?20>u?(k=f^c&(e^f),n=1518500249):(k=c^e^f,n=1859775393):60>u?(k=c&e|f&(c|e),n=2400959708):(k=
c^e^f,n=3395469782),k=(b<<5|b>>>27)+k+h+n+d[u]&4294967295,h=f,f=e,e=(c<<30|c>>>2)&4294967295,c=b,b=k;a.b[0]=a.b[0]+b&4294967295;a.b[1]=a.b[1]+c&4294967295;a.b[2]=a.b[2]+e&4294967295;a.b[3]=a.b[3]+f&4294967295;a.b[4]=a.b[4]+h&4294967295};
Hj.prototype.update=function(a,b){b=void 0===b?a.length:b;for(var c=b-64,d=0,e=this.j,f=this.f;d<b;){if(0==f)for(;d<=c;)Ij(this,a,d),d+=64;if("string"===typeof a)for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){Ij(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){Ij(this,e);f=0;break}}this.f=f;this.g+=b};
Hj.prototype.digest=function(){var a=[],b=8*this.g;56>this.f?this.update(this.h,56-this.f):this.update(this.h,64-(this.f-56));for(var c=63;56<=c;c--)this.j[c]=b&255,b/=256;Ij(this,this.j);for(c=b=0;5>c;c++)for(var d=24;0<=d;d-=8)a[b]=this.b[c]>>d&255,++b;return a};var Jj=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var Lj=function(){this.s=Jj();this.h=new Kj(null,null);this.f=new Kj(null,null);this.j=[];this.g=this.b=0;tj(this)},Nj=function(){Mj||(Mj=new Lj);return Mj},Oj=function(a,b){b=b.toLowerCase();var c=new Hj;c.update(b);c.update(a.s);return"r"+Gj(c.digest())},Pj=function(){var a=Nj();return a.h.model?a.h:a.f.model?a.f:new Kj(null,null)};Lj.prototype.va=function(){return"SinkUtils"};
Lj.prototype.Ta=function(){return[{recentLaunchedDevice:this.h,recentDiscoveredDevice:this.f},{receiverIdToken:this.s,fixedIpList:this.j.join(","),castControlPort:this.b,lastCloudSinkCheckTimeMillis:this.g}]};
Lj.prototype.ab=function(){var a=qj(this);a&&(this.h=a.recentLaunchedDevice||new Kj(null,null),this.f=a.recentDiscoveredDevice||new Kj(null,null));if(a=rj(this))this.s=a.receiverIdToken||Jj(),this.j=a.fixedIpList&&a.fixedIpList.split(",")||[],this.b=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var Mj=null,Kj=function(a,b){this.model=a;this.ip=b};var Qj=function(a,b){this.Xb=this.Ve=this.Id=this.Pa=this.Wb=null;this.Mb=new mj(b,a);this.Sb={};this.hh={};this.je=!1};Qj.prototype.getId=function(){return this.Mb.id};Qj.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.Mb.friendlyName!=a.Mb.friendlyName&&(this.Mb.friendlyName=a.Mb.friendlyName,b=!0);this.Id!=a.Id&&(this.Id=a.Id,b=!0);this.Ve!=a.Ve&&(this.Ve=a.Ve,b=!0);this.Wb!=a.Wb&&(this.Wb=a.Wb,b=!0);this.Pa!=a.Pa&&(this.Pa=a.Pa,b=!0);return b};Qj.prototype.hb=function(){return this.Wb};
Qj.prototype.Sa=function(){return this.Pa};var Rj=function(a,b){return a.Sb[b]||"unknown"},Sj=function(a){var b=new Qj(a.Mb.friendlyName,"");b.Mb.id=a.Mb.id;b.Wb=a.Wb;b.Pa=a.Pa;b.Id=a.Id;b.Ve=a.Ve;b.Xb=a.Xb;b.Sb=a.Sb;b.hh=a.hh;b.je=a.je;return b};var Uj=function(a,b,c,d,e,f){this.f=new mj(a,b,Tj(d));this.Xb=c||null;this.b=d||null;this.Wb=e||null;this.Pa=f||null;this.Sb={};this.Pd=!1},Vj=function(a){if(!a.Xb||!a.hb())return null;var b=new Uj(a.Mb.id,a.Mb.friendlyName,a.Xb,void 0,a.hb(),Nj().b||8009);b.f.id=a.Mb.id;b.Pd=!0;return b},Wj=function(a,b){if(b=a.update(b.f.friendlyName,b.hb(),b.Sa(),b.b))a.Pd=!1;return b};
Uj.prototype.update=function(a,b,c,d){var e=!1;this.f.friendlyName!=a&&(this.f.friendlyName=a,e=!0);null!=b&&this.Wb!=b&&(this.Wb=b,e=!0);null!=c&&this.Pa!=c&&(this.Pa=c,e=!0);null!=d&&this.b!=d&&(this.b=d,e=!0);return e};var Tj=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};Uj.prototype.getId=function(){return this.f.id};
var Xj=function(a){var b=new Uj("",a.friendlyName,a.modelName,a.capabilities,a.ip,a.port);b.f.id=a.id;b.Pd=a.discoveredByDial;b.Sb=a.appStatusMap;for(var c in b.Sb)"unavailable"==b.Sb[c]&&(b.Sb[c]="unavailable_rescan");return b};Uj.prototype.hb=function(){return this.Wb};Uj.prototype.Sa=function(){return this.Pa};var Yj=function(a,b){return a.Sb[b]||"unknown"};var Zj={Mu:0,zu:1},ak={Lx:0,Dn:1,xw:2},bk={DIAL:0,Ru:1,Su:2,qt:3},ck={Hv:0,TIMEOUT:1,FAILED:2},dk={qk:0,ls:1,et:2,Pt:3,Ns:4,rv:5,ht:6,hw:7},ek={Vm:0,SUCCESS:1},fk={lu:0,jw:1,SEEK:2,ov:3,fx:4,ks:5},gk=function(a){Rb("MediaRouter.Cast.Session.Ended",a,ak)},hk=function(a){Rb("MediaRouter.Cast.Channel.ConnectResult",a,ek)},ik=function(a){Rb("MediaRouter.Cast.Controller.ActionType",a,fk)},jk=function(a){Rb("MediaRouter.Cast.Discovery.Type",a,bk)},kk=function(a){Rb("MediaRouter.Cast.Session.Fail",a,ck)};var lk=function(a,b,c,d,e){for(var f=[],h=4;h<arguments.length;++h)f[h-4]=arguments[h];var k=this;this.j=a;this.m=b;this.s=c;this.f=d;this.g=f;this.b=!1;this.h=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return k.ep.apply(k,Na(b))}};g=lk.prototype;g.addListener=function(){this.b||(this.b=!0,this.f.addListener.apply(this.f,[this.h].concat(Na(this.g))))};g.removeListener=function(){this.b&&(this.f.removeListener(this.h),this.b=!1)};
g.Ng=function(a){for(var b=0;b<arguments.length;++b);return!0};g.ep=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d=this;Dg(this.j);if(!this.Ng.apply(this,Na(b)))return!1;ug(this.s).then(function(a){return a.handleEvent.apply(a,[d.f].concat(Na(b)))});return this.vi()};g.va=function(){return"mr.EventListener."+this.m};g.Ta=function(){return[this.b]};g.ab=function(){qj(this)&&this.addListener()};g.vi=function(){};var mk={serviceType:"_googlecast._tcp.local"},nk=null,ok=function(){nk||(nk=new lk(7,"CastMdnsEventListener","mr.cast.SinkDiscoveryService",chrome.mdns.onServiceList,mk));return nk},pk=null,qk=function(){pk||(pk="ChromeOS"==ag()?new lk(9,"CastNetworkListChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworkListChanged):new lk(8,"CastNetworksChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworksChanged));return pk},rk=null,sk=null,
tk=function(){rk||(rk=new lk(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));sk||(sk=new lk(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[rk,sk]};var uk=function(a){return function(){return a}},vk=uk(!1),wk=uk(!0),xk=function(a){return a},yk=function(a){return function(){throw Error(a);}},zk=function(a){var b=b||0;return function(){return a.apply(this,Array.prototype.slice.call(arguments,0,b))}};var Ak="StopIteration"in Pa?Pa.StopIteration:{message:"StopIteration",stack:""},Bk=function(){};Bk.prototype.next=function(){throw Ak;};Bk.prototype.wb=function(){return this};
var Ck=function(a){if(a instanceof Bk)return a;if("function"==typeof a.wb)return a.wb(!1);if(hb(a)){var b=0,c=new Bk;c.next=function(){for(;;){if(b>=a.length)throw Ak;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");},Dk=function(a,b,c){if(hb(a))try{w(a,b,c)}catch(d){if(d!==Ak)throw d;}else{a=Ck(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(d){if(d!==Ak)throw d;}}},Ek=function(a,b){a=Ck(a);try{for(;!b.call(void 0,a.next(),void 0,a););}catch(c){if(c!==Ak)throw c;}},Fk=function(a){if(hb(a))return x(a);
a=Ck(a);var b=[];Dk(a,function(a){b.push(a)});return b};var Hk=function(a,b){this.f={};this.b=[];this.g=this.h=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&Gk(this,a)};Hk.prototype.pa=function(){return this.h};Hk.prototype.ba=function(){Ik(this);for(var a=[],b=0;b<this.b.length;b++)a.push(this.f[this.b[b]]);return a};Hk.prototype.xb=function(){Ik(this);return this.b.concat()};var Kk=function(a,b){return Jk(a.f,b)};
Hk.prototype.ff=function(a){for(var b=0;b<this.b.length;b++){var c=this.b[b];if(Jk(this.f,c)&&this.f[c]==a)return!0}return!1};Hk.prototype.equals=function(a,b){if(this===a)return!0;if(this.h!=a.pa())return!1;b=b||Mk;Ik(this);for(var c,d=0;c=this.b[d];d++)if(!b(this.get(c),a.get(c)))return!1;return!0};var Mk=function(a,b){return a===b};Hk.prototype.Gb=function(){return 0==this.h};Hk.prototype.clear=function(){this.f={};this.g=this.h=this.b.length=0};
Hk.prototype.remove=function(a){return Jk(this.f,a)?(delete this.f[a],this.h--,this.g++,this.b.length>2*this.h&&Ik(this),!0):!1};var Ik=function(a){if(a.h!=a.b.length){for(var b=0,c=0;b<a.b.length;){var d=a.b[b];Jk(a.f,d)&&(a.b[c++]=d);b++}a.b.length=c}if(a.h!=a.b.length){var e={};for(c=b=0;b<a.b.length;)d=a.b[b],Jk(e,d)||(a.b[c++]=d,e[d]=1),b++;a.b.length=c}};Hk.prototype.get=function(a,b){return Jk(this.f,a)?this.f[a]:b};
Hk.prototype.set=function(a,b){Jk(this.f,a)||(this.h++,this.b.push(a),this.g++);this.f[a]=b};var Gk=function(a,b){if(b instanceof Hk)for(var c=b.xb(),d=0;d<c.length;d++)a.set(c[d],b.get(c[d]));else for(c in b)a.set(c,b[c])};Hk.prototype.forEach=function(a,b){for(var c=this.xb(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};Hk.prototype.clone=function(){return new Hk(this)};var Nk=function(a){Ik(a);for(var b={},c=0;c<a.b.length;c++){var d=a.b[c];b[d]=a.f[d]}return b};
Hk.prototype.wb=function(a){Ik(this);var b=0,c=this.g,d=this,e=new Bk;e.next=function(){if(c!=d.g)throw Error("The map has changed since the iterator was created");if(b>=d.b.length)throw Ak;var e=d.b[b++];return a?e:d.f[e]};return e};var Jk=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var Ok=function(a){return Promise.all(a.map(function(a){return a.then(function(a){return{Qd:!0,value:a}},function(a){return{Qd:!1,reason:a}})}))};var Pk=function(a,b){this.f=b;this.A=a;this.A.ha=this.ha.bind(this);this.b=new Hk;this.m=new Hk;this.h=new Hk;this.la=null;this.u=this.C="";this.g=null;this.L=this.o=!1;this.D=[];this.l=vb("mr.cast.SinkDiscoveryService");this.B=new Set;this.j={ve:0,He:0};this.s=this.F=0};l(Pk,qg);Pk.prototype.init=function(){tj(this);this.o&&(Qk(this),Rk(this));Ag("mr.cast.SinkDiscoveryService",this)};var Qk=function(a){a.l.info("Start listening to network changes");qk().addListener()};
Pk.prototype.start=function(){var a=Date.now(),b=ok();if(b.b){if(6E4>a-this.la)return;this.l.info("Forcing mdns discovery");chrome.mdns.forceDiscovery(Za);b=ok();b.removeListener();b.addListener()}else this.l.info("Adding mdns listener"),b.addListener();this.la=a};Pk.prototype.stop=function(){this.l.info("Stopping...");ok().removeListener()};
Pk.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.mdns.onServiceList)this.K.apply(this,Na(c));else if(a==chrome.networkingPrivate.onNetworksChanged||a==chrome.networkingPrivate.onNetworkListChanged)Rk(this);else throw Error("Unhandled event");};
var Sk=function(a,b){if(-1==b.serviceName.indexOf("._googlecast."))return null;var c={};b.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(c[a.substring(0,2)]=a.substring(3))});var d=c.id;if(!d)return v(a.l,"Missing ID"),null;var e=Number(b.serviceHostPort.substring(b.serviceHostPort.lastIndexOf(":")+1));if(isNaN(e)||0>e||65535<e)return v(a.l,"Missing or invalid port"),null;var f=c.fn;if(!f||!b.ipAddress)return v(a.l,"Missing friendly name or IP address"),null;a=Number(c.ca);return new Uj(d,
f,c.md||"",isNaN(a)?0:a,b.ipAddress,e)},al=function(a,b){a.l.info("addSinks returned "+b.length+" sinks");Cb(a.l,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.b.xb());b.forEach(function(b){var d=b.sink_id;var f=b.extra_data.cast_media_sink,h=f.ip_endpoint?f.ip_endpoint.address:f.ip_address,k=f.ip_endpoint?f.ip_endpoint.port:Nj().b||8009;d=new Uj(d,b.name,f.model_name,f.capabilities,h.address_bytes.join("."),k);f=a.b.get(d.getId());h=a.A;b=b.extra_data.cast_media_sink.cast_channel_id;
k=d.getId();var n=h.f.get(k);if(!n||n.channelId!=b){Tk.info("Added cast channel "+b+" to receiver: "+k);n&&h.b.remove(n.channelId);n={auth:"ssl_verified",ipAddress:d.hb(),port:d.Sa()};n={channelId:b,readyState:"open",keepAlive:!0,audioOnly:!(d.b&1),connectInfo:n};h.f.set(k,n);h.b.set(b,k);var u=h.g.get(k);u&&u.channelId!=b&&(Tk.info("Re-connected to receiver: "+d.getId()),Uk(h.h,u,n),Vk(h.j.j,d,!0));h.g.set(k,n)}f?Wj(f,d)&&Wk(a.f,f):Xk(a,d);c.delete(d.getId())});c.forEach(function(b){var c=a.A,d=
c.g.get(b);d&&(Yk(c.h,d),c.g.remove(b));Zk(a,b)});a.j={ve:a.b.pa(),He:$k(a)}};Pk.prototype.K=function(a){var b=this;this.l.info("Registering "+a.length+" devices");0!=this.s&&(clearTimeout(this.s),this.s=0);a=bl(this,a).map(function(a){return cl(b,a,!0)});Ok(a).then(function(){b.j={ve:b.b.pa(),He:$k(b)};dl(b)})};
var dl=function(a){0!=a.s||36E5>Date.now()-a.F||(a.s=setTimeout(function(){var b=a.j;Sb("MediaRouter.Cast.Discovery.KnownDevicesCount",b.He);Sb("MediaRouter.Cast.Discovery.ConnectedDevicesCount",b.ve);a.F=Date.now();a.s=0},5E3))};Pk.prototype.Ce=function(){return this.j};
var $k=function(a){var b=a.B.size;Dk(a.b.wb(!1),function(c){a.B.has(c.getId())||b++});return b},cl=function(a,b,c){if(Kk(a.h,b.getId()))return Promise.resolve();a.h.set(b.getId(),b);return el(a,b).then(function(d){d?(d=a.b.get(b.getId()),c&&(d?d.Pd&&jk(3):jk(1)),Xk(a,b)):(a.l.info("Inaccessible sink: "+b.getId()),Zk(a,b.getId()));a.h.remove(b.getId())})},fl=function(a,b){return void 0!=a.D.find(function(a){return a.ipAddress==b.ipAddress})},bl=function(a,b){var c=[];a.B.clear();b.forEach(function(b){if(!fl(a,
b)&&(b=Sk(a,b))){var d=b.getId();a.B.add(d);if(Kk(a.h,d)){var f=a.h.get(d);if(f.hb()==b.hb()&&f.Sa()==b.Sa()){a.l.info("Sink has pending connection "+d);return}v(a.l,"Pending sink changed ip "+d);a.h.remove(d)}(d=a.b.get(d))?Wj(d,b)&&Wk(a.f,d):c.push(b)}});return c},gl=function(a,b){var c=a.b.get(b.getId()),d=null,e=b.hb(),f=b.Sa();null!=e&&null!=f&&(d=a.m.get(e+":"+f));if(c&&!d){var h=b.hb(),k=b.Sa();h&&k&&a.m.remove(h+":"+k)}d&&!c&&a.b.remove(d.getId());a.b.set(b.getId(),b);null!=e&&null!=f&&a.m.set(e+
":"+f,b)},Xk=function(a,b){a.l.info("Adding sink "+b.getId());gl(a,b);a.o||(a.o=!0,Qk(a));a=a.f;a.f.onSinkAvailabilityUpdated(a,1);Wk(a,b);Vk(a.j,b);Nj().f=new Kj(b.Xb,b.hb())},Zk=function(a,b){var c=a.b.get(b);if(c){a.l.info("Removing sink "+b);a.b.remove(b);b=c.hb();var d=c.Sa();null!=b&&null!=d&&a.m.remove(b+":"+d);a.f.L(c)}},hl=function(a){var b=a.b.ba();a.b.clear();a.m.clear();b.forEach(a.f.L,a.f)},el=function(a,b){Cb(a.l,"Checking access to "+b.getId());return il(a.A,b).then(function(a){if(b.Pd){var c=
4;a.audioOnly||(c=c||1);b.b=c;b.f.iconType=Tj(b.b)}return!0},function(){return!1})},jl=function(a){a.l.info("Pruning inactive sinks.");Dk(a.b.wb(!1),function(b){a.h.set(b.getId(),b);el(a,b).then(function(c){c||Zk(a,b.getId());a.h.remove(b.getId())})})};Pk.prototype.ha=function(a){return this.b.get(a,null)};var kl=function(a,b){var c=[];Dk(a.b.wb(!1),function(a){lj(Yj(a,b))&&c.push(a)});return c};Pk.prototype.va=function(){return"cast.SinkDiscoveryService"};
Pk.prototype.Ta=function(){var a=this,b={};Dk(this.b.wb(!0),function(c){var d=a.b.get(c);d={id:d.getId(),ip:d.hb(),port:d.Sa(),friendlyName:d.f.friendlyName,modelName:d.Xb,capabilities:d.b,discoveredByDial:d.Pd,appStatusMap:d.Sb};b[c]=d});return[new ll(b,this.u,this.j),new ml(this.o,this.F)]};
Pk.prototype.ab=function(){var a=qj(this);if(a&&3==a.version){this.u=a.networkIds;this.j=a.deviceCounts;a=a.sinkMap;this.L=0<Object.keys(a).length;for(var b in a){var c=Xj(a[b]);this.ha(c.getId())||gl(this,c)}jl(this)}if(b=rj(this))this.o=b.hasSavedSinks,this.F=b.lastSinkCountMetricRecordTime||0};
var nl=function(a,b){a.L=0<Object.keys(b).length;for(var c in b){var d=Xj(b[c]);a.ha(d.getId())||cl(a,d,!1)}},Rk=function(a){a.l.info("Fetching networks state");a.g&&Bj(a.g);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(b){for(var c=[],d=0;d<b.length;d++)"Connected"==b[d].ConnectionState&&c.push(b[d].GUID);ol(a,c.sort().join(","))})},ol=function(a,b){a.l.info(function(){return"Update current network "+pl(b)});b!=a.C&&(a.g&&(sj.delete(a.g.va()),a.g=null),
b?(a.u&&b!=a.u?hl(a):jl(a),a.C=b,a.u=b,a.g=new ql(a,a.C)):a.C="")},pl=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},ll=function(a,b,c){this.sinkMap=a;this.networkIds=b;this.deviceCounts=c;this.version=3},ml=function(a,b){this.hasSavedSinks=a;this.lastSinkCountMetricRecordTime=b},ql=function(a,b){this.b=a;this.f=b;tj(this)};ql.prototype.va=function(){return"cast.NetworkSink."+this.f};
ql.prototype.Ta=function(){var a=this,b=null,c=this.b.Ta();c&&(this.b.L||0<this.b.b.pa())&&(b=c[0]);this.b.l.info(function(){return"Saving sink data for network "+pl(a.f)});return[null,b]};ql.prototype.ab=function(){var a=this;this.b.l.info(function(){return"Restoring sink data for network "+pl(a.f)});var b=rj(this);b&&3==b.version&&nl(this.b,b.sinkMap)};var rl={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var sl=function(){this.type="GET_STATUS";this.requestId=0};var tl=function(a,b){this.requestId=a;this.Kg=b;this.Am=null};tl.prototype.b=function(){};var ul=function(){this.b=new Hk},vl=function(a,b){a.b.set(b.requestId,b);b.Am=setTimeout(function(){a.b.remove(b.requestId);b.b()},b.Kg)},wl=function(a,b){var c=a.b.get(b);if(!c)return null;clearTimeout(c.Am);a.b.remove(b);return c};var xl=function(a,b,c){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=b;this.message=c};var yl=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var zl=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var Al=function(a){this.f=a;this.b=1E3*Math.floor(1E6*Math.random())},Bl=function(a){var b=a.b++;0==b&&(b=a.b++);return b};Al.prototype.va=function(){return"IdGenerator."+this.f};Al.prototype.Ta=function(){return[this.b]};Al.prototype.ab=function(){var a=qj(this);a&&(this.b=a)};var Cl=function(a,b){this.f=a;this.h=b;this.b=new ul;this.g=new Al("cast.RequestIdGenerator")};Cl.prototype.init=function(){tj(this.g)};var El=function(a,b,c,d){var e=Bl(a.g);b.requestId=e;b=new Tb;c=new Dl(e,b,m(c)&&0<c?c:6E5,d);vl(a.b,c);return c};
Cl.prototype.sendRequest=function(a,b,c,d,e,f){var h=this;if(!kj.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var k=El(this,a,Qa(d)?d:3E3,e),n=k.mb;Fl(this.f,b,c,a,e||this.h,f).then(null,function(){wl(h.b,k.requestId);n.reject(Gl)});return n.b};
Cl.prototype.sendMessage=function(a,b,c,d,e,f){var h=this,k=El(this,a,Qa(d)?d:3E3,e),n=k.mb;Fl(this.f,b,c,a,e||this.h,f).then(function(){wl(h.b,k.requestId);n.resolve(!0)},function(){wl(h.b,k.requestId);n.reject(Gl)});return n.b};
var Hl=function(a,b,c){var d=new yl(b.appId);d.language=b.language?b.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,c,fj,b.requestSessionTimeout)},Il=Error("Timeout"),Gl=Error("Failed to send message"),Dl=function(a,b,c,d){tl.call(this,a,c);this.mb=b;this.sourceId=d};l(Dl,tl);Dl.prototype.b=function(){this.mb.reject(Il)};var Jl=function(a){return a.pa&&"function"==typeof a.pa?a.pa():hb(a)||Ra(a)?a.length:id(a)},Kl=function(a){if(a.ba&&"function"==typeof a.ba)return a.ba();if(Ra(a))return a.split("");if(hb(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return kd(a)},Ll=function(a){if(a.xb&&"function"==typeof a.xb)return a.xb();if(!a.ba||"function"!=typeof a.ba){if(hb(a)||Ra(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return ld(a)}},Ml=function(a){return a.Gb&&"function"==typeof a.Gb?
a.Gb():hb(a)||Ra(a)?kc(a):pd(a)},Nl=function(a,b,c){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,c);else if(hb(a)||Ra(a))w(a,b,c);else for(var d=Ll(a),e=Kl(a),f=e.length,h=0;h<f;h++)b.call(c,e[h],d&&d[h],a)},Ol=function(a,b,c){if("function"==typeof a.map)return a.map(b,c);if(hb(a)||Ra(a))return cc(a,b,c);var d=Ll(a),e=Kl(a),f=e.length;if(d){var h={};for(var k=0;k<f;k++)h[d[k]]=b.call(c,e[k],d[k],a)}else for(h=[],k=0;k<f;k++)h[k]=b.call(c,e[k],void 0,a);return h},Pl=function(a,b){if("function"==
typeof a.every)return a.every(b,void 0);if(hb(a)||Ra(a))return fc(a,b,void 0);for(var c=Ll(a),d=Kl(a),e=d.length,f=0;f<e;f++)if(!b.call(void 0,d[f],c&&c[f],a))return!1;return!0};var Rl=function(a){this.b=new Hk;a&&Ql(this,a)},Sl=function(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[lb]||(a[lb]=++nb)):b.substr(0,1)+a};Rl.prototype.pa=function(){return this.b.pa()};Rl.prototype.add=function(a){this.b.set(Sl(a),a)};var Ql=function(a,b){b=Kl(b);for(var c=b.length,d=0;d<c;d++)a.add(b[d])};g=Rl.prototype;g.removeAll=function(a){a=Kl(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};g.remove=function(a){return this.b.remove(Sl(a))};g.clear=function(){this.b.clear()};
g.Gb=function(){return this.b.Gb()};g.contains=function(a){return Kk(this.b,Sl(a))};g.ba=function(){return this.b.ba()};g.clone=function(){return new Rl(this)};g.equals=function(a){return this.pa()==Jl(a)&&Tl(this,a)};var Tl=function(a,b){var c=Jl(b);if(a.pa()>c)return!1;!(b instanceof Rl)&&5<c&&(b=new Rl(b));return Pl(a,function(a){var c=b;return c.contains&&"function"==typeof c.contains?c.contains(a):c.ff&&"function"==typeof c.ff?c.ff(a):hb(c)||Ra(c)?jc(c,a):od(c,a)})};Rl.prototype.wb=function(){return this.b.wb(!1)};var Vl=function(a,b){this.h=a;this.g=b;this.f=new Hk;this.b=new Rl;this.j=0;this.o=new Hk("serviceCheck",this.vp.bind(this),"startDeviceMonitor",this.wp.bind(this),"releaseDeviceMonitor",this.up.bind(this),"deviceJustSetUp",this.rp.bind(this),"logRecord",this.sp.bind(this));chrome.runtime.onMessage.addListener(this.m.bind(this));chrome.runtime.onMessageExternal.addListener(this.s.bind(this));Ul(this,"serviceReady")};Vl.prototype.l=vb("castApp.eventPage.Service");
var Yl=function(a){if(Wl(a)){var b=new Rl;Dk(a.h.b.wb(!1),function(a){var c=a.hb();b.add(c);Kk(this.f,c)||this.g.sendRequest(new sl,a,fj)}.bind(a));var c=!1;a.f.xb().forEach(function(a){b.contains(a)||(this.f.remove(a),c=!0)}.bind(a));c&&Xl(a)}},Wl=function(a){if(0===a.b.pa())return!1;var b=q();3E4<b-a.j&&(a.j=b,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(this.l.info("No tabs found. Clearing device monitor clients."),
this.b.clear()):this.l.info(function(){return"Tab check found active tabs: "+a.map(function(a){return a.id})})}.bind(a)));b=a.b.pa();a.l.info("Monitor client count: "+b);return 0<b};Vl.prototype.m=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.o.get(a.subtype);if(!d)return!1;if(!a.originId)return Xb("Missing origin ID in the incoming message."),!1;try{var e=d(a,b,c);e&&c(e)}catch(f){this.l.error("Error while handling request",f)}return!1};
var Ul=function(a,b,c){var d=new aj(b,c);Cb(a.l,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};g=Vl.prototype;g.vp=function(){Ul(this,"serviceReady")};g.wp=function(a){this.b.contains(a.originId)?this.l.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.l.info("Registering monitor client: "+a.originId),this.b.add(a.originId));Xl(this);Zl(this)};g.up=function(a){this.l.info("Unregistering monitor client: "+a.originId);this.b.remove(a.originId)};
g.rp=function(a){a=a.deviceJustSetUp;var b=a.udn.replace(/-/g,"").toLowerCase(),c;a.capabilities&&(c=(a.capabilities.audioOutSupported?4:0)|(a.capabilities.videoOutSupported?1:0));c=new Uj(b,a.name,a.modelName,c,a.ipAddress,Nj().b||8009);cl(this.h,c,!0)};g.sp=function(a){a=a.logRecord;yb({level:Fb(a.levelValue),J:a.loggerName,time:a.time,message:a.msg})};
var Xl=function(a){var b=a.f.ba();Ul(a,"devices",b)},Zl=function(a){Cb(a.h.l,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(Za);a.h.b.ba().forEach(function(a){this.g.sendRequest(new sl,a,fj)}.bind(a))};Vl.prototype.s=function(a,b,c){switch(a.type){case "handshake":c(new cj("handshake"));break;case "launch":b=b.tab&&m(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];r("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.Dr=!0;r("chrome.cast.usingPresentationApi",chrome.cast.Dr);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};r("chrome.cast.Error",chrome.cast.Error);chrome.cast.Vn=function(a){this.platform=a;this.packageId=this.url=null};r("chrome.cast.SenderApplication",chrome.cast.Vn);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};r("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,b){this.level=Qa(a)?a:null;this.muted=Qa(b)?b:null};r("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.hd={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};r("chrome.cast.AutoJoinPolicy",chrome.cast.hd);chrome.cast.Rg={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};r("chrome.cast.DefaultActionPolicy",chrome.cast.Rg);chrome.cast.Hd={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
r("chrome.cast.Capability",chrome.cast.Hd);chrome.cast.jd={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};r("chrome.cast.ErrorCode",chrome.cast.jd);chrome.cast.Gn={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
r("chrome.cast.ReceiverAvailability",chrome.cast.Gn);chrome.cast.Wn={CHROME:"chrome",IOS:"ios",ANDROID:"android"};r("chrome.cast.SenderPlatform",chrome.cast.Wn);chrome.cast.Yg={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};r("chrome.cast.ReceiverType",chrome.cast.Yg);chrome.cast.Pm={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};r("chrome.cast.DialAppState",chrome.cast.Pm);chrome.cast.bg={CAST:"cast",STOP:"stop"};r("chrome.cast.ReceiverAction",chrome.cast.bg);
chrome.cast.mk={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};r("chrome.cast.SessionStatus",chrome.cast.mk);chrome.cast.rk={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};r("chrome.cast.VolumeControlType",chrome.cast.rk);chrome.cast.Jm=function(a,b,c,d,e){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=d||chrome.cast.hd.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.Rg.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};r("chrome.cast.ApiConfig",chrome.cast.Jm);chrome.cast.Rm=function(a,b){this.appName=a;this.launchParameter=b||null};r("chrome.cast.DialRequest",chrome.cast.Rm);
chrome.cast.Sj=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};r("chrome.cast.DialLaunchData",chrome.cast.Sj);chrome.cast.Qm=function(a,b){this.doLaunch=a;this.launchParameter=b||null};r("chrome.cast.DialLaunchResponse",chrome.cast.Qm);chrome.cast.lk=function(a,b,c){this.appId=a;this.capabilities=eb(b)?b:[chrome.cast.Hd.VIDEO_OUT,chrome.cast.Hd.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
r("chrome.cast.SessionRequest",chrome.cast.lk);
chrome.cast.bi=function(a,b,c,d){this.label=a;a=b;Sc.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Mc,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Nc,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(Oc,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Pc,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Qc,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Rc,"&#0;")));this.friendlyName=a;this.capabilities=c||[];this.volume=d||null;this.receiverType=chrome.cast.Yg.CAST;this.displayStatus=this.isActiveInput=null};
r("chrome.cast.Receiver",chrome.cast.bi);chrome.cast.Hn=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};r("chrome.cast.ReceiverDisplayStatus",chrome.cast.Hn);chrome.cast.pk=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};r("chrome.cast.Timeout",chrome.cast.pk);chrome.cast.timeout=new chrome.cast.pk;r("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.Oj="auto-join";chrome.cast.gk="cast-session_";chrome.cast.media.ke={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};r("chrome.cast.media.MediaCommand",chrome.cast.media.ke);chrome.cast.media.Cc={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};r("chrome.cast.media.MetadataType",chrome.cast.media.Cc);chrome.cast.media.We={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};r("chrome.cast.media.PlayerState",chrome.cast.media.We);
chrome.cast.media.ci={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};r("chrome.cast.media.RepeatMode",chrome.cast.media.ci);chrome.cast.media.In={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};r("chrome.cast.media.ResumeState",chrome.cast.media.In);chrome.cast.media.nk={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};r("chrome.cast.media.StreamType",chrome.cast.media.nk);
chrome.cast.media.cn={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};r("chrome.cast.media.IdleReason",chrome.cast.media.cn);chrome.cast.media.lo={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};r("chrome.cast.media.TrackType",chrome.cast.media.lo);chrome.cast.media.io={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};r("chrome.cast.media.TextTrackType",chrome.cast.media.io);
chrome.cast.media.co={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};r("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.co);chrome.cast.media.jo={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};r("chrome.cast.media.TextTrackWindowType",chrome.cast.media.jo);
chrome.cast.media.eo={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};r("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.eo);chrome.cast.media.fo={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};r("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.fo);chrome.cast.media.Zm=function(){this.customData=null};r("chrome.cast.media.GetStatusRequest",chrome.cast.media.Zm);chrome.cast.media.rn=function(){this.customData=null};r("chrome.cast.media.PauseRequest",chrome.cast.media.rn);chrome.cast.media.tn=function(){this.customData=null};r("chrome.cast.media.PlayRequest",chrome.cast.media.tn);chrome.cast.media.Un=function(){this.customData=this.resumeState=this.currentTime=null};r("chrome.cast.media.SeekRequest",chrome.cast.media.Un);
chrome.cast.media.Xn=function(){this.customData=null};r("chrome.cast.media.StopRequest",chrome.cast.media.Xn);chrome.cast.media.qo=function(a){this.volume=a;this.customData=null};r("chrome.cast.media.VolumeRequest",chrome.cast.media.qo);chrome.cast.media.en=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};r("chrome.cast.media.LoadRequest",chrome.cast.media.en);
chrome.cast.media.uw=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.Um=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};r("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.Um);chrome.cast.media.Ym=function(){this.metadataType=this.type=chrome.cast.media.Cc.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};r("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Ym);
chrome.cast.media.jn=function(){this.metadataType=this.type=chrome.cast.media.Cc.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};r("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.jn);chrome.cast.media.mo=function(){this.metadataType=this.type=chrome.cast.media.Cc.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
r("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.mo);chrome.cast.media.kn=function(){this.metadataType=this.type=chrome.cast.media.Cc.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};r("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.kn);
chrome.cast.media.sn=function(){this.metadataType=this.type=chrome.cast.media.Cc.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};r("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.sn);chrome.cast.media.hn=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.nk.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
r("chrome.cast.media.MediaInfo",chrome.cast.media.hn);chrome.cast.media.wn=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};r("chrome.cast.media.QueueItem",chrome.cast.media.wn);chrome.cast.media.Nm="CC1AD845";r("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.Nm);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;r("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Ja=0;r("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Ja);chrome.cast.media.timeout.play=0;r("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;r("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;r("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;r("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.bd=0;r("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.bd);chrome.cast.media.timeout.wi=0;r("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.wi);chrome.cast.media.timeout.Jq=0;r("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.Jq);chrome.cast.media.ko=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};r("chrome.cast.media.Track",chrome.cast.media.ko);
chrome.cast.media.ho=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};r("chrome.cast.media.TextTrackStyle",chrome.cast.media.ho);chrome.cast.media.yn=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.ci.OFF;this.customData=null};
r("chrome.cast.media.QueueLoadRequest",chrome.cast.media.yn);chrome.cast.media.vn=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};r("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.vn);chrome.cast.media.Cn=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};r("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.Cn);
chrome.cast.media.xn=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};r("chrome.cast.media.QueueJumpRequest",chrome.cast.media.xn);chrome.cast.media.Bn=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};r("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.Bn);
chrome.cast.media.zn=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};r("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.zn);chrome.cast.media.An=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};r("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.An);chrome.cast.media.N=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.We.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.ci.OFF};r("chrome.cast.media.Media",chrome.cast.media.N);chrome.cast.media.N.prototype.Ja=function(){};
chrome.cast.media.N.prototype.getStatus=chrome.cast.media.N.prototype.Ja;chrome.cast.media.N.prototype.play=function(){};chrome.cast.media.N.prototype.play=chrome.cast.media.N.prototype.play;chrome.cast.media.N.prototype.Dq=function(){};chrome.cast.media.N.prototype.playWithContext=chrome.cast.media.N.prototype.Dq;chrome.cast.media.N.prototype.pause=function(){};chrome.cast.media.N.prototype.pause=chrome.cast.media.N.prototype.pause;chrome.cast.media.N.prototype.Cq=function(){};
chrome.cast.media.N.prototype.pauseWithContext=chrome.cast.media.N.prototype.Cq;chrome.cast.media.N.prototype.seek=function(){};chrome.cast.media.N.prototype.seek=chrome.cast.media.N.prototype.seek;chrome.cast.media.N.prototype.stop=function(){};chrome.cast.media.N.prototype.stop=chrome.cast.media.N.prototype.stop;chrome.cast.media.N.prototype.bd=function(){};chrome.cast.media.N.prototype.setVolume=chrome.cast.media.N.prototype.bd;chrome.cast.media.N.prototype.wi=function(){};
chrome.cast.media.N.prototype.editTracksInfo=chrome.cast.media.N.prototype.wi;chrome.cast.media.N.prototype.Lq=function(){};chrome.cast.media.N.prototype.queueInsertItems=chrome.cast.media.N.prototype.Lq;chrome.cast.media.N.prototype.Kq=function(){};chrome.cast.media.N.prototype.queueAppendItem=chrome.cast.media.N.prototype.Kq;chrome.cast.media.N.prototype.Vq=function(){};chrome.cast.media.N.prototype.queueUpdateItems=chrome.cast.media.N.prototype.Vq;chrome.cast.media.N.prototype.Qq=function(){};
chrome.cast.media.N.prototype.queuePrev=chrome.cast.media.N.prototype.Qq;chrome.cast.media.N.prototype.Pq=function(){};chrome.cast.media.N.prototype.queueNext=chrome.cast.media.N.prototype.Pq;chrome.cast.media.N.prototype.Mq=function(a){$l(this,a)};chrome.cast.media.N.prototype.queueJumpToItem=chrome.cast.media.N.prototype.Mq;chrome.cast.media.N.prototype.Uq=function(){};chrome.cast.media.N.prototype.queueSetRepeatMode=chrome.cast.media.N.prototype.Uq;chrome.cast.media.N.prototype.Sq=function(){};
chrome.cast.media.N.prototype.queueRemoveItems=chrome.cast.media.N.prototype.Sq;chrome.cast.media.N.prototype.Rq=function(a){$l(this,a)};chrome.cast.media.N.prototype.queueRemoveItem=chrome.cast.media.N.prototype.Rq;chrome.cast.media.N.prototype.Tq=function(){};chrome.cast.media.N.prototype.queueReorderItems=chrome.cast.media.N.prototype.Tq;chrome.cast.media.N.prototype.Oq=function(a,b,c,d){a=$l(this,a);0>a||(0>b?d&&d(new chrome.cast.Error(chrome.cast.jd.INVALID_PARAMETER)):a==b&&c&&c())};
chrome.cast.media.N.prototype.queueMoveItemToNewIndex=chrome.cast.media.N.prototype.Oq;chrome.cast.media.N.prototype.Br=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.N.prototype.supportsCommand=chrome.cast.media.N.prototype.Br;chrome.cast.media.N.prototype.np=function(){return this.currentTime};chrome.cast.media.N.prototype.getEstimatedTime=chrome.cast.media.N.prototype.np;chrome.cast.media.N.prototype.li=function(){};
chrome.cast.media.N.prototype.addUpdateListener=chrome.cast.media.N.prototype.li;chrome.cast.media.N.prototype.mi=function(){};chrome.cast.media.N.prototype.addUpdateListenerWithContext=chrome.cast.media.N.prototype.mi;chrome.cast.media.N.prototype.yj=function(){};chrome.cast.media.N.prototype.removeUpdateListener=chrome.cast.media.N.prototype.yj;chrome.cast.media.N.prototype.zj=function(){};chrome.cast.media.N.prototype.removeUpdateListenerWithContext=chrome.cast.media.N.prototype.zj;
var $l=function(a,b){return gc(a.items,function(a){return a.itemId==b})};var am=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var bm=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.P=function(a,b,c,d,e){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.mk.CONNECTED;this.transportId=""};r("chrome.cast.Session",chrome.cast.P);chrome.cast.P.prototype.sr=function(a,b,c){this.tm(null,a,b,c)};chrome.cast.P.prototype.setReceiverVolumeLevel=chrome.cast.P.prototype.sr;
chrome.cast.P.prototype.tm=function(a,b,c,d){b=new bm(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,d)};chrome.cast.P.prototype.setReceiverVolumeLevelWithContext=chrome.cast.P.prototype.tm;chrome.cast.P.prototype.rr=function(a,b,c){this.sm(null,a,b,c)};chrome.cast.P.prototype.setReceiverMuted=chrome.cast.P.prototype.rr;
chrome.cast.P.prototype.sm=function(a,b,c,d){a=new bm(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,d)};chrome.cast.P.prototype.setReceiverMutedWithContext=chrome.cast.P.prototype.sm;chrome.cast.P.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.P.prototype.leave=chrome.cast.P.prototype.leave;chrome.cast.P.prototype.stop=function(){};chrome.cast.P.prototype.stop=chrome.cast.P.prototype.stop;
chrome.cast.P.prototype.yr=function(){};chrome.cast.P.prototype.stopWithContext=chrome.cast.P.prototype.yr;chrome.cast.P.prototype.sendMessage=function(){};chrome.cast.P.prototype.sendMessage=chrome.cast.P.prototype.sendMessage;chrome.cast.P.prototype.hr=function(){};chrome.cast.P.prototype.sendMessageWithContext=chrome.cast.P.prototype.hr;chrome.cast.P.prototype.li=function(){};chrome.cast.P.prototype.addUpdateListener=chrome.cast.P.prototype.li;chrome.cast.P.prototype.mi=function(){};
chrome.cast.P.prototype.addUpdateListenerWithContext=chrome.cast.P.prototype.mi;chrome.cast.P.prototype.yj=function(){};chrome.cast.P.prototype.removeUpdateListener=chrome.cast.P.prototype.yj;chrome.cast.P.prototype.zj=function(){};chrome.cast.P.prototype.removeUpdateListenerWithContext=chrome.cast.P.prototype.zj;chrome.cast.P.prototype.Ko=function(){};chrome.cast.P.prototype.addMessageListener=chrome.cast.P.prototype.Ko;chrome.cast.P.prototype.Lo=function(){};
chrome.cast.P.prototype.addMessageListenerWithContext=chrome.cast.P.prototype.Lo;chrome.cast.P.prototype.Io=function(){};chrome.cast.P.prototype.addMediaListener=chrome.cast.P.prototype.Io;chrome.cast.P.prototype.Jo=function(){};chrome.cast.P.prototype.addMediaListenerWithContext=chrome.cast.P.prototype.Jo;chrome.cast.P.prototype.Zq=function(){};chrome.cast.P.prototype.removeMediaListener=chrome.cast.P.prototype.Zq;chrome.cast.P.prototype.ar=function(){};
chrome.cast.P.prototype.removeMediaListenerWithContext=chrome.cast.P.prototype.ar;chrome.cast.P.prototype.br=function(){};chrome.cast.P.prototype.removeMessageListener=chrome.cast.P.prototype.br;chrome.cast.P.prototype.cr=function(){};chrome.cast.P.prototype.removeMessageListenerWithContext=chrome.cast.P.prototype.cr;chrome.cast.P.prototype.Fp=function(a){a.sessionId=this.sessionId};chrome.cast.P.prototype.loadMedia=chrome.cast.P.prototype.Fp;chrome.cast.P.prototype.Nq=function(a){a.sessionId=this.sessionId};
chrome.cast.P.prototype.queueLoad=chrome.cast.P.prototype.Nq;var em=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=cm(a);a=new chrome.cast.P(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||dm(a)))return null;a.receiver.volume=b.volume;Sa(b.isActiveInput)&&(a.receiver.isActiveInput=b.isActiveInput);return a},fm=function(a){var b=[];if(!a)return b;
a&1&&b.push(chrome.cast.Hd.VIDEO_OUT);a&2&&b.push(chrome.cast.Hd.VIDEO_IN);a&4&&b.push(chrome.cast.Hd.AUDIO_OUT);a&8&&b.push(chrome.cast.Hd.AUDIO_IN);a&32&&b.push(chrome.cast.Hd.MULTIZONE_GROUP);return b},cm=function(a){var b=Oj(Nj(),a.getId());return new chrome.cast.bi(b,a.f.friendlyName,fm(a.b))},gm=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],d=b.namespaces||[];if(c.length!=d.length)return!0;for(var e={index:0};e.index<c.length;e={index:e.index},e.index++)if(!d.some(function(a){return function(b){return b.name==
c[a.index].name}}(e)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},hm=function(a){eb(a)?a.forEach(hm):jb(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(jb(a[b])||eb(a[b]))&&hm(a[b])})},im=function(a){return a.namespaces.some(function(a){return a.name==hj})},dm=function(a){return null!==a&&"MultizoneLeader"==a.appId},jm=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var km=function(a,b,c){this.type=a;this.message=b;this.sequenceNumber=Qa(c)?c:-1;this.timeoutMillis=0;this.clientId=""};var lm=function(a,b){this.g=a;this.b=b;this.h=[];this.f=new ul},nm=function(a,b){return(a=mm(a.b,b))?a.routeId:null};lm.prototype.listen=function(a,b){this.h[a]=b};var pm=function(a,b,c,d){Cb(om,"Sending to "+c);Cb(om,JSON.stringify(d));d.clientId=c;a.g.f.Vd(b,d)},qm=function(a,b,c){var d=mm(a.b,b);d&&d.b?pm(a,d.routeId,b,c):a.connect(b).then(function(d){d?(d=nm(a,b))?pm(a,d,b,c):v(om,"No route for "+b):v(om,"No connected client "+b)},null)};
lm.prototype.connect=function(a){var b=mm(this.b,a);if(null!=b&&b.b)return Promise.resolve(!0);b=nm(this,a);if(!b)return v(om,"No route for client "+a),Promise.resolve(!1);if(a=this.f.b.get(b,null))return a.mb.b;a=new Tb;vl(this.f,new rm(b,a));return a.b};var om=vb("mr.cast.ApiMessenger"),rm=function(a,b){tl.call(this,a,3E4);this.mb=b};l(rm,tl);rm.prototype.b=function(){this.mb.resolve(!1)};var sm=function(a,b,c){this.h=a;this.b=b;this.f=c},tm=function(a){var b="cast-dial:"+a.h,c=new URLSearchParams;a.b&&c.set("dialPostData",a.b);a.f&&c.set("clientId",a.f);(a=c.toString())&&(b+="?"+a);return b};var um=function(a,b,c,d,e,f,h,k,n,u){this.j=a;this.b=b||null;this.f=c||null;this.h=d||null;this.g=Qa(e)?e:null;this.u=f||null;this.A=h||null;this.o=k||!1;this.m=n||null;this.s=u||null},vm=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},xm=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:bc(cc(a,function(a){a=vm(a,"__castAppId__");if(!a)return null;a=a.match(wm);if(!a||0==a.length)return null;var b=[];3==a.length&&a[2]&&(b=a[2].split(","));return{appId:a[1],capabilities:b}}),
function(a){return null!=a})},ym=function(a){return cc(a.j,function(a){return a.appId})},zm=function(a){return a.f?a.f:chrome.cast.hd.TAB_AND_ORIGIN_SCOPED},Am=function(a){var b=a.j.map(function(b){var c="cast:"+b.appId,e=new URLSearchParams;b.capabilities&&0<b.capabilities.length&&e.set("capabilities",b.capabilities.join(","));a.b&&e.set("clientId",a.b);a.f&&e.set("autoJoinPolicy",a.f);a.h&&e.set("defaultActionPolicy",a.h);null!=a.g&&e.set("launchTimeout",String(a.g));a.o&&e.set("invisibleSender",
"true");a.m&&(e.set("broadcastNamespace",a.m),e.set("broadcastId",String(Math.random())));a.s&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.s)));return c+"?"+e.toString()});a.u&&b.push(tm(new sm(a.u,a.A,a.b)));return b},Cm=function(a,b){a=ym(a);var c=Bm(b);return ec(a,function(a){return jc(c,a)})},Dm=function(a){try{var b=new URL(a)}catch(z){return null}if("https:"==b.protocol)if("https:"!=b.protocol||"google.com"!=b.host||"/cast"!=b.pathname)a=null;else{var c=b.hash;if((a=xm(c))&&
0!=a.length){b=vm(c,"__castClientId__");var d=vm(c,"__castAutoJoinPolicy__"),e=vm(c,"__castDefaultActionPolicy__");var f=vm(c,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var h=vm(c,"__dialAppName__"),k=vm(c,"__dialPostData__");var n=vm(c,"__castInvisibleSender__");n=null===n?null:"true"==n;var u=vm(c,"__castBroadcastNamespace__");c=(c=vm(c,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(c)):null;a=new um(a,b,d,e,f,h,k,n,u,c)}else a=null}else if("cast:"==
b.protocol){a=b.pathname;d=b.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=b.searchParams;b=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");c=Number(k.get("launchTimeout"));if(isNaN(c)||0>=c)c=null;f="true"==k.get("invisibleSender");h=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new um([a],b,d,e,c,void 0,void 0,f,h,k)}else a=null;return a},Bm=function(a){return(a=Dm(a))?ym(a):null},Em=
function(a){return(a=Dm(a))?a.b:null},wm=/(^\w+)(?:\(([\w, ]*)\))?$/;var Fm=function(a,b,c){this.J=vb("mr.MediaRouteController."+a);this.g=new mojo.Binding(mojo.MediaController,this,b);this.h=c;this.b=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.B=!1;this.g.setConnectionErrorHandler(this.o.bind(this));this.h.ptr.setConnectionErrorHandler(this.o.bind(this))};Fm.prototype.o=function(){this.Ra();this.m()};
Fm.prototype.Ra=function(){this.B||(this.B=!0,this.s(),this.g&&(this.g.close(),this.g=null),this.h&&(this.h.ptr.reset(),this.h=null))};var Gm=function(a){if(a.h)a.h.onMediaStatusUpdated(a.b)};Fm.prototype.s=function(){};Fm.prototype.m=function(){};Fm.prototype.play=function(){};Fm.prototype.play=Fm.prototype.play;Fm.prototype.pause=function(){};Fm.prototype.pause=Fm.prototype.pause;Fm.prototype.Se=function(){};Fm.prototype.setMute=Fm.prototype.Se;Fm.prototype.bd=function(){};
Fm.prototype.setVolume=Fm.prototype.bd;Fm.prototype.seek=function(){};Fm.prototype.seek=Fm.prototype.seek;Fm.prototype.ui=function(a){a.close();throw Error("Not implemented");};Fm.prototype.connectHangoutsMediaRouteController=Fm.prototype.ui;var Hm=function(a){var b=new URL(a);a={};a.scheme=b.protocol.replace(":","");a.host=b.hostname;b=b.port?Number.parseInt(b.port,10):0;switch(a.scheme){case "http":a.port=b||80;break;case "https":a.port=b||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},Im=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Jm=function(a,b,c,d){this.type=a;this.mediaSessionId=b;this.requestId=0;this.sessionId=c;this.currentTime=d},Lm=function(a,b,c,d,e){Fm.call(this,"CastRouteController",a,b);this.session=c;this.f=d;this.j=e;this.A=new Date;this.u=new Set;Km(this);ik(0)};l(Lm,Fm);
var Km=function(a){var b=Mm(a);b&&Nm(a,b);b&&a.j||!a.session.statusText||(a.b.title=a.session.statusText.substring(0,256));a.b.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.b.is_muted=!!a.session.receiver.volume.muted;a.b.can_mute=a.session.receiver.volume.controlType!==chrome.cast.rk.FIXED;a.b.can_set_volume=a.b.can_mute;Gm(a)};Lm.prototype.m=function(){Om(this.f.b,this.session.sessionId)};
Lm.prototype.play=function(){var a=Mm(this);this.b.can_play_pause&&a&&this.b.play_state===mojo.MediaStatus.PlayState.PAUSED&&Pm(this.f,this.session,new Jm("PLAY",a.mediaSessionId,this.session.sessionId));Qm(this,1)};Lm.prototype.play=Lm.prototype.play;Lm.prototype.pause=function(){var a=Mm(this);this.b.can_play_pause&&a&&this.b.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Pm(this.f,this.session,new Jm("PAUSE",a.mediaSessionId,this.session.sessionId));Qm(this,1)};Lm.prototype.pause=Lm.prototype.pause;
Lm.prototype.seek=function(a){var b=Mm(this);a=a?a.microseconds/1E6:0;var c;if(c=this.b.can_seek&&b&&0<=a)c=this.b.duration,c=a<=(c?c.microseconds/1E6:0);c&&Pm(this.f,this.session,new Jm("SEEK",b.mediaSessionId,this.session.sessionId,a));Qm(this,2)};Lm.prototype.seek=Lm.prototype.seek;Lm.prototype.Se=function(a){this.b.can_mute&&a!==this.b.is_muted&&Rm(this.f,this.session,new chrome.cast.Volume(null,a));Qm(this,3)};Lm.prototype.setMute=Lm.prototype.Se;
Lm.prototype.bd=function(a){this.b.can_set_volume&&0<=a&&1>=a&&Rm(this.f,this.session,new chrome.cast.Volume(a));Qm(this,4)};Lm.prototype.setVolume=Lm.prototype.bd;
var Mm=function(a){return a.session.media.find(function(a){return!a.idleReason})||null},Nm=function(a,b){a.j&&b.media&&b.media.metadata&&b.media.metadata.title&&(a.b.title=b.media.metadata.title.substring(0,256));a.b.can_play_pause=b.supportedMediaCommands.includes(chrome.cast.media.ke.PAUSE);a.b.can_seek=b.supportedMediaCommands.includes(chrome.cast.media.ke.SEEK);var c=b.playerState;a.b.play_state=c===chrome.cast.media.We.PLAYING?mojo.MediaStatus.PlayState.PLAYING:c===chrome.cast.media.We.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.b.current_time=b.currentTime?Im(b.playerState===chrome.cast.media.We.PLAYING?b.currentTime+(new Date-a.A)/1E3:b.currentTime):Im(0);a.b.duration=b.media&&b.media.duration?Im(b.media.duration):Im(0)},Qm=function(a,b){0==a.u.size&&ik(5);a.u.has(b)||(ik(b),a.u.add(b))};var Sm=function(a){this.f=a;this.l=vb("mr.cast.SessionLauncher")},Tm=function(a,b,c){Rb("MediaRouter.Cast.Session.Type",0,Zj);return Hl(a.f,b,c).then(a.b.bind(a,c),function(a){a&&Il==a?kk(1):kk(0);throw a;})};Sm.prototype.b=function(a,b){Cb(this.l,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw kk(2),Error(b.reason);a=em(a,b.status);this.l.info("Launched session: "+a.sessionId);return a};var Um=function(a){this.b=a;this.l=vb("mr.cast.ReceiverStatusQuerier")},Vm=function(a,b){return Ee(new Ce(p(a.f,a,b),3500,5),2).start().then(null,function(c){a.l.info("Failed to get receiver status from "+b.getId());throw c;})};Um.prototype.f=function(a){this.l.info("Query receiver status: "+a.getId());return this.b.sendRequest(new sl,a,fj)};var Wm=function(a,b,c,d,e,f){this.h=a;this.s=b;this.j=c;this.b=d;this.m=e;this.g=f;this.f=new lm(f,c);this.B=new Um(this.h);this.F=new Sm(this.h)};Wm.prototype.init=function(){this.j.init();this.f.listen("v2_message",this.A.bind(this));this.f.listen("app_message",this.o.bind(this));this.f.listen("leave_session",this.u.bind(this))};
var Zm=function(a,b,c,d){Xm(a.b,b).slice().forEach(function(b){b!=d&&Ym(a,b,c)})},Ym=function(a,b,c){c.clientId=b;qm(a.f,b,c)},$m=function(a,b,c,d){c={receiver:cm(c),action:d};Ym(a,b,new km("receiver_action",c))};
Wm.prototype.A=function(a){var b=a.message,c=b.sessionId;if(c){var d=an(this.b,c);if(d)if(c=bn(this.b,c))if(c=this.s.ha(c))switch(b.type){case "STOP":cn(this,a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":dn(this,a,c,d);break;case "SET_VOLUME":en(this,a,c);break;default:v(fn,"Unknown request")}else gn(this,
a,chrome.cast.jd.INVALID_PARAMETER,"No receiver");else gn(this,a,chrome.cast.jd.INVALID_PARAMETER,"No sink ID");else gn(this,a,chrome.cast.jd.INVALID_PARAMETER,"Unknown session ID")}else gn(this,a,chrome.cast.jd.INVALID_PARAMETER,"No session ID")};
var gn=function(a,b,c,d){c=new chrome.cast.Error(c,d);hn(a,b,c)},hn=function(a,b,c){qm(a.f,b.clientId,new km("error",c,b.sequenceNumber))},cn=function(a,b,c){var d=b.message;Qb("MediaRouter.Cast.Session.End");var e=d.sessionId,f=jn(a.b,e);f&&(f.j=!0);f=function(){kn(a,e,b)};a.h.sendRequest(d,c,fj,b.timeoutMillis,b.clientId).then(f,f)},dn=function(a,b,c,d){var e=b.message,f=e.type;f in rl&&(e.type=rl[f]);a.h.sendRequest(e,c,hj,b.timeoutMillis,b.clientId,d.transportId).then(function(c){ln(a,d,c);qm(a.f,
b.clientId,new km("v2_message",c,b.sequenceNumber))},function(c){hn(a,b,c)})},en=function(a,b,c){var d=b.message;delete d.sessionId;a.h.sendRequest(d,c,fj,b.timeoutMillis,b.clientId).then(function(){qm(a.f,b.clientId,new km("v2_message",null,b.sequenceNumber))},function(c){hn(a,b,c)})};
Wm.prototype.o=function(a){var b=this,c=a.message,d=c.sessionId;if(d){var e=bn(this.b,d);e?(e=this.s.ha(e))?(d=an(this.b,d),hc(d.namespaces,function(a){return a.name==c.namespaceName})?Fl(this.m,e,c.namespaceName,c.message,a.clientId,d.transportId).then(function(){qm(b.f,a.clientId,new km("app_message",null,a.sequenceNumber))},function(){gn(b,a,chrome.cast.jd.CHANNEL_ERROR,"Channel to receiver not available")}):gn(this,a,chrome.cast.jd.INVALID_PARAMETER,"Invalid namespace")):v(fn,"No receiver from sinkId"):
v(fn,"No sinkId from sessionId")}else v(fn,"No sessionId")};
Wm.prototype.u=function(a){var b=this;fn.info("Leave session");var c=jn(this.b,a.message);if(c){var d=a.clientId,e=mm(this.j,d);if(e){var f=[],h=[],k=e.tabId,n=e.origin,u=e.autoJoinPolicy;c.f.forEach(function(a){var c=mm(b.j,a);u==chrome.cast.hd.TAB_AND_ORIGIN_SCOPED&&k==c.tabId&&n==c.origin||u==chrome.cast.hd.ORIGIN_SCOPED&&n==c.origin?(c.f=!0,f.push(a)):h.push(a)});qm(this.f,d,new km("leave_session",null,a.sequenceNumber));f.forEach(function(a){(a=mm(b.j,a))&&mn(b.g,a.routeId,!0,!0)});c.f=h}else v(fn,
"No client record")}else v(fn,"No session")};
var nn=function(a,b,c){im(b)&&a.h.sendRequest(new sl,c,hj,void 0,void 0,b.transportId).catch(Za)},Vk=function(a,b,c){var d=b.getId();fn.info("Query status for "+d);Vm(a.B,b).then(function(e){on(a,d,e);c&&(e=pn(a.b,d))&&nn(a,e,b)},Za)},qn=function(a,b){if("*"==b.destinationId)return!0;b=b.destinationId;if(b==a.m.m||null!=mm(a.j,b))return!0;fn.info("Invalid destination "+b);return!1},vn=function(a,b,c){Cb(fn,function(){return"Cast message: "+JSON.stringify(c)});if(qn(a,c))if(c.namespace_==gj||c.namespace_==
ij)(b=rn(a.b,b))&&b.b.forEach(function(b){var d=a.g,e=d.h.get(b);e&&e.gf&&d.f.Hh(b,c)});else{var d=JSON.parse(c.data),e=sn(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":on(a,b,d);break;case "MEDIA_STATUS":tn(a,b,c,e)}}else un(a.m,b,c.destinationId,c.sourceId,!1)},sn=function(a,b){a=wl(a.h.b,b.requestId);if(!a)return null;var c=a.mb;switch(b.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete b.requestId;c.reject(new chrome.cast.Error(chrome.cast.jd.SESSION_ERROR,
b.reason||b.type,b));break;default:c.resolve(b)}return a},wn=function(a,b,c){Cb(fn,function(){return"App message: "+JSON.stringify(c)});if(b=pn(a.b,b)){var d;"*"==c.destinationId?d=Xm(a.b,b.sessionId):d=[c.destinationId];var e=new am(b.sessionId,c.namespace_,c.data);d.forEach(function(b){qm(a.f,b,new km("app_message",e))})}else v(fn,"No session for incoming app message")},xn=function(a,b){a.forEach(function(a){a.sessionId=b;var c=a.supportedMediaCommands,e=[];c&1&&e.push(chrome.cast.media.ke.PAUSE);
c&2&&e.push(chrome.cast.media.ke.SEEK);c&4&&e.push(chrome.cast.media.ke.STREAM_VOLUME);c&8&&e.push(chrome.cast.media.ke.STREAM_MUTE);a.supportedMediaCommands=e});return a},ln=function(a,b,c){b=b.sessionId;c.sessionId=b;c=xn(c.status,b);yn(a.b,b,c);(a=jn(a.b,b))&&a.controller&&(a=a.controller,a.A=new Date,(c=Mm(a))?Nm(a,c):(a.j&&(a.b.title=""),a.b.can_play_pause=!1,a.b.can_seek=!1),Gm(a))},zn=function(a,b){if(b=pn(a.b,b)){b=b.sessionId;var c=jn(a.b,b);c&&c.j||kn(a,b)}},kn=function(a,b,c){c&&Ym(a,c.clientId,
c);(c=jn(a.b,b))&&c.b.slice().forEach(function(b){mn(a.g,b,!0)});An(a.b,b);Bn(a.g)},on=function(a,b,c){Cb(fn,"Receiver status for "+b);var d=c.status;if(d)if(c=a.s.ha(b)){d=em(c,d);var e=rn(a.b,b);e?d?d.sessionId==e.session.sessionId?(b=e.session,gm(b,d)&&(Cb(fn,"Updating session "+d.sessionId),e.h&&(b.statusText=d.statusText),b.namespaces=d.namespaces,b.receiver.volume=d.receiver.volume,Cn(a.g,e),Zm(a,b.sessionId,new km("update_session",b)),e.controller&&Km(e.controller))):(zn(a,b),gk(1),Dn(a.g,
null,c,null,d)):(zn(a,b),gk(1)):d&&Dn(a.g,null,c,null,d)}else Qb("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),v(fn,"Got message from receiver "+b+", but sink is no longer available.")},tn=function(a,b,c,d){if(b=pn(a.b,b))if(c=JSON.parse(c.data))ln(a,b,c),Zm(a,c.sessionId,new km("v2_message",c),d)},En=function(a,b){var c=fm(b.b);return(b=hc(a.j,function(a){return fc(a.capabilities,function(a){return jc(c,a)})}))?b.appId:ym(a)[0]},Fn=function(a,b,c){var d=Dm(b);if(!d)return Promise.reject(Error("Invalid source "+
b));var e=En(d,c),f=new Gb("MediaRouter.Cast.Session.Launch");return Tm(a.F,new chrome.cast.lk(e,void 0,null==d.g?chrome.cast.timeout.requestSession:d.g),c).then(function(a){fn.info("Launched session "+a.sessionId+" for appId "+e);f.b("Success");return a},function(a){fn.error("Failed to session for appId "+e);f.b("Failure");throw a;})};
Wm.prototype.createMediaRouteController=function(a,b,c){a=Gn(this.b,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=Hn(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Lm(b,c,d,this,a.h);nn(this,d,e);return null};
var Pm=function(a,b,c){var d=Hn(a,b.sessionId);d&&a.h.sendRequest(c,d,hj,0,"",b.transportId).catch(function(a){v(fn,"Failed to send a media control request: "+a)})},Rm=function(a,b,c){c=new bm(c);(b=Hn(a,b.sessionId))&&a.h.sendRequest(c,b,fj).catch(function(a){v(fn,"Failed to send a volume control request: "+a)})},Hn=function(a,b){return(b=bn(a.b,b))?a.s.ha(b):null},fn=vb("mr.cast.ApiHandler");var In=function(a){return"0F5096E8"==a||"85CDB22F"==a};var Jn=function(){},Kn=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;var c=b.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!c)return null;b=new Jn;b.h=a;a=la(c);a.next();b.b=a.next().value;b.g=a.next().value;b.j=a.next().value;b.f=a.next().value;return b};Jn.prototype.fa=function(){return this.f};var Ln=function(a,b,c,d,e,f){this.id=a;this.presentationId=b;this.sinkId=c;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.gf=e;this.isOffscreenPresentation=!1},Mn=function(a,b,c,d,e,f){b=d&&Hg(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+d;return new Ln(b,
a,c,d,e,f)};var Nn=function(a,b,c,d){c=Mn(c,"cast",b.getId(),a,d,"");c.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(c.controllerType=d&&Eg(a)&&b.b&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return c},On=function(a,b){var c=b.zb.dc;c&&(b.description=Tg(c),a.displayName="",a.statusText="mirror_desktop"==c.f?"":c.h||"")};var Pn=function(a,b){if(!chrome.runtime.lastError)return null;a=a+" failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");b&&Cb(b,a);return Error(a)};var Qn=function(){this.f=new Hk;this.h=new Hk;this.b=new Hk},Wn=function(a,b,c){c=void 0===c?!1:c;var d=b.getId(),e=b.hb()+":"+b.Sa(),f=a.f.get(d);if(f){if(a.b.get(d)==e)return Cb(Sn,"Using pending creation to "+d),f;Sn.info("Device "+d+" IP changed from "+a.b.get(b.getId())+" to "+e);Tn(a,b)}b=Un(a,b,c?15E3:1E4).then(function(b){Vn(a,d);hk(1);return b},function(b){e==a.b.get(d)&&Vn(a,d);hk(0);return Promise.reject(b)});a.f.set(d,b);a.b.set(d,e);return b},Tn=function(a,b){b=b.getId();Cb(Sn,"Aborting connection to device "+
b);var c=a.h.get(b);c&&c.abort();Vn(a,b)},Vn=function(a,b){a.f.remove(b);a.h.remove(b);a.b.remove(b)},Un=function(a,b,c){var d=new Ce(function(){return Xn(b,c)},1E3,3);a.h.set(b.getId(),d);return Ee(d,1.5).start().then(null,function(a){Sn.info("Failed to create channel to "+b.getId());return Promise.reject(a)})},Xn=function(a,b){var c=Yn++;Sn.info("Connecting to (id "+c+") "+a.getId());var d=new Gb("MediaRouter.Cast.Mdns.Channel.Open");return Zn(a,b).then(function(a){Sn.info(function(){return"Channel opened (id "+
c+"): "+JSON.stringify(a)});d.b("Success");return a},function(a){Sn.info("Channel did not open (id "+c+").");d.b("Failure");return Promise.reject(a)})},Zn=function(a,b){var c={ipAddress:a.hb(),port:a.Sa(),auth:"ssl_verified",timeout:1E4,livenessTimeout:b,pingInterval:5E3,capabilities:0};Sn.info(function(){return"Opening channel to "+JSON.stringify(c)});var d=new Tb;chrome.cast.channel.open(c,function(a){a?"open"==a.readyState?d.resolve(a):(Pn("chrome.cast.channel.open",Sn),chrome.cast.channel.close(a,
function(){Pn("chrome.cast.channel.close",Sn)}),d.reject(Error(a.errorState))):(a=Pn("chrome.cast.channel.open",Sn),d.reject(a))});return d.b},Sn=vb("mr.cast.ChannelFactory"),Yn=0;var $n=function(a,b,c,d){return{namespace_:a,data:Ra(b)?b:JSON.stringify(b),sourceId:c,destinationId:d}};var ao=function(a){this.type="CLOSE";this.reasonCode=a};var bo=function(a){return(a=a.exec(bd))?a[1]:""},co=function(){if(uh)return bo(/Firefox\/([0-9.]+)/);if(Gd||Hd||Fd)return Zd;if(yh)return Ad()?bo(/CriOS\/([0-9.]+)/):bo(/Chrome\/([0-9.]+)/);if(zh&&!Ad())return bo(/Version\/([0-9.]+)/);if(vh||wh){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(bd);if(a)return a[1]+"."+a[2]}else if(xh)return(a=bo(/Android\s+([0-9.]+)/))?a:bo(/Version\/([0-9.]+)/);return""}(),eo=function(a){return 0<=Zc(co,a)};var go=function(a){this.type="CONNECT";this.origin={};this.userAgent=bd;var b=this.userAgent.indexOf("(")+1;b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:co,platform:fo(),systemVersion:b,connectionType:1};this.connType=a?0:2},fo=function(){switch(ag()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var ho=function(){this.b=new Hk};ho.prototype.init=function(){tj(this)};var io=function(a,b,c,d,e){if(!Kk(a.b,[b.channelId,c,d].join("#"))){var f=$n(ej,new go(e),c,d);chrome.cast.channel.send(b,f,a.f.bind(a));a.b.set([b.channelId,c,d].join("#"),e)}};ho.prototype.f=function(){Pn("chrome.cast.channel.send",jo)};
var Yk=function(a,b){a.b.xb().forEach(function(c){c.split("#")[0]==b.channelId.toString()&&a.b.remove(c)})},Uk=function(a,b,c){a.b.forEach(function(d,e){var f=e.split("#");f[0]==b.channelId.toString()&&(io(a,c,f[1],f[2],d),a.b.remove(e))})};ho.prototype.va=function(){return"cast.VirtualConnectionManager"};ho.prototype.Ta=function(){var a=Nk(this.b);return[new ko(a)]};ho.prototype.ab=function(){var a=qj(this);if(a)for(var b in a.b)this.b.set(b,a.b[b])};$a(ho);
var jo=vb("mr.cast.VirtualConnectionManager"),ko=function(a){this.b=a};var lo=function(a,b){this.j=b;this.m=a;this.f=new Hk;this.b=new Hk;this.h=ho.Ia();this.o=new Qn;this.s=!0;this.ha=null;this.g=new Hk};l(lo,qg);lo.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.A.apply(this,Na(c)):a==chrome.cast.channel.onError&&this.u.apply(this,Na(c))};lo.prototype.init=function(a){this.s=void 0===a?!0:a;this.h.init();tj(this);Ag("mr.cast.ChannelService",this);tk().forEach(function(a){return a.addListener()})};
var Fl=function(a,b,c,d,e,f){var h=e||a.m,k=f||"receiver-0";return il(a,b).then(function(b){return mo(a,b,c,d,h,k)})},no=function(a,b,c,d,e){il(a,b).then(function(b){return io(a.h,b,c,d,e)})},un=function(a,b,c,d,e){if(b=a.f.get(b))a=a.h,Kk(a.b,[b.channelId,c,d].join("#"))&&(a.b.remove([b.channelId,c,d].join("#")),c=$n(ej,new ao(e?5:0),c,d),chrome.cast.channel.send(b,c,a.f.bind(a)))};
lo.prototype.A=function(a,b){var c=this.b.get(a.channelId);if(c){var d=this.ha(c);if(d){if(kj.hasOwnProperty(b.namespace_)){var e=JSON.parse(b.data);switch(e.type){case "CLOSE":this.h.b.remove([a.channelId,b.destinationId,b.sourceId].join("#"));return;case "RPC":break;default:Cb(Tk,function(){return"Got message "+(e.type||e.responseType)+" "+("from "+d.getId())})}}else Cb(Tk,"Got message in "+b.namespace_+" from "+d.getId());oo(this.j,d,b)}else v(Tk,"Got message for unknown receiver (receiverId="+
c+").")}else v(Tk,"Got message for unknown channel (channelId="+a.channelId+").")};var po=function(a,b){a.s&&chrome.cast.channel.close(b,function(){chrome.runtime.lastError||Cb(Tk,"Channel close success")});var c=a.b.get(b.channelId);c&&(a.b.remove(b.channelId),a.f.remove(c))};lo.prototype.u=function(a,b){v(Tk,function(){return"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):"")});b&&qo(b);ro(this,a)};
var qo=function(a){switch(a.errorState){case "unknown":var b=0;break;case "authentication_error":b=1;break;case "connect_error":b=2;break;case "connect_timeout":b=6;break;case "ping_timeout":b=7;break;default:return}if(-8192<=a.nssErrorCode&&-7192>a.nssErrorCode||2==a.challengeReplyErrorType||8==a.challengeReplyErrorType||9==a.challengeReplyErrorType||11==a.challengeReplyErrorType||-200>=a.netReturnValue&&-300<a.netReturnValue||30==a.eventType||31==a.eventType||32==a.eventType)b=3;if(26==a.eventType||
-201==a.netReturnValue||-8181==a.nssErrorCode||-8162==a.nssErrorCode||-8161==a.nssErrorCode)b=4;-138==a.netReturnValue&&(b=5);if(-8182==a.nssErrorCode||10==a.eventType||12==a.eventType)b=1;v(Tk,"Channel error code: "+b);Rb("MediaRouter.Cast.Channel.Error",b,dk)},ro=function(a,b){var c=a.b.get(b.channelId);po(a,b);if(!a.s)Cb(Tk,"Close channel for receiver: "+c+", skip retry");else if(c){var d=a.ha(c);d&&il(a,d,!0).then(function(c){Tk.info("Re-connected to receiver: "+d.getId());Uk(a.h,b,c);Vk(a.j.j,
d,!0)},function(){Tk.info("Failed to re-connect to receiver: "+d.getId());Yk(a.h,b);var c=a.j.b,f=d.getId();c.l.info("Channel error for sink "+f);Zk(c,f);gk(2)})}},il=function(a,b,c){c=void 0===c?!1:c;var d=b.getId(),e=a.f.get(d);return e&&"open"==e.readyState?Promise.resolve(e):a.s?Wn(a.o,b,c).then(function(b){if(Kk(a.b,b.channelId))return b;a.f.get(d)&&(v(Tk,"Duplicate channel to a receiver "+d),po(a,a.f.get(d)));Tk.info("Connected to: "+d);a.f.set(d,b);a.b.set(b.channelId,d);return b},null):(Tk.info("Channel not found for receiver: "+
d),Promise.reject(Error("Channel not found for receiver: "+d)))},mo=function(a,b,c,d,e,f){io(a.h,b,e,f,0==f.indexOf("receiver-0"));hm(d);var h=$n(c,d,e,f);"object"===typeof d&&"RPC"==d.type||Cb(Tk,function(){return"Channel is sending message: "+JSON.stringify(h)});return new Promise(function(c,d){chrome.cast.channel.send(b,h,function(b){b?b.errorState?(d(Error("Failed to send message")),ro(a,b)):c(!0):(b=Pn("chrome.cast.channel.send",Tk),d(b))})})};lo.prototype.va=function(){return"cast.ChannelService"};
lo.prototype.Ta=function(){return[new so(Nk(this.f),Nk(this.b),Nk(this.g))]};lo.prototype.ab=function(){var a=qj(this);a&&(Gk(this.f,a.f),Gk(this.b,a.b),Gk(this.g,a.h))};var Tk=vb("mr.cast.ChannelService"),so=function(a,b,c){this.f=a;this.b=b;this.h=c};var to=function(a,b,c,d,e,f){this.routeId=a;this.clientId=b;this.appIds=c;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.f=this.b=!1},uo=function(){this.b=[]};uo.prototype.init=function(){tj(this)};uo.prototype.pa=function(){return this.b.length};var mm=function(a,b){return hc(a.b,function(a){return a.clientId==b})},vo=function(a,b){return hc(a.b,function(a){return a.routeId==b})},wo=function(a,b){a.b=bc(a.b,function(a){return a.clientId!=b})};uo.prototype.va=function(){return"cast.ClientRecords"};
uo.prototype.Ta=function(){return[new xo(this.b)]};uo.prototype.ab=function(){var a=qj(this);a&&(this.b=a.b)};var xo=function(a){this.b=a};var yo=function(a){this.b=a},zo=function(){var a=[];Nj().j.forEach(function(b){var c="Receiver-"+b.replace(/\./g,"_"),d=Nj().b||8009;a.push({serviceName:c+"._googlecast._tcp.local",serviceHostPort:0<b.indexOf(":")?"["+b+"]:"+d:b+":"+d,ipAddress:b,serviceData:["id=mdns:"+c,"ve=02","ca=5","st=1","fn="+c,"md=Chromecast"]})});return a};yo.prototype.init=function(){var a=zo(),b=this.b;b.K(a);b.D=a};var Ao=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var Bo=function(a,b){this.g=a;this.f=b;this.h=new Rl;this.b=new Hk};Bo.prototype.init=function(){tj(this)};var Co=function(a,b){var c=a.b.get(b);c&&(c.wj--,0<c.wj||(Dk(a.f.b.wb(!1),function(a){switch(Yj(a,b)){case "available":a.Sb[b]="available_rescan";break;case "unavailable":a.Sb[b]="unavailable_rescan"}}),a.b.remove(b)))};g=Bo.prototype;
g.Bl=function(a){var b=this;Dk(this.b.wb(!0),function(c){a:{switch(Yj(a,c)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+c;b.h.contains(e)||(b.h.add(e),d=function(){b.h.remove(e)},Ee(new Ce(b.Wo.bind(b,a,c),5500,3),2).start().then(b.Bm.bind(b,a,c),function(){b.l.error("Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.Bm(a,c,"unknown")}).then(d,d))}})};
g.Bm=function(a,b,c){c!=Yj(a,b)&&(this.l.info(b+" on "+a.getId()+" is "+c),a.Sb[b]=c,Wk(this.f.f,a))};
g.Wo=function(a,b){var c=this,d=new Ao;d.appId=[b];var e=new Gb("MediaRouter.Cast.App.Availability");return this.g.sendRequest(d,a,fj,5E3).then(function(a){e.b("Success");Cb(c.l,function(){return"App availability response "+JSON.stringify(a)});for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(d){e.b("Failure");c.l.error("checkAppAvailability_ failed for "+a.getId()+", appId "+b);
throw d;})};g.va=function(){return"cast.AppDiscoveryService"};g.Ta=function(){return[new Do(Nk(this.b))]};g.ab=function(){var a=qj(this);a&&Gk(this.b,a.b)};g.l=vb("mr.cast.AppDiscoveryService");var Do=function(a){this.b=a};var Eo=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var Fo=function(a,b){this.f=[];this.b=[];this.sinkId=a;this.session=b;this.s=this.g=null;this.offTheRecord=this.j=!1;this.controller=null;this.h=!0},Go=function(){this.l=vb("mr.cast.SessionRecords");this.b=[]};Go.prototype.init=function(){tj(this)};
var An=function(a,b){a.l.info("Removing session "+b);Om(a,b);a.b=bc(a.b,function(a){return a.session.sessionId!=b})},Xm=function(a,b){return(a=jn(a,b))?a.f:[]},pn=function(a,b){return(a=rn(a,b))?a.session:null},Ho=function(a,b){return hc(a.b,function(a){return jc(a.f,b)})},Gn=function(a,b){return hc(a.b,function(a){return jc(a.b,b)})},Io=function(a,b){return hc(a.b,function(a){return null!=hc(a.b,function(a){return Kn(a).b==b})})},rn=function(a,b){return hc(a.b,function(a){return a.sinkId==b||a.g==
b})},jn=function(a,b){return hc(a.b,function(a){return a.session.sessionId==b})},bn=function(a,b){return(a=jn(a,b))?a.sinkId:null},an=function(a,b){return(a=jn(a,b))?a.session:null},yn=function(a,b,c){var d=an(a,b);d&&(a=bc(c,function(a){return a.playerState!=chrome.cast.media.We.IDLE}),a.forEach(function(a){if(!a.media){var b=hc(d.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),d.media=a)};Go.prototype.va=function(){return"cast.SessionRecords"};
Go.prototype.Ta=function(){return[new Jo(this.b)]};Go.prototype.ab=function(){var a=qj(this);if(a)for(var b=0;b<a.b.length;b++){var c=a.b[b],d=new Fo(c.sinkId,c.session);d.f=c.f;d.b=c.b;d.j=c.j;d.s=c.s;d.g=c.g;d.h=c.h;this.b.push(d)}};
var Om=function(a,b){(a=jn(a,b))&&a.controller&&(a.controller.Ra(),a.controller=null)},Jo=function(a){var b=[];a=la(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=new Fo(c.sinkId,c.session);d.f=c.f;d.b=c.b;d.j=c.j;d.s=c.s;d.g=c.g;d.offTheRecord=c.offTheRecord;d.h=c.h;b.push(d)}this.b=b};var Ko=function(a,b,c){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,Ko);else if(b=Error().stack)this.stack=b;this.errorCode=a};l(Ko,Error);var Lo=function(a,b){this.sinks=a;this.origins=b||null},Mo=new Lo([]);var No=function(a){this.A="sender-"+Xc();this.h=new Hk;this.o=null;tj(this);this.f=a;this.m=new uo;this.g=new Go;this.u=new lo(this.A,this);this.b=new Pk(this.u,this);this.D=new yo(this.b);this.B=new Cl(this.u,this.A);this.s=null;this.j=new Wm(this.B,this.b,this.m,this.g,this.u,this);this.F=new Vl(this.b,this.B);this.la=this.b.start.bind(this.b);this.C=!0};g=No.prototype;g.getName=function(){return"cast"};
g.Za=function(a){var b=a?a.enable_cast_discovery:!0;a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.l.info("Cast sink discovery enabled: "+b+", query enabled: "+a);this.B.init();this.g.init();this.j.init();this.u.init(b);this.b.init();this.D.init();a&&(this.s=new Bo(this.B,this.b),this.s.init());(this.C=b)?this.f.vj(this.la):this.b.stop()};g.sd=function(){return this.h.ba()};
g.kg=function(a){var b=this;if(null!=Oo(a))return new Lo([]);var c=new Rl;Po(a).forEach(function(a){kl(b.b,a).map(function(a){return a.f}).forEach(function(a){c.add(a)})});return new Lo(c.ba(),-1!=a.indexOf("0F5096E8")?Ig:null)};
g.startObservingMediaSinks=function(a){var b=this,c=Oo(a);c?(this.l.info("Received broadcast request "+a),Dk(this.b.b.wb(!1),function(a){b.B.sendMessage(c,a,jj).catch(function(a){b.l.error("Broadcast failed "+a.message)})})):this.s&&(Po(a).forEach(function(a){var c=b.s,d=c.b.get(a);d?d.wj++:c.b.set(a,{wj:1});c.l.info("Scanning sinks for app availability");Dk(c.f.b.wb(!1),c.Bl,c)}),this.C&&this.f.Pi()&&this.b.start())};
g.stopObservingMediaSinks=function(a){var b=this;null!=Oo(a)||this.s&&Po(a).forEach(function(a){Co(b.s,a)})};g.startObservingMediaRoutes=function(){};g.stopObservingMediaRoutes=function(){};g.ha=function(a){return(a=this.b.ha(a))?a.f:null};
var Qo=function(a,b,c){a.l.error("Error launching.",c);mn(a,b.id,!1,!0,"error");c=new Of(Eo,"warning");c.routeId=b.id;a.f.xd(c)},To=function(a,b,c,d,e,f,h,k){Nj().h=new Kj(c.Xb,c.hb());var n=Nn(b,c,d,!0);n.forDisplay=!1;n.offTheRecord=e;a.h.set(n.id,n);a.f.Ff(a,n);Bn(a);(e=Dm(b))&&e.b&&Ro(a,e,n.id,h,k);Gg(b)||Hg(b)?(n.zb={tabId:k,sessionId:"",Jg:c.hb()||"",Te:c.Xb||"",wr:c.f.friendlyName||""},Hg(b)&&(n.isOffscreenPresentation=!0),a.f.Vi(a,n,d,function(e){return Wf(So(a,b,c,d,f,h,k,e))}).b.then(function(){var b=
Gn(a.g,n.id);b.h=!1;On(b.session,n);b.controller&&(b.controller.j=!1,Km(b.controller))},function(b){Qo(a,n,b)})):So(a,b,c,d,f,h,k,n).then(null,function(b){Qo(a,n,b)});return Promise.resolve(n)},So=function(a,b,c,d,e,f,h,k){return Fn(a.j,Uo(b,c,e),c).then(function(e){Dn(a,b,c,d,e,f,h,k);return k})};
No.prototype.createRoute=function(a,b,c,d,e,f,h){var k=this,n=this.b.ha(b);if(!n)return Vf(Error("No sink with ID "+b));var u=Em(a);if(u){setTimeout(function(){$m(k.j,u,n,chrome.cast.bg.CAST)},0);var z=function(){return To(k,a,n,c,d,e,f,h)},B=mm(this.m,u);if(B)return Wf(this.terminateRoute(B.routeId).then(z,z));if(f&&h&&(b=Vo(this,a,f,h,d,e,b)))return b}return Wf(To(this,a,n,c,d,e,f,h))};
var mn=function(a,b,c,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.l.info("Remove route "+b);var f=vo(a.m,b);if(f){c=c||f.f;var h=f.clientId;a.l.info("Remove client "+h);for(var k=a.g,n=0;n<k.b.length;n++)rc(k.b[n].f,h);wo(a.m,h)}if(h=Gn(a.g,b))rc(h.b,b),Wo(a,h.b);if(k=a.h.get(b))if(k.gf&&h&&(un(a.u,k.sinkId,f?f.clientId:a.A,h.session.transportId,c),k.forDisplay&&f&&(a.o={ef:f,om:h})),a.h.remove(b),a.f.ug(k),Bn(a),d)a.f.onPresentationConnectionClosed(b,e,"Remove route");else a.f.onPresentationConnectionStateChanged(b,
"terminated")},Cn=function(a,b){b.b.forEach(function(c){if(c=a.h.get(c)){var d=b.session;if(c.forDisplay){var e=In(d.appId);e&&!c.isLocal?(c.description=d.statusText||"",d.displayName="",d.statusText=""):e||(c.description=d.statusText||d.displayName);b.controller&&Km(b.controller)}a.f.Ke(c)}})},Xo=function(a,b){ec(b,function(b){b=a.h.get(b,null);if(!b||!b.mediaSource)return!1;var c=Dm(b.mediaSource);c=c?c.o:!1;return b.isLocal&&!c})&&w(b,function(b){if(b=a.h.get(b,null))b.isLocal=!0})},Wo=function(a,
b){var c=[],d=[],e=null;b.forEach(function(b){if(b=a.h.get(b)){b.forDisplay=!1;var f=Dm(b.mediaSource);f&&hc(ym(f),jm)||(b.gf?(f=f?zm(f):null,e||f==chrome.cast.hd.CUSTOM_CONTROLLER_SCOPED||(c.push(b),e=b.sinkId)):e&&e!=b.sinkId?c.push(b):d.push(b))}});w(0<c.length?c:d,function(a){a.forDisplay=!0})},Ro=function(a,b,c,d,e){var f=b.b;if(f&&!mm(a.m,f)){a.l.info("Add client "+f);var h=ym(b);a.m.b.push(new to(c,f,h,zm(b),d||null,Qa(e)?e:null))}},Dn=function(a,b,c,d,e,f,h,k){var n=rn(a.g,c.getId());if(!n){var u=
a.g;n=c.getId();u.l.info("Adding new session: "+n+", "+e.sessionId);var z=jn(u,e.sessionId);z?(dm(e)?(z.s=e,z.g=n):dm(z.session)&&(z.s=z.session,z.g=z.sinkId,z.session=e,z.sinkId=n),n=z):(n=new Fo(n,e),u.b.push(n))}k&&k.isLocal&&k.zb&&(n.h=!1);var B=null!=b;if(!B&&jm(e.appId))return null;null==b?(z=new um([{appId:e.appId,capabilities:e.capabilities}]),b=Am(z)[0]):z=Dm(b);if(u=k){if(!a.h.get(u.id))return v(a.l,"Route "+u.id+" not added"),u}else u=Nn(b,c,d||e.sessionId,B),a.h.set(u.id,u);d=u.id;a.l.info("Add route "+
d);b=null;z&&(b=z.b,Ro(a,z,d,f,h));jc(n.b,d)||n.b.push(d);u.gf&&no(a.u,c,b||a.A,e.transportId,!(z&&z.o));n.offTheRecord=u.offTheRecord;f=n.b;Xo(a,f);Wo(a,f);f=u;h=e.sessionId;In(e.appId)?f.isLocal&&h&&f.zb?f.zb.sessionId=h:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;k?a.f.Ke(u):a.f.Ff(a,u);Bn(a);if(k=b)jc(n.f,b)?k=!1:(n.f.push(b),k=!0);k&&(a=a.j,qm(a.f,b,new km("new_session",e)),nn(a,e,c));return u};
No.prototype.terminateRoute=function(a){var b=this,c=this.h.get(a);if(!c)return Promise.reject(new Ko(3,"Route in Cast provider not found for routeId  "+a));var d=Gn(this.g,a);if(!d)return mn(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.b.ha(c.sinkId);if(!f)return kn(this.j,e),Promise.resolve();(a=vo(this.m,a))&&$m(this.j,a.clientId,f,chrome.cast.bg.STOP);gk(0);return new Promise(function(a){var c=function(){zn(b.j,f.getId());a()};b.B.sendRequest(new zl(e),f,fj).then(c,c)})};
var Yo=function(a,b){var c=null;Ek(a.h.wb(!1),function(d){if(!d.gf)return!1;var e=a.b.ha(d.sinkId);if(!e||!Cm(b,Uo(d.mediaSource,e)))return!1;c=d;return!0});if(!c||!c.mediaSource)return null;var d=Em(c.mediaSource);if(!d)return null;var e=mm(a.m,d);return e?(d=Ho(a.g,d))?{ef:e,om:d}:null:null},Vo=function(a,b,c,d,e,f,h){var k=null;Ek(a.h.wb(!1),function(a){var b=a.zb;return b&&null!=b.tabId&&b.tabId==d&&Eg(a.mediaSource)?(k=a,!0):!1});if(!k)return null;var n=function(){return a.createRoute(b,h||k.sinkId,
"",e,f,c,null==d?void 0:d)};return Wf(a.terminateRoute(k.id).then(n,n))};g=No.prototype;g.connectRouteByRouteId=function(a,b,c,d,e){if(!Dm(a))return Vf(Error("Unsupported presentation URL"));if(!b)return Vf(Error("No routeId"));b=Kn(b);b=jn(this.g,b.b);if(!b)return Vf(Error("No matching route"));var f=this.b.ha(b.sinkId);return f?(a=Dn(this,a,f,c,b.session,d,e))?Uf(a):Vf(Error("Failed to create route")):Vf(Error("No sink"))};
g.joinRoute=function(a,b,c,d,e,f){var h=Dm(a);if(!h)return Vf(Error("Unsupported presentation URL"));if(b==chrome.cast.Oj){a:{var k=Yo(this,h);if(!k){if(!this.o||this.o.ef.origin!=e||this.o.ef.tabId!=f){k=null;break a}k=this.o}switch(zm(h)){case chrome.cast.hd.PAGE_SCOPED:k=null;break a;case chrome.cast.hd.ORIGIN_SCOPED:if(e!=k.ef.origin){k=null;break a}break;case chrome.cast.hd.TAB_AND_ORIGIN_SCOPED:if(e!=k.ef.origin||f!=k.ef.tabId){k=null;break a}}k=jn(this.g,k.om.session.sessionId)}if(!k&&(h.h?
h.h:chrome.cast.Rg.CREATE_SESSION)!=chrome.cast.Rg.CAST_THIS_TAB&&(d=Vo(this,a,e,f,c,d)))return d}else k=Zo(this,b);if(!k)return Vf(Error("No matching route"));if(k.offTheRecord!=c)return Vf(Error("Off the record mismatch"));d=this.b.ha(k.sinkId);if(!d)return Vf(Error("No sink"));a=Dn(this,a,d,b,k.session,e,f);a.offTheRecord=c;return Uf(a)};g.detachRoute=function(a){mn(this,a,!1,!0)};
g.tf=function(a){var b=this.b.ha(a);if(!b)throw Error("Cannot mirror with no sink.");var c=new $g;b=b.b;b&1||(c.shouldCaptureVideo=!1);b&4||(c.shouldCaptureAudio=!1);c.shouldCaptureAudio&&!c.shouldCaptureVideo&&(c.minLatencyMillis=c.maxLatencyMillis,c.animatedLatencyMillis=c.maxLatencyMillis);c.senderSideLetterboxing=!0;ah(c);Object.freeze(c);this.l.info(function(){return"Settings for "+a+": "+Zg(c)});if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return c};g.De=function(){return"cast_streaming"};g.Ih=function(a){var b=this.h.get(a);b&&b.zb&&b.zb.dc&&(a=Gn(this.g,a))&&(On(a.session,b),a.controller&&Km(a.controller))};
g.sendRouteMessage=function(a,b,c){var d=this;if(!c)return new Promise(function(a,c){"string"!==typeof b&&c(Error("Cannot send non-string messages via ApiHandler."));c=d.j.f;Cb(om,"Received: "+b);var e=JSON.parse(b),f=e.clientId;"client_connect"==e.type?(Cb(om,"App "+f),(e=mm(c.b,f))?(e.b=!0,(c=wl(c.f,e.routeId))&&c.mb.resolve(!0)):v(om,"Client not found "+f)):nm(c,f)?(c=c.h[e.type])&&c(e):v(om,"No route for "+f);a()});var e=Gn(this.g,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.b.ha(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var h=(a=vo(this.m,a))?a.clientId:this.A;return new Promise(function(a){Fl(d.u,f,c.namespace,b,h,e.session.transportId).then(a,a)})};g.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};g.eg=function(a,b){var c=this.b.ha(b);if(!c)return!1;if(!this.s)return!0;a=Uo(a,c);return(a=Bm(a))&&0!=a.length?ec(a,function(a){return lj(Yj(c,a))}):!1};
g.cf=function(a,b,c){var d=Po(a);return d&&0!=d.length?b==chrome.cast.Oj?!0:c&&c.mediaSource?(a=Bm(c.mediaSource),ec(a,function(a){return jc(d,a)})):void 0==b||Zo(this,b)?!0:!1:!1};
var Uo=function(a,b,c){return Gg(a)||Hg(a)?(a={appId:0==(b.b&1)?"85CDB22F":"0F5096E8",capabilities:fm(b.b)},Am(new um([a],void 0,void 0,void 0,c))[0]):a},Po=function(a){var b=[];if(Gg(a)||Hg(a)){var c=ag();Fg(a)&&"ChromeOS"!=c&&"Windows"!=c||b.push("85CDB22F");b.push("0F5096E8")}else(a=Bm(a))&&(b=uc(b,a));return b},Oo=function(a){var b=Dm(a);if(!b)return null;a=Po(a);var c=b.m||"";b=b.s;return c&&b?new xl(a,c,JSON.stringify(b)):null},Zo=function(a,b){return 0==b.indexOf(chrome.cast.gk)?jn(a.g,b.substr(chrome.cast.gk.length)):
Io(a.g,b)},oo=function(a,b,c){var d=a.F;if(Wl(d)&&kj.hasOwnProperty(c.namespace_)){var e=b.hb();if(e){var f=JSON.parse(c.data);if("RECEIVER_STATUS"===f.type){var h=f.status&&f.status.applications&&f.status.applications[0],k=f=null;h&&(h.appId&&(f=h.appId),h.sessionId&&(k=h.sessionId));h=d.f.get(e);d.f.set(e,new bj(e,f,k));h&&h.appId===f||Xl(d)}}}a=a.j;b=b.getId();kj.hasOwnProperty(c.namespace_)?vn(a,b,c):wn(a,b,c)};
No.prototype.L=function(a){if(0==this.b.b.pa())this.f.onSinkAvailabilityUpdated(this,0);var b=this.j;a=a.getId();(a=rn(b.b,a))&&a.session&&kn(b,a.session.sessionId);Yl(this.F);this.f.Wc()};var Wk=function(a,b){a.s&&a.s.Bl(b);Yl(a.F);a.f.Wc()};g=No.prototype;g.va=function(){return"cast.Provider"};g.Ta=function(){return[new $o(this.A,Nk(this.h),this.o)]};g.ab=function(){var a=qj(this);a&&(this.A=a.h,Gk(this.h,a.f),this.o=a.b)};g.searchSinks=function(){return sb()};
g.createMediaRouteController=function(a,b,c){return(a=this.j.createMediaRouteController(a,b,c))?Promise.reject(a):Promise.resolve()};g.provideSinks=function(a){al(this.b,a)};var Bn=function(a){var b=a.sd().some(function(a){return a.isLocal});a.f.Jf(a.va(),b)};No.prototype.l=vb("mr.CastProvider");var $o=function(a,b,c){this.h=a;this.f=b;this.b=c};var ap={Bt:0,Ow:1,Fv:2,At:3},bp=function(a){Rb("MediaRouter.Dial.Create.Route",a,ap)};var cp=function(a,b){this.h=a;this.f=b;this.b=this.h.b;this.l=vb("mr.cast.CastDialSinkDiscoveryCallbacks");this.g=!0},dp=function(a,b){var c=a.b.ha(b.getId());if(c)return c;(b=b.hb())?(a=a.b,c=Nj().b||8009,a=a.m.get(b+":"+c)):a=null;return a};cp.prototype.sg=function(a){dp(this,a)?jk(2):ep(this,a);this.f.sg(a)};var ep=function(a,b){if(a.h.C||a.g){var c=Vj(b);c&&el(a.b,c).then(function(d){d?dp(a,b)?jk(2):(Xk(a.b,c),jk(0)):Qb("MediaRouter.Dial.Sink.Discovered.NonCast")},Za)}};
cp.prototype.tg=function(a){var b=this;w(a,function(a){var c=b.b.ha(a.getId());c&&c.Pd&&Zk(b.b,a.getId())});this.f.tg(a)};cp.prototype.Df=function(a){var b=this.b.ha(a.getId());b?b.Pd&&(b.update(a.Mb.friendlyName,a.hb(),b.Sa(),b.b)&&this.l.info("Updated Cast sink with DIAL sink: "+a.getId()),Wk(this.b.f,b)):ep(this,a);this.f.Df(a)};var fp=function(){this.b=[]};fp.prototype.listen=function(a,b,c){this.b.push({type:a,rb:b,target:c})};var gp=function(a,b,c){var d=a.b.findIndex(function(a){return"internal_message"==a.type&&a.rb==b&&a.target==c});-1!=d&&a.b.splice(d,1)},hp=function(a,b){a.b.forEach(function(a){a.type==b.type&&Promise.resolve().then(function(){return a.rb.call(a.target,b)})})};var ip=function(a,b,c,d){b="["+b+"]: "+c+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(b):Cb(a,b)};var jp=function(){this.name="unknown";this.state="error";this.b=null;this.allowStop=!0;this.resource=null;this.extraData={}},kp=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};l(kp,Error);var mp=function(a){if(void 0===b){lp||(lp=new Fe(10,2E3));var b=lp}this.f=a;this.b=b;this.l=vb("mr.dial.Client")};
mp.prototype.launchApp=function(a,b){var c=this;return this.b.send(np(this,a),"POST",b,{timeoutMillis:15E3}).then(function(a){return op(c,"launchApp","POST",a)})};
var qp=function(a,b){return pp(a,b).then(function(c){return c.resource?c.resource:(v(a.l,"stopApp: Resource path for not available for app "+b+": using fallback path."),"run")},function(){v(a.l,"stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(c){return a.b.send(np(a,b)+"/"+c,"DELETE")}).then(function(b){return op(a,"stopApp","DELETE",b)})},pp=function(a,b){return a.b.send(np(a,b),"GET",void 0,{Fl:3}).then(function(c){ip(a.l,"GetAppInfo","GET",c);if(!(200<=c.status&&
299>=c.status)){if(404==c.status)throw new kp;throw Error("Response error: "+c.status);}c=c.responseText;c=(new DOMParser).parseFromString(c,"text/xml");c=c.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:c;if(!c)throw a.l.info("Invalid or empty response"),Error("Invalid or empty response");var d=c.getElementsByTagName("service");if(!d||1!=d.length)throw a.l.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");c=new jp;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var h=d[0].childNodes[e];if("state"==h.nodeName){a:switch(h.textContent){case "running":h="running";break a;case "stopped":h="stopped";break a;default:h="error"}c.state=h}else"name"==h.nodeName?c.name=h.textContent:"link"==h.localName?c.resource=h.getAttribute("href"):"options"==h.nodeName?c.allowStop="false"!=h.getAttribute("allowStop"):c.extraData[h.nodeName]=h.innerHTML}if("unknown"==c.name)throw a.l.info("GET response missing name value"),Error("GET response missing name value");
if(c.name!=b)throw a.l.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==c.state)throw a.l.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(c.state))&&d[1])c.state="installable",c.b=d[1];else if("running"!=c.state&&"stopped"!=c.state)throw a.l.info("GET response has invalid state value"),Error("GET response has invalid state value");return c})},np=function(a,b){a=a.f.Id;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
b},op=function(a,b,c,d){return new Promise(function(e,f){ip(a.l,b,c,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},lp=null;var rp=function(a,b){this.yc=a;this.appName=b};var sp=function(a){this.b=new Map;this.f=a};sp.prototype.init=function(){tj(this)};sp.prototype.clear=function(){this.b.clear()};sp.prototype.add=function(a){if(!this.b.get(a.yc.id)){this.b.set(a.yc.id,a);var b=this.f;tp(b);b.g.Ff(b,a.yc)}};var up=function(a,b){a=la(a.b);for(var c=a.next();!c.done;c=a.next())if(c=la(c.value),c.next(),c=c.next().value,c.yc.sinkId==b)return c;return null},wp=function(a,b){var c=a.b.get(b);c&&(a.b.delete(b),vp(a.f,c))};
sp.prototype.sd=function(){return Array.from(this.b.values(),function(a){return a.yc})};sp.prototype.va=function(){return"dial.ActivityRecords"};sp.prototype.Ta=function(){return[Array.from(this.b)]};sp.prototype.ab=function(){var a=qj(this);a&&(this.b=new Map(a))};var xp=function(a){this.h=a;this.l=vb("mr.dial.SinkDiscoveryService");this.b=new Map;this.f={ve:0,He:0};this.g=0};xp.prototype.init=function(){tj(this)};
var Ap=function(a,b){a.l.info("addSinks returned "+b.length+" sinks");Cb(a.l,function(){return"....the list is: "+JSON.stringify(b)});var c=new Set(a.b.keys());b.forEach(function(b){var d=b.sink_id,e=b.extra_data.dial_media_sink,f=yp.test(e.model_name);b=new Qj(b.name,d);b.Wb=e.ip_address.address_bytes?e.ip_address.address_bytes.join("."):e.ip_address.address.join(".");b.Id=e.app_url.url;b.Xb=e.model_name;b.je=!f;zp(a,b);c.delete(b.getId())});var d=[];c.forEach(function(b){var c=a.b.get(b);d.push(c);
a.b.delete(b)});0<d.length&&a.h.tg(d);var e=a.b.size;a.f={ve:e,He:e}},zp=function(a,b){Cb(a.l,"mayAddSink, id = "+b.getId());var c=a.b.get(b.getId());c?c.update(b)&&(Cb(a.l,"Updated sink "+c.getId()),a.h.Df(c)):(Cb(a.l,function(){return"Adding new sink "+b.getId()+": "+("name = "+b.Mb.friendlyName+(b.Wb?", ip = "+b.Wb:"")+(b.Xb?", model = "+b.Xb:"")+", apps = "+JSON.stringify(b.Sb))}),a.b.set(b.getId(),b),a.h.sg(b))};xp.prototype.ha=function(a){return this.b.get(a)||null};
var Cp=function(a,b){var c=[];a.b.forEach(function(a){"available"==Rj(a,b)&&c.push(a.Mb)});return new Lo(c,Bp[b])};xp.prototype.Ce=function(){return this.f};xp.prototype.va=function(){return"dial.DialSinkDiscoveryService"};xp.prototype.Ta=function(){return[new Dp(Array.from(this.b),this.f),{deviceCountMetricsRecordTime:this.g}]};
xp.prototype.ab=function(){var a=qj(this);if(a){for(var b=la(a.sinks),c=b.next();!c.done;c=b.next())c=c.value,this.b.set(c[0],Sj(c[1]));this.f=a.deviceCounts}if(a=rj(this))this.g=a.deviceCountMetricsRecordTime};
var Bp={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},yp=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
Dp=function(a,b){this.sinks=a;this.deviceCounts=b};var Ep=function(a,b){this.l=vb("mr.dial.AppDiscoveryService");this.b=new Set;this.f=a;this.s=b;this.j=new Map;this.m=new Map;this.h=null;this.g=!1};Ep.prototype.init=function(){tj(this)};Ep.prototype.start=function(){this.l.info("Starting periodic scanning.");this.g||(this.g=!0,Fp(this))};Ep.prototype.stop=function(){this.l.info("Stopping periodic scanning.");this.g&&(this.g=!1,this.h&&(clearTimeout(this.h),this.h=null),this.j.clear())};
var Fp=function(a){a.l.info("Start app status scan.");var b=[];Array.from(a.f.b.values()).forEach(function(c){b.push.apply(b,Gp(a,c))});Array.from(a.s.b.values()).forEach(function(c){b.push(Hp(a,c))});Ok(b).then(function(){a.g&&!a.h&&(Cb(a.l,"Scan complete; scheduling for next scan."),a.h=setTimeout(function(){Cb(a.l,"Start app status scan (timer-based)");a.h=null;Fp(a)},6E4))})},Gp=function(a,b){if(!b.je)return[];for(var c=[],d=la(a.b),e=d.next();!e.done;e=d.next())c.push(a.o(e.value,b));return c};
Ep.prototype.o=function(a,b){var c=this;if("unknown"!=Rj(b,a)&&36E5>Date.now()-(b.hh[a]||0)||!b.je)return Promise.resolve();Cb(this.l,"Querying "+b.getId()+" for "+a+" to update app status");return Ip(this,b,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}Jp(c,b,a,d)},function(d){d instanceof
kp?Jp(c,b,a,"unavailable"):(v(c.l,"Failed to process app availability; "+b.getId()+" does not support app availability"),b.je=!1)})};
var Hp=function(a,b){var c=a.f.ha(b.yc.sinkId);if(!c)return v(a.l,"Activity refers to nonexistent sink: "+b.yc.id),Promise.resolve();if(!c.je)return Promise.resolve();var d=b.appName;Cb(a.l,"Querying "+c.getId()+" for "+d+" to update activity");return Ip(a,c,d).then(function(b){"running"!=b.state&&Kp(a,c,d)},function(){return Kp(a,c,d)})},Lp=function(a,b){var c=a.m.get(b.getId());c||(c=new mp(b),Cb(a.l,"Created DIAL client for "+b.getId()),a.m.set(b.getId(),c));return c},Ip=function(a,b,c){var d=
Mp(b,c),e=a.j.get(d);if(e)return e;e=pp(Lp(a,b),c);a.j.set(d,e);b=function(){a.j.delete(d)};e.then(b,b);return e},Mp=function(a,b){return a.getId()+":"+b},Jp=function(a,b,c,d){Cb(a.l,"Got app status "+d+" from "+b.getId()+" for "+c);var e=Rj(b,c);b.Sb[c]=d;b.hh[c]=Date.now();d!=e&&a.f.h.Df(b)},Kp=function(a,b,c){(b=up(a.s,b.getId()))&&b.appName==c&&wp(a.s,b.yc.id)},Np=function(a,b){return Array.from(a.f.b.values()).some(function(a){return"unknown"==Rj(a,b)})};Ep.prototype.va=function(){return"dial.AppDiscoveryService"};
Ep.prototype.Ta=function(){return[Array.from(this.b)]};Ep.prototype.ab=function(){var a=qj(this);this.b=new Set(a||[])};var Op=function(a,b){this.appName=a;this.launchParameter=void 0===b?"":b},Rp=function(a){try{var b=new URL(a)}catch(c){return Pp.info("Invalid URL: "+a),null}switch(b.protocol){case "dial:":a:if(a=b.pathname,a.match(/^\w+$/)){if(b=b.searchParams.get("postData")||void 0)try{b=Fj(b)}catch(c){v(Pp,"Invalid base64 encoded postData:"+b);a=null;break a}a=new Op(a,b)}else v(Pp,"Invalid app name: "+a),a=null;return a;case "https:":return Qp(b);default:return Cb(Pp,"Unhandled protocol: "+b.protocol),null}},
Qp=function(a){var b=a.hash;if(!b)return null;a=(a=Sp.exec(b))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(b=(b=Tp.exec(b))?b[1]:void 0)try{b=Fj(b)}catch(c){return v(Pp,"Invalid base64 encoded postData:"+b),null}return new Op(a,b)},Pp=vb("mr.dial.PresentationUrl"),Sp=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Tp=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var Up=function(a,b){this.g=a;this.f=b||new xp(this);this.h=new sp(this);this.b=null;this.l=vb("mr.DialProvider")};g=Up.prototype;g.getName=function(){return"dial"};g.Ce=function(){return this.f.Ce()};g.Za=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.l.info("Dial sink query enabled: "+a+"...");this.h.init();this.f.init();a?(this.b=this.b||new Ep(this.f,this.h),this.b.init()):this.b=null;tp(this)};
g.kg=function(a){if(!this.b)return Mo;Cb(this.l,"GetAvailableSinks for "+a);return(a=Rp(a))?Cp(this.f,a.appName):Mo};g.startObservingMediaSinks=function(a){if(this.b){var b=Rp(a);if(b){a=this.b;b=b.appName;if(!a.b.has(b)||Np(a,b))a.b.add(b),0!=a.f.b.size&&(a.g?Array.from(a.f.b.values()).forEach(a.o.bind(a,b)):a.start());tp(this)}}};g.stopObservingMediaSinks=function(a){this.b&&(a=Rp(a))&&(this.b.b.delete(a.appName),Vp(this))};g.startObservingMediaRoutes=function(){tp(this)};
g.stopObservingMediaRoutes=function(){Vp(this)};var Vp=function(a){a.b&&(0==a.f.b.size||0==a.b.b.size&&0==a.h.b.size)&&a.b.stop()},tp=function(a){a.b&&0<a.f.b.size&&(0<a.b.b.size||0<a.h.b.size)&&a.b.start()};g=Up.prototype;g.ha=function(a){return(a=this.f.ha(a))?a.Mb:null};g.sd=function(){return this.h.sd()};
g.createRoute=function(a,b,c,d){var e=this,f=this.f.ha(b);if(!f)return bp(0),Vf(Error("Unkown sink: "+b));Nj().h=new Kj(f.Xb,f.hb());var h=Rp(a);if(!h)return Vf(Error("No app name set."));var k=h.appName,n=new mp(f);return Wf(pp(n,k).then(function(a){if("running"==a.state)return qp(n,k)}).then(function(){return n.launchApp(k,h.launchParameter)}).then(function(){return Wp(e,b,a,k,c,d)}).catch(function(a){bp(3);throw a;}))};g.joinRoute=function(){return Vf(Error("Not supported"))};
g.connectRouteByRouteId=function(){return Vf(Error("Not supported"))};g.detachRoute=function(){};var Wp=function(a,b,c,d,e,f){bp(1);b=Mn(e,a.getName(),b,c,!0,d);b.offTheRecord=f;a.h.add(new rp(b,d));return b};Up.prototype.sg=function(a){this.g.onSinkAvailabilityUpdated(this,1);this.b&&(tp(this),Gp(this.b,a));this.g.Wc();Nj().f=new Kj(a.Xb,a.hb())};
Up.prototype.tg=function(a){var b=this;if(0==this.f.b.size)this.g.onSinkAvailabilityUpdated(this,0);Vp(this);a.forEach(function(a){var c=b.h;a=a.getId();if(a=up(c,a))c.b.delete(a.yc.id),vp(c.f,a)});this.g.Wc()};Up.prototype.Df=function(){this.g.Wc()};var vp=function(a,b){b=b.yc;if(b.isLocal)a.g.onPresentationConnectionStateChanged(b.id,"terminated");Vp(a);a.g.ug(b)};g=Up.prototype;
g.terminateRoute=function(a){var b=this.h.b.get(a)||null;if(!b)return Promise.reject(new Ko(3,"Route in DIAL provider not found for routeId "+a));wp(this.h,a);return(a=this.f.ha(b.yc.sinkId))?qp(new mp(a),b.appName):Promise.reject(new Ko(3,"Sink in DIAL provider not found for sinkId "+b.yc.sinkId))};g.tf=function(){throw Error("Not implemented.");};g.De=function(){return null};g.Ih=function(){};g.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};
g.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};g.eg=function(a,b){b=this.f.ha(b);return!b||Gg(a)?!1:(a=Rp(a))?"available"==Rj(b,a.appName):!1};g.cf=function(){return!1};g.searchSinks=function(){return sb()};g.createMediaRouteController=function(){return sb()};g.provideSinks=function(a){Ap(this.f,a)};var Xp=function(a,b){this.o=new cp(b,this);this.m=new xp(this.o);this.h=new Hk;this.f=a;this.s=this.j=0;this.g=new Rl;this.b=new Up(this,this.m)};g=Xp.prototype;g.va=function(){return"cast.DialProviderWrapper"};g.Ta=function(){return[new Yp(Nk(this.h),this.j,this.s,this.g.ba())]};g.ab=function(){var a=qj(this);a&&(Gk(this.h,a.f),this.j=a.sequenceNumber,this.s=a.h,Ql(this.g,a.b))};g.getName=function(){return this.b.getName()};
g.Za=function(a){this.b.Za(a);tj(this);this.o.g=a?a.enable_dial_discovery:!0};g.sd=function(){return this.b.sd()};g.kg=function(a){return(a=Zp(a))?this.b.kg(a):Mo};g.startObservingMediaSinks=function(a){(a=Zp(a))&&this.b.startObservingMediaSinks(a)};g.stopObservingMediaSinks=function(a){(a=Zp(a))&&this.b.stopObservingMediaSinks(a)};g.startObservingMediaRoutes=function(a){(a=Zp(a))&&this.b.startObservingMediaRoutes(a)};g.stopObservingMediaRoutes=function(a){(a=Zp(a))&&this.b.stopObservingMediaRoutes(a)};
g.ha=function(a){return this.b.ha(a)};
var bq=function(a,b,c,d,e){var f=Zp(b);if(!f)return Promise.reject(Error("Invalid source"));var h=Rp(f),k=a.m.ha(c);if(!k)return Promise.reject(Error("Attempting custom launch with closed route"));var n=h.appName;if(!n)return Promise.reject(Error("No app name given"));var u=$p(b);return u?pp(new mp(k),n).then(function(f){var z=Wp(a.b,c,b,n,e,d);f={routeId:z.id,sinkId:k.getId(),appName:n,Bk:f,launchParameter:h.launchParameter,session:null,clientId:null};a.h.set(z.id,f);var E=aq(a,f.sinkId),Q=new km("receiver_action",
{receiver:E,action:chrome.cast.bg.CAST});Q.clientId=u;a.f.Vd(f.routeId,Q);Q=chrome.cast.P;var na=String(a.s);a.s=(a.s+1)%9007199254740992;E=new Q(na,"",f.appName,[],E);f.session=E;f.clientId=u;E=new km("new_session",E);E.clientId=u;a.f.Vd(f.routeId,E);return z}):Promise.reject(Error("No client ID"))};Xp.prototype.createRoute=function(a,b,c,d,e,f,h){return a.startsWith("cast-dial:")||cq.test(a)?Wf(bq(this,a,b,d,c)):this.b.createRoute(a,b,c,d,e,f,h)};
Xp.prototype.terminateRoute=function(a){var b=this.h.get(a);if(b&&b.session&&b.clientId){var c={receiver:aq(this,b.sinkId),action:chrome.cast.bg.STOP};c=new km("receiver_action",c);c.clientId=b.clientId;this.f.Vd(b.routeId,c);this.f.onPresentationConnectionStateChanged(b.routeId,"terminated")}return this.b.terminateRoute(a)};
Xp.prototype.sendRouteMessage=function(a,b,c){var d=JSON.parse(b);switch(d.type){case "client_connect":return b=d.clientId,(a=this.h.get(a))?(c=aq(this,a.sinkId),c.receiverType=chrome.cast.Yg.DIAL,c=new km("custom_dial_launch",new chrome.cast.Sj(c,a.Bk.state,a.Bk.extraData)),c.clientId=b,b=this.j,this.j=(this.j+1)%9007199254740992,c.sequenceNumber=b,this.g.add(c.sequenceNumber),this.f.Vd(a.routeId,c),a=Promise.resolve()):a=Promise.reject(Error("Unknown route")),a;case "custom_dial_launch":if(this.g.contains(d.sequenceNumber))return this.g.remove(d.sequenceNumber),
b=d.message,(a=this.h.get(a))?b&&!b.doLaunch?a=Promise.resolve():(c=this.m.ha(a.sinkId))?(c=new mp(c),d=a.launchParameter,d=(b?b.launchParameter:null)||d,a=c.launchApp(a.appName,d)):a=Promise.reject(Error("Custom launch response for sink that no longer exists")):a=Promise.reject(Error("Unknown route")),a;break;case "v2_message":if("STOP"==d.message.type)return this.terminateRoute(a),Promise.resolve()}return this.b.sendRouteMessage(a,b,c)};
Xp.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};var aq=function(a,b){a=a.m.ha(b);b=Oj(Nj(),b);b=new chrome.cast.bi(b,a.Mb.friendlyName);b.ipAddress=a.hb();b.receiverType=chrome.cast.Yg.DIAL;return b};g=Xp.prototype;g.tf=function(a){return this.b.tf(a)};g.De=function(a){return this.b.De(a)};g.Ih=function(){};g.eg=function(a,b){return a.startsWith("cast-dial:")||cq.test(a)||this.b.eg(a,b)};
g.cf=function(a,b,c){return this.b.cf(a,b,c)};g.connectRouteByRouteId=function(a,b,c,d,e){return this.b.connectRouteByRouteId(a,b,c,d,e)};g.joinRoute=function(a,b,c,d,e,f){return this.b.joinRoute(a,b,c,d,e,f)};g.detachRoute=function(a){this.h.remove(a);this.b.detachRoute(a)};g.Wc=function(){this.f.Wc()};g.onSinkAvailabilityUpdated=function(a,b){this.f.onSinkAvailabilityUpdated(a,b)};g.Ff=function(a,b){this.f.Ff(this,b)};g.ug=function(a){this.f.ug(a)};g.Ke=function(a){this.f.Ke(a)};g.nl=function(){};
g.Vd=function(a,b){this.f.Vd(a,b)};g.onPresentationConnectionStateChanged=function(a,b){this.f.onPresentationConnectionStateChanged(a,b)};g.onPresentationConnectionClosed=function(a,b,c){this.f.onPresentationConnectionClosed(a,b,c)};g.Ci=function(a){return this.f.Ci(a)};g.Ei=function(){return this.f.Ei()};g.xd=function(a){this.f.xd(a)};g.Hh=function(a,b){this.f.Hh(a,b)};g.ej=function(a){this.f.ej(a)};g.sg=function(a){this.b.sg(a)};g.tg=function(a){this.b.tg(a)};g.Df=function(a){this.b.Df(a)};
g.Vi=function(){};g.xl=function(){};g.searchSinks=function(a,b){return this.b.searchSinks(a,b)};g.provideSinks=function(a){this.b.provideSinks(a)};g.createMediaRouteController=function(){return sb()};g.vj=function(a){this.f.vj(a)};g.Pi=function(){return this.f.Pi()};g.Jf=function(a,b){return this.f.Jf(a,b)};g.Ce=function(){return this.b.Ce()};
var Zp=function(a){try{var b=new URL(a)}catch(e){return null}if("dial:"==b.protocol)return a;if("cast-dial:"==b.protocol){var c=b;a="cast-dial:"!=c.protocol?null:new sm(c.pathname,c.searchParams.get("dialPostData"),c.searchParams.get("clientId"));c=a.h;var d=a.b}else if("https:"==b.protocol){a=Dm(a);if(!a)return null;c=a.u;d=a.A}c?(a=d||"",c=new URL("dial:"+c),a&&c.searchParams.set("postData",a),c=c.toString()):c=null;return c},$p=function(a){try{var b=new URL(a)}catch(c){return null}return"cast-dial:"==
b.protocol?b.searchParams.get("clientId"):"https:"==b.protocol?Em(a):null},Yp=function(a,b,c,d){this.f=a;this.sequenceNumber=b;this.h=c;this.b=d},cq=/__dialAppName__/;var dq=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,eq=function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},fq=function(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=
a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},gq=/#|$/,hq=function(a,b){var c=a.search(gq);a:{var d=0;for(var e=b.length;0<=(d=a.indexOf(b,d))&&d<c;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>c)e=c;d+=b.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},iq=function(a,b){var c=a.length-1;0<=c&&
a.indexOf("/",c)==c&&(a=a.substr(0,a.length-1));Ic(b,"/")&&(b=b.substr(1));return Wc(a,"/",b)};var jq=function(a){this.gc=this.s=this.h="";this.Pa=null;this.g=this.b="";this.j=!1;var b;a instanceof jq?(this.j=Qa(void 0)?void 0:a.j,kq(this,a.h),this.s=a.s,this.gc=a.gc,lq(this,a.Sa()),this.b=a.b,mq(this,a.f.clone()),this.g=a.g):a&&(b=String(a).match(dq))?(this.j=!1,kq(this,b[1]||"",!0),this.s=nq(b[2]||""),this.gc=nq(b[3]||"",!0),lq(this,b[4]),this.b=nq(b[5]||"",!0),mq(this,b[6]||"",!0),this.g=nq(b[7]||"")):(this.j=!1,this.f=new oq(null,this.j))};
jq.prototype.toString=function(){var a=[],b=this.h;b&&a.push(pq(b,qq,!0),":");var c=this.gc;if(c||"file"==b)a.push("//"),(b=this.s)&&a.push(pq(b,qq,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Sa(),null!=c&&a.push(":",String(c));if(c=this.b)this.gc&&"/"!=c.charAt(0)&&a.push("/"),a.push(pq(c,"/"==c.charAt(0)?rq:sq,!0));(c=this.f.toString())&&a.push("?",c);(c=this.g)&&a.push("#",pq(c,tq));return a.join("")};
jq.prototype.resolve=function(a){var b=this.clone(),c=!!a.h;c?kq(b,a.h):c=!!a.s;c?b.s=a.s:c=!!a.gc;c?b.gc=a.gc:c=null!=a.Pa;var d=a.b;if(c)lq(b,a.Sa());else if(c=!!a.b){if("/"!=d.charAt(0))if(this.gc&&!this.b)d="/"+d;else{var e=b.b.lastIndexOf("/");-1!=e&&(d=b.b.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=Ic(e,"/");e=e.split("/");for(var f=[],h=0;h<e.length;){var k=e[h++];"."==k?d&&h==e.length&&f.push(""):".."==k?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&h==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}c?b.b=d:c=""!==a.f.toString();c?mq(b,a.f.clone()):c=!!a.g;c&&(b.g=a.g);return b};jq.prototype.clone=function(){return new jq(this)};var kq=function(a,b,c){a.h=c?nq(b,!0):b;a.h&&(a.h=a.h.replace(/:$/,""))};jq.prototype.Sa=function(){return this.Pa};
var lq=function(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Pa=b}else a.Pa=null},mq=function(a,b,c){b instanceof oq?(a.f=b,uq(a.f,a.j)):(c||(b=pq(b,vq)),a.f=new oq(b,a.j))},nq=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},pq=function(a,b,c){return Ra(a)?(a=encodeURI(a).replace(b,wq),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},wq=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
qq=/[#\/\?@]/g,sq=/[#\?:]/g,rq=/[#\?]/g,vq=/[#\?@]/g,tq=/#/g,oq=function(a,b){this.f=this.b=null;this.h=a||null;this.g=!!b},xq=function(a){a.b||(a.b=new Hk,a.f=0,a.h&&eq(a.h,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))},zq=function(a){var b=Ll(a);if("undefined"==typeof b)throw Error("Keys are undefined");var c=new oq(null,void 0);a=Kl(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];eb(f)?yq(c,e,f):c.add(e,f)}return c};g=oq.prototype;g.pa=function(){xq(this);return this.f};
g.add=function(a,b){xq(this);this.h=null;a=Aq(this,a);var c=this.b.get(a);c||this.b.set(a,c=[]);c.push(b);this.f+=1;return this};g.remove=function(a){xq(this);a=Aq(this,a);return Kk(this.b,a)?(this.h=null,this.f-=this.b.get(a).length,this.b.remove(a)):!1};g.clear=function(){this.b=this.h=null;this.f=0};g.Gb=function(){xq(this);return 0==this.f};var Bq=function(a,b){xq(a);b=Aq(a,b);return Kk(a.b,b)};g=oq.prototype;g.ff=function(a){var b=this.ba();return jc(b,a)};
g.forEach=function(a,b){xq(this);this.b.forEach(function(c,d){w(c,function(c){a.call(b,c,d,this)},this)},this)};g.xb=function(){xq(this);for(var a=this.b.ba(),b=this.b.xb(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};g.ba=function(a){xq(this);var b=[];if(Ra(a))Bq(this,a)&&(b=uc(b,this.b.get(Aq(this,a))));else{a=this.b.ba();for(var c=0;c<a.length;c++)b=uc(b,a[c])}return b};
g.set=function(a,b){xq(this);this.h=null;a=Aq(this,a);Bq(this,a)&&(this.f-=this.b.get(a).length);this.b.set(a,[b]);this.f+=1;return this};g.get=function(a,b){if(!a)return b;a=this.ba(a);return 0<a.length?String(a[0]):b};var yq=function(a,b,c){a.remove(b);0<c.length&&(a.h=null,a.b.set(Aq(a,b),x(c)),a.f+=c.length)};
oq.prototype.toString=function(){if(this.h)return this.h;if(!this.b)return"";for(var a=[],b=this.b.xb(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.ba(d);for(var f=0;f<d.length;f++){var h=e;""!==d[f]&&(h+="="+encodeURIComponent(String(d[f])));a.push(h)}}return this.h=a.join("&")};oq.prototype.clone=function(){var a=new oq;a.h=this.h;this.b&&(a.b=this.b.clone(),a.f=this.f);return a};
var Aq=function(a,b){b=String(b);a.g&&(b=b.toLowerCase());return b},uq=function(a,b){b&&!a.g&&(xq(a),a.h=null,a.b.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(this.remove(b),yq(this,c,a))},a));a.g=b};oq.prototype.extend=function(a){for(var b=0;b<arguments.length;b++)Nl(arguments[b],function(a,b){this.add(b,a)},this)};var Cq=function(a,b){this.input=a;this.domain=b};var Dq=function(a){this.b=a;this.l=vb("mr.ExternalMessageHandler")};
Dq.prototype.onMessage=function(a,b,c){var d=this;this.l.info("Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.b.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Cq(a.meetingName,a.domain)).then(function(a){var f="PresentationId"+b.id+Eq++;d.b.createRoute("urn:x-org.chromium.media:source:desktop",a,f).then(function(a){c(new Oe(e,"route",a.id))}).catch(function(a){c(new Oe(e,"error",a))})},function(){c(new Oe(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.b.terminateRoute(a.message.routeId).then(function(){c(new Oe(e,"stopped"))}):"subscribe_log_data"==a.type?(xb.push(function(a){chrome.runtime.sendMessage(b.id,new Oe(e,"log_message",a))}),c(new Oe(e,"subscribed"))):(c(new Oe(e,"error",Error("Unhandled message type"))),this.l.error("Unhandled message type "+a.type))};var Eq=0;var Fq=function(){this.b=[];this.f=[]};g=Fq.prototype;g.enqueue=function(a){if(1E3<=this.pa()){if(this.Gb())throw Error("Empty queue");0==this.b.length&&(this.b=this.f,this.b.reverse(),this.f=[]);this.b.pop()}this.f.push(a)};g.pa=function(){return this.b.length+this.f.length};g.Gb=function(){return 0==this.pa()};g.ba=function(){var a=this.b.slice();a.reverse();a.push.apply(a,Na(this.f));return a};g.clear=function(){this.b=[];this.f=[]};var Gq=function(){this.b=new Fq;this.f=Date.now()},Iq=function(){null==Hq&&(Hq=new Gq);return Hq};Gq.prototype.init=function(){wb=1;var a=vb("browser"),b=window.onerror;window.onerror=function(c,e,f,h,k){b&&b(c,e,f,h,k);a.error("Error: "+c+" ("+e+" @ Line: "+f+")",k)};xb.push(this.g.bind(this));var c=window.localStorage["debug.logs"];c&&(wb=Eb(c.toUpperCase()));(c=window.localStorage["debug.console"])&&"false"!=c.toLowerCase()&&xb.push(this.h.bind(this))};
Gq.prototype.g=function(a){this.b.enqueue(Jq(this,a,!1));a=a.tc;a instanceof Error&&a.stack&&this.b.enqueue(a.stack)};Gq.prototype.h=function(a){var b=[Jq(this,a,!0)];a.tc&&b.push(a.tc);switch(a.level){case 3:console.error.apply(console,Na(b));break;case 2:console.warn.apply(console,Na(b));break;case 1:console.log.apply(console,Na(b));break;default:console.debug.apply(console,Na(b))}};
var Jq=function(a,b,c){var d=["["];if(c)d.push(("       "+((Date.now()-a.f)/1E3).toFixed(3)).slice(-7));else{a=new Date(b.time);var e=function(a){return 10>a?"0"+a:a};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",Db[b.level],"][",b.J,"] ",b.message);if(!c&&null!=b.tc)if(d.push("\n"),b.tc instanceof Error)d.push(b.tc.message);else try{d.push(JSON.stringify(b.tc))}catch(f){d.push(b.tc.toString())}d.push("\n");
return d.join("")},Kq=function(){var a=Iq();return 0==a.b.pa()?"NA":a.b.ba().join("")},Lq=function(){var a=Iq();tj(a)};Gq.prototype.va=function(){return"LogManager"};Gq.prototype.Ta=function(){return[this.b.ba()]};Gq.prototype.ab=function(){var a=this.b.ba();this.b.clear();for(var b=la(qj(this)||[]),c=b.next();!c.done;c=b.next())this.b.enqueue(c.value);a=la(a);for(c=a.next();!c.done;c=a.next())this.b.enqueue(c.value)};var Hq=null;var Mq=function(a){this.b=a;this.l=vb("mr.InternalMessageHandler")};
Mq.prototype.onMessage=function(a,b,c){var d=this;if("retrieve_log_data"!=a.type)c(new Oe(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:Kq(),device:Pj()};b=[];var f=Ne(e.device.ip).then(function(a){a.b&&(e.device.version=a.b)});b.push(f);var h=this.b.u;h&&(a=Nq(this,h,a.source).then(function(a){a&&(e.castStreamingLogs=a)},function(){d.l.error("Log upload failed for service: "+h)}),b.push(a));e.dialDeviceCounts=Oq(this);b.push(Pq(this,e));a=this.b.getMediaSinkServiceStatus().then(function(a){e.mediaSinkServiceStatus=
a.status},function(){d.l.error("Fail to get media sink service status")});b.push(a);Ok(b).then(function(){c(e)})}};var Pq=function(a,b){return ug("mr.cast.SinkDiscoveryService").then(function(a){a=a.Ce();b.castDeviceCounts=a.He+"."+a.ve},function(){a.l.error("Failed to get device counts for castDeviceCounts.")})},Oq=function(a){a=Qq(a.b,"dial");if(!a)return"";a=a.Ce();return a.He+"."+a.ve},Nq=function(a,b,c){return Rq(a.b,b).then(function(a){return a.cj(c)})};var Sq={ACCEPTED:0,ot:1,TIMEOUT:2},Tq={SUCCESS:0,Vm:1},Uq={no:0,Dn:1,Sx:2,cu:3,bu:4,kv:5,TIMEOUT:6,pw:7},Vq={Zt:0,nx:1},Wq={Tv:0,Qu:1,USER:2,Ut:3},Xq=function(a){Rb("MediaRouter.Cloud.Knock.Result",a,Sq)},Yq=function(a){Rb("MediaRouter.Cloud.Session.Start",a,Tq)},Zq=function(a){Rb("MediaRouter.Cloud.Session.Type",a,Vq)},$q=function(a){Rb("MediaRouter.Cloud.Device.UserRole",a,Wq)};var ar=function(a,b){this.b=a;this.f=b},br=new ar("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),cr=new ar("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),dr=new ar("https://www.googleapis.com/calendar/v3",""),er=new ar("https://www.googleapis.com/hangouts/v1",""),fr=new ar("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var gr=function(a,b,c,d,e,f){c=void 0===c?null:c;a||null==c&&(c="default");this.sl=a;this.Oa=b;this.gc=c;this.Cf=void 0===d?null:d;this.Mc=void 0===e?null:e;this.Pe=void 0===f?null:f};gr.prototype.f=function(){var a="";this.Mc?a=this.Mc:this.Cf&&(a=this.Cf);return a};gr.prototype.Kc=function(){return this.sl};gr.prototype.getId=function(){return this.Oa};gr.prototype.merge=function(a){!this.Pe&&a.Pe&&(this.Pe=a.Pe);!this.Mc&&a.Mc&&(this.Mc=a.Mc);this.Mc&&a.Mc&&this.Pe&&(this.Mc=a.Mc)};var hr=function(a,b){this.f=a;this.h=b;this.l=vb("mr.cloud.calendar.CalendarService")},lr=function(a){return ir(a,a.h.b).then(function(b){a.l.info(jr(b.length)+" events discovered before filtering.");return kr(a,b)},function(b){v(a.l,"Error getting Hangouts from calendar.",b);return[]})},jr=function(a){return 20<a?"20+":a.toString()},ir=function(a,b){var c=Date.now();return nr(a,b,new Date(c),new Date(c+9E5)).then(function(b){return b.filter(a.b)})};
hr.prototype.b=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var nr=function(a,b,c,d){b=or(dr.b,["calendars",b,"events"],{timeMin:c.toJSON(),timeMax:d.toJSON(),singleEvents:!0});Cb(a.l,"Retrieving Hangouts from Calendar: "+b);return pr(a.f,b,"GET").then(function(a){return a.items?a.items:[]})},kr=function(a,b){var c=[];b.filter(function(a){return a.hangoutLink}).forEach(function(b){var d=new jq(b.hangoutLink);if("meet.google.com"==d.gc)c.push(new gr(!0,d.b.substring(1),void 0,void 0,b.summary));else if(d=d.b.substring(12).split("/"),2==d.length){var f=la(d);
d=f.next().value;f=f.next().value;if(-1!=d.indexOf(".")){var h=f;var k=d}c.push(new gr(!1,f+"@"+d,k,h,b.summary,void 0))}else v(a.l,"Invalid hangout link from calendar event: "+b.hangoutLink)});a.l.info(jr(c.length)+" events discovered with Hangout links.");return c};var qr=function(a){this.b=a;this.id=a.id;this.l=vb("mr.cloud.devices.WeaveDevice")};qr.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.b.connectionStatus,b="available"==this.getState().appStatus,c=rr(this,864E5);Cb(this.l,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=rr(this,9E5);this.l.info("Availability for legacy receiver app: "+a);return a};
var rr=function(a,b){a=a.b.lastUpdateTimeMs?Number(a.b.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-b)};qr.prototype.f=function(){return this.getState().settings.receiverName};qr.prototype.getId=function(){return this.id};qr.prototype.getState=function(){return this.b.state._cloudCast};var sr=function(a){this.email=a;this.imageUrl=null},tr=function(a){this.type=a},ur=function(a,b,c,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=b||null;this.flungUrl=c||null;this.presentationId=d||null};l(ur,tr);
var vr=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},wr={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},xr=new vr("_knockingStartWebrtcSession",wr,"viewer"),yr=new vr("_startWebrtcSession",wr),zr=new vr("_stopSession",{},"viewer");var Ar=function(a){this.s=a;this.f=this.h=this.b=null;this.j=this.g=!1;this.l=vb("mr.cloud.devices.WeaveDevicesService");tj(this)};Ar.prototype.getDevice=function(a){a=or(br.b,["devices",a]);return pr(this.s,a,"GET").then(function(a){return new qr(a)})};
var Br=function(a,b){var c=or(br.b,["devices"],b);return pr(a.s,c,"GET").then(function(c){var d=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new qr(a)});if(c=c.nextPageToken){var f=sd(b);f.token=c;return Br(a,f).then(function(a){return d.concat(a)})}return d})};Ar.prototype.va=function(){return"WeaveDevicesService"};Ar.prototype.Ta=function(){return[new Cr(this.b,this.f,this.h)]};
Ar.prototype.ab=function(){var a=qj(this);a&&(this.b=a.Ep,this.f=a.gcmRegistrationId,this.h=a.Dp)};
var Dr=function(a){return new Promise(function(b,c){a.g?c(Error("Registering...")):(a.g=!0,a.f&&a.h&&a.h+864E5>=Date.now()?(a.g=!1,b(a.f)):chrome.gcm.register(["919648714761"],function(d){a.g=!1;d?(Cb(a.l,"Got GCM ID: "+d),a.f=d,a.h=Date.now(),a.b=null,b(d)):(v(a.l,"Error: "+chrome.runtime.lastError.message),a.f=null,a.h=null,a.b=null,c(Error(chrome.runtime.lastError.message)))}))})},Er=function(a,b){if(a.j)Promise.resolve();else if(a.j=!0,b&&(!a.b||a.b+864E5<Date.now())){b={filters:["myDevices"],
gcmRegistrationId:b,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=or(br.b,["subscriptions","subscribe"],{});pr(a.s,c,"POST",b).then(function(){Cb(a.l,"Subscribed on: "+Date.now());a.b=Date.now();a.j=!1;return Promise.resolve()},function(b){a.j=!1;throw b;})}else Promise.resolve()},Cr=function(a,b,c){this.Ep=a;this.gcmRegistrationId=b;this.Dp=c};var Fr=function(a,b,c,d,e,f,h,k){var n=Oj(Nj(),a);this.Ea=new mj(n,b,h,k,e);this.deviceId=a;this.b=c;this.model=d;this.isAvailable=f};ba.Object.defineProperties(Fr.prototype,{displayName:{configurable:!0,enumerable:!0,set:function(a){this.Ea.friendlyName=a}}});var Gr=function(a,b,c,d,e){Fr.call(this,a,b,"weave","Chrome Streaming Receiver",d,e,"education");this.ki=c};l(Gr,Fr);
var Hr=function(a){var b=a.gc,c;a.Cf&&a.f()!=a.Cf&&(c=a.Cf);Fr.call(this,a.getId(),a.f(),"mesi","Hangout",b,!1,a.Kc()?"meeting":"hangout",c);this.Kc=a.Kc();this.Oe=a.Pe||""};l(Hr,Fr);var Ir=function(a,b,c){Fr.call(this,a,b,"slarti","Cast Receiver for Education","default",c,"education")};l(Ir,Fr);var Jr=function(a,b,c){this.s=a;this.g=b;this.b=new Map;this.h=new Map;this.f=null;this.j=c};Jr.prototype.Wd=function(){var a=this.f+this.j;if(null==this.f||a<Date.now())this.f=Date.now(),Kr(this);return Array.from(this.b.values())};Jr.prototype.ha=function(a){return this.b.get(a)||null};
var Kr=function(a){a.s().then(function(b){Lr(a,b)})},Lr=function(a,b){var c=new Map(a.b),d=new Map,e=new Map,f=[],h=[];b.forEach(function(a){var b=a.Ea.id;d.set(b,a);e.set(b,a.deviceId);c.has(b)?c.has(b)&&JSON.stringify(c.get(b))!=JSON.stringify(a)&&h.push(a.Ea):f.push(a.Ea);c.delete(b)});b=[].concat(Na(c.values())).map(function(a){return a.Ea});a.h.clear();a.h=e;a.b.clear();a.b=d;Mr(a,f,h,b)},Mr=function(a,b,c,d){0<b.length&&Nr(a.g,b);0<c.length&&Or(a.g,c);0<d.length&&Pr(a.g,d)},Rr=function(a){for(var b=
{},c=la(a.b.entries()),d=c.next();!d.done;d=c.next()){var e=la(d.value);d=e.next().value;e=e.next().value;b[d]=e}c={};d=la(a.h.entries());for(e=d.next();!e.done;e=d.next()){var f=la(e.value);e=f.next().value;f=f.next().value;c[e]=f}return new Qr(b,c,a.f)},Sr=function(a,b){for(var c in b.sinks){var d=b.sinks[c],e=null;"Hangout"==d.model?e=new Hr(new gr(d.Kc,d.deviceId,d.Ea.domain,d.Ea.description,d.Ea.friendlyName,d.Oe)):"Cast Receiver for Education"==d.model?e=new Ir(d.deviceId,d.Ea.friendlyName,
d.isAvailable):"Chrome Streaming Receiver"==d.model&&(e=new Gr(d.deviceId,d.Ea.friendlyName,d.ki,d.Ea.domain,d.isAvailable));a.b.set(c,e)}for(c in b.b)a.h.set(c,b.b[c]);b.f&&(a.f=b.f)},Qr=function(a,b,c){this.sinks=a;this.b=b;this.f=c};var Tr=function(a){var b=[],c=[],d={},e=function(a,h){var f=h+"  ";try{if(Qa(a))if(null===a)b.push("NULL");else if(Ra(a))b.push('"'+a.replace(/\n/g,"\n"+h)+'"');else if(ib(a))b.push(String(a).replace(/\n/g,"\n"+h));else if(jb(a)){a[lb]||c.push(a);var n=a[lb]||(a[lb]=++nb);if(d[n])b.push("*** reference loop detected (id="+n+") ***");else{d[n]=!0;b.push("{");for(var u in a)ib(a[u])||(b.push("\n"),b.push(f),b.push(u+" = "),e(a[u],f));b.push("\n"+h+"}");delete d[n]}}else b.push(a);else b.push("undefined")}catch(z){b.push("*** "+
z+" ***")}};e(a,"");for(a=0;a<c.length;a++)mb(c[a]);return b.join("")},Ur=function(a){var b=Ur;var c=Error();if(Error.captureStackTrace)Error.captureStackTrace(c,b),b=String(c.stack);else{try{throw c;}catch(e){c=e}b=(b=c.stack)?String(b):null}if(b)return b;b=[];c=arguments.callee.caller;for(var d=0;c&&(!a||d<a);){b.push(Vr(c));b.push("()\n");try{c=c.caller}catch(e){b.push("[exception trying to get caller]\n");break}d++;if(50<=d){b.push("[...long stack...]");break}}a&&d>=a?b.push("[...reached max depth limit...]"):
b.push("[end]");return b.join("")},Vr=function(a){if(Wr[a])return Wr[a];a=String(a);if(!Wr[a]){var b=/function ([^\(]+)/.exec(a);Wr[a]=b?b[1]:"[Anonymous]"}return Wr[a]},Wr={},Xr=Object.freeze||function(a){return a};var Yr=function(a,b,c){this.reset(a,b,c,void 0,void 0)};Yr.prototype.b=null;var Zr=0;Yr.prototype.reset=function(a,b,c,d,e){"number"==typeof e||Zr++;this.j=d||q();this.f=a;this.g=b;this.h=c;delete this.b};Yr.prototype.getMessage=function(){return this.g};var $r=function(a){this.j=a;this.b=this.g=this.f=this.h=null},as=function(a,b){this.name=a;this.value=b};as.prototype.toString=function(){return this.name};var bs=new as("SEVERE",1E3),cs=new as("WARNING",900),ds=new as("INFO",800),es=new as("CONFIG",700),fs=new as("FINE",500),gs=new as("FINER",400),hs=new as("ALL",0);$r.prototype.getName=function(){return this.j};$r.prototype.getChildren=function(){this.g||(this.g={});return this.g};
var is=function(a){if(a.f)return a.f;if(a.h)return is(a.h);Xb("Root logger has no level set.");return null};$r.prototype.log=function(a,b,c){a.value>=is(this).value&&(ib(b)&&(b=b()),a=new Yr(a,String(b),this.j),c&&(a.b=c),js(this,a))};$r.prototype.info=function(a,b){this.log(ds,a,b)};$r.prototype.config=function(a,b){this.log(es,a,b)};$r.prototype.logRecord=function(a){a.f.value>=is(this).value&&js(this,a)};
var js=function(a,b){for(;a;){var c,d=a,e=b;if(d.b)for(var f=0;c=d.b[f];f++)c(e);a=a.h}},ks={},ls=null,ms=function(){ls||(ls=new $r(""),ks[""]=ls,ls.f=es)},ns=function(a){ms();var b;if(!(b=ks[a])){b=new $r(a);var c=a.lastIndexOf("."),d=a.substr(c+1);c=ns(a.substr(0,c));c.getChildren()[d]=b;b.h=c;ks[a]=b}return b};var os=function(a,b,c,d){a&&a.log(b,c,d)},ps=function(a,b,c){a&&a.log(bs,b,c)},qs=function(a,b,c){a&&a.log(cs,b,c)},W=function(a,b){a&&a.info(b,void 0)},rs=function(a,b){a&&a.log(fs,b,void 0)};var us=function(a,b,c){if(!ss){ms();var d=ls;d.f=hs;var e=ts;d.b||(d.b=[]);d.b.push(e);ss=!0}this.h=a;this.g=b;this.b=new Jr(this.j.bind(this),c,2E4);this.f=new Map;tj(this)},ts=function(a){yb({J:a.h,level:Fb(a.f.value),time:a.j,message:a.getMessage(),tc:a.b})};us.prototype.Wd=function(){return this.b.Wd()};us.prototype.ha=function(a){return this.b.ha(a)};
us.prototype.j=function(){var a=this;this.l.info("Fetching hangouts");return Ok([vs(this.g),lr(this.h)]).then(function(b){var c=Array.from(a.f.values());b.forEach(function(b){b.Qd?c=c.concat(b.value):a.l.error("Error discovering Hangouts",b.reason)});var d=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(d).map(function(a){a=d[a];Qb("MediaRouter.Cloud.Hangout.Sink.Discovered");return new Hr(a)})})};
var xs=function(a,b){return ug("mr.mirror.hangouts.MeetingsService").then(function(a){return a.uc(b)}).then(function(b){return ws(a,b)},function(){return b.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):ws(a,b.input,b.domain)})},ws=function(a,b,c){c=c||void 0;var d=!c;b=new gr(d,d?b:b+"@"+c,c,b,void 0,void 0);a.f.set(b.getId(),b);b=new Hr(b);a.b.b.set(b.Ea.id,b);return b.Ea};us.prototype.va=function(){return"HangoutSinkDiscoveryService"};
us.prototype.Ta=function(){for(var a={},b=la(this.f.entries()),c=b.next();!c.done;c=b.next()){var d=la(c.value);c=d.next().value;d=d.next().value;a[c]=d}return[{cache:Rr(this.b),manualHangouts:a}]};us.prototype.ab=function(){var a=qj(this);if(a){Sr(this.b,a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.f.set(b,new gr(c.sl,c.Oa,c.gc,c.Cf,c.Mc,c.Pe))}}};us.prototype.l=vb("mr.cloud.discovery.HangoutSinkDiscoveryService");var ss=!1;var As=function(){this.f=!1;this.b=null;this.h=!1;this.l=vb("mr.cloud.identity.IdentityService");tj(this);ys(this);zs(this)},Bs=function(a){return a.b?a.b.substr(a.b.indexOf("@")+1):""};As.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,b){chrome.identity.getAuthToken({interactive:!1},function(c){chrome.runtime.lastError?b(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==c?b(Error("User is not logged in (no token found)")):a(c)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var Cs=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})},zs=function(a){a.getAuthToken().then(function(b){chrome.identity.getProfileUserInfo(function(c){a.f=!!c.email||!!c.id;a.b=c.email||null;b&&!a.f&&(a.h=!0)})},function(b){Cb(a.l,"Unable to set sign in and email.",b)})},ys=function(a){chrome.identity.onSignInChanged.addListener(function(b,c){Dg(6);a.f=c;a.l.info("Signed in change: "+a.f);a.f?zs(a):(a.b=null,a.h=!1)})},Ds=function(a){return a.getAuthToken().then(function(b){var c=
window.gapi;if(!c)return a.l.error("gapi not loaded."),!1;a.l.info("Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};As.prototype.va=function(){return"IdentityService"};As.prototype.Ta=function(){return[null,{signedIn:this.f,userEmail:this.b,kioskAuth:this.h}]};As.prototype.ab=function(){var a=rj(this);a&&(a.signedIn&&(this.f=a.signedIn),a.userEmail&&(this.b=a.userEmail),a.kioskAuth&&(this.h=a.kioskAuth))};var Es="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Fs=function(a){var b=a.method,c=a.uri,d=a.rc,e=a.zc,f=a.Xl,h=a.headers,k=a.body,n=a.start,u=a.apiKey,z=a.Kg;a=a.gb;this.method=b&&b.toUpperCase()||"GET";(b=c)||(d=[d].concat(Na(e||[])).join("/"),d=new jq(encodeURI(d)),f&&(f=zq(f),mq(d,f)),b=d);this.uri=b;u&&this.uri.f.add("key",u);this.b=a||null;this.headers=h||{};(this.body=k)&&(this.headers["Content-Type"]="application/json");this.Kg=Qa(z)?z:1E4;this.start=n||q()},Gs=function(a){return(a.b?a.b.getAuthToken():Promise.resolve(null)).then(function(b){b&&
(a.headers.Authorization="Bearer "+b);b={method:a.method,headers:a.headers};a.body&&(b.body=JSON.stringify(a.body));return new Request(a.uri.toString(),b)})};var Hs=function(a,b){Ub.call(this,b&&b.message||a.statusText);this.code=a.status;this.response=a;this.status=b&&b.status};l(Hs,Ub);var Is=function(a,b){a=new Response(void 0,{status:b||408,statusText:a});return new Hs(a)};var Js=function(){this.s=this.s;this.la=this.la};Js.prototype.s=!1;Js.prototype.Ra=function(){this.s||(this.s=!0,this.ga())};Js.prototype.h=function(a){Ks(this,qb(Ls,a))};var Ks=function(a,b){a.s?Qa(void 0)?b.call(void 0):b():(a.la||(a.la=[]),a.la.push(Qa(void 0)?p(b,void 0):b))};Js.prototype.ga=function(){if(this.la)for(;this.la.length;)this.la.shift()()};
var Ls=function(a){a&&"function"==typeof a.Ra&&a.Ra()},Ms=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];hb(d)?Ms.apply(null,d):Ls(d)}};var X=function(a,b){this.type=a;this.f=this.target=b;this.hm=!0};X.prototype.g=function(){this.hm=!1};var Ns=!Gd||9<=Number(ae),Os=Gd&&!$d("9"),Ps=function(){if(!Pa.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});Pa.addEventListener("test",Za,b);Pa.removeEventListener("test",Za,b);return a}();var Qs=function(a,b){X.call(this,a?a.type:"");this.relatedTarget=this.f=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.b=null;a&&this.init(a,b)};t(Qs,X);var Rs=Xr({2:"touch",3:"pen",4:"mouse"});
Qs.prototype.init=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.f=b;(b=a.relatedTarget)?Id&&(Cd(b,"nodeName")||(b=null)):"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=
void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ra(a.pointerType)?a.pointerType:Rs[a.pointerType]||"";this.state=a.state;this.b=a;a.defaultPrevented&&this.g()};
Qs.prototype.g=function(){Qs.ra.g.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Os)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Ss="closure_listenable_"+(1E6*Math.random()|0),Ts=function(a){return!(!a||!a[Ss])},Us=0;var Vs=function(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.rb=e;this.key=++Us;this.removed=this.ih=!1},Ws=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.rb=null};var Xs=function(a){this.src=a;this.b={};this.f=0};Xs.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.b[f];a||(a=this.b[f]=[],this.f++);var h=Ys(a,b,d,e);-1<h?(b=a[h],c||(b.ih=!1)):(b=new Vs(b,this.src,f,!!d,e),b.ih=c,a.push(b));return b};Xs.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.b))return!1;var e=this.b[a];b=Ys(e,b,c,d);return-1<b?(Ws(e[b]),qc(e,b),0==e.length&&(delete this.b[a],this.f--),!0):!1};
var Zs=function(a,b){var c=b.type;if(!(c in a.b))return!1;var d=rc(a.b[c],b);d&&(Ws(b),0==a.b[c].length&&(delete a.b[c],a.f--));return d};Xs.prototype.removeAll=function(a){a=a&&a.toString();var b=0,c;for(c in this.b)if(!a||c==a){for(var d=this.b[c],e=0;e<d.length;e++)++b,Ws(d[e]);delete this.b[c];this.f--}return b};var $s=function(a,b,c,d,e){a=a.b[b.toString()];b=-1;a&&(b=Ys(a,c,d,e));return-1<b?a[b]:null};
Xs.prototype.hasListener=function(a,b){var c=Qa(a),d=c?a.toString():"",e=Qa(b);return hd(this.b,function(a){for(var f=0;f<a.length;++f)if(!(c&&a[f].type!=d||e&&a[f].capture!=b))return!0;return!1})};var Ys=function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==b&&f.capture==!!c&&f.rb==d)return e}return-1};var at="closure_lm_"+(1E6*Math.random()|0),bt={},ct=0,et=function(a,b,c,d,e){if(d&&d.once)return dt(a,b,c,d,e);if(eb(b)){for(var f=0;f<b.length;f++)et(a,b[f],c,d,e);return null}c=ft(c);return Ts(a)?a.listen(b,c,jb(d)?!!d.capture:!!d,e):gt(a,b,c,!1,d,e)},gt=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var h=jb(e)?!!e.capture:!!e,k=ht(a);k||(a[at]=k=new Xs(a));c=k.add(b,c,d,h,f);if(c.proxy)return c;d=it();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)Ps||(e=h),void 0===e&&(e=
!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(jt(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");ct++;return c},it=function(){var a=kt,b=Ns?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b},dt=function(a,b,c,d,e){if(eb(b)){for(var f=0;f<b.length;f++)dt(a,b[f],c,d,e);return null}c=ft(c);return Ts(a)?lt(a,b,c,jb(d)?
!!d.capture:!!d,e):gt(a,b,c,!0,d,e)},mt=function(a,b,c,d,e){if(eb(b))for(var f=0;f<b.length;f++)mt(a,b[f],c,d,e);else d=jb(d)?!!d.capture:!!d,c=ft(c),Ts(a)?a.F.remove(String(b),c,d,e):a&&(a=ht(a))&&(b=$s(a,b,c,d,e))&&nt(b)},nt=function(a){if(m(a)||!a||a.removed)return!1;var b=a.src;if(Ts(b))return Zs(b.F,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(jt(c),d):b.addListener&&b.removeListener&&b.removeListener(d);ct--;(c=ht(b))?(Zs(c,
a),0==c.f&&(c.src=null,b[at]=null)):Ws(a);return!0},ot=function(a){if(a)if(Ts(a))a.xj(void 0);else if(a=ht(a)){var b=0,c;for(c in a.b)for(var d=a.b[c].concat(),e=0;e<d.length;++e)nt(d[e])&&++b}},jt=function(a){return a in bt?bt[a]:bt[a]="on"+a},qt=function(a,b,c,d){var e=!0;if(a=ht(a))if(b=a.b[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.removed&&(f=pt(f,d),e=e&&!1!==f)}return e},pt=function(a,b){var c=a.listener,d=a.rb||a.src;a.ih&&nt(a);return c.call(d,b)},kt=
function(a,b){if(a.removed)return!0;if(!Ns){var c=b||Ya("window.event");b=new Qs(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var e=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(h){e=!0}if(e||void 0==c.returnValue)c.returnValue=!0}c=[];for(e=b.f;e;e=e.parentNode)c.push(e);a=a.type;for(e=c.length-1;0<=e;e--){b.f=c[e];var f=qt(c[e],a,!0,b);d=d&&f}for(e=0;e<c.length;e++)b.f=c[e],f=qt(c[e],a,!1,b),d=d&&f}return d}return pt(a,new Qs(b,this))},ht=function(a){a=a[at];return a instanceof
Xs?a:null},rt="__closure_events_fn_"+(1E9*Math.random()>>>0),ft=function(a){if(ib(a))return a;a[rt]||(a[rt]=function(b){return a.handleEvent(b)});return a[rt]};var Y=function(){Js.call(this);this.F=new Xs(this);this.Fn=this;this.L=null};t(Y,Js);Y.prototype[Ss]=!0;Y.prototype.removeEventListener=function(a,b,c,d){mt(this,a,b,c,d)};
Y.prototype.I=function(a){var b,c=this.L;if(c)for(b=[];c;c=c.L)b.push(c);c=this.Fn;var d=a.type||a;if(Ra(a))a=new X(a,c);else if(a instanceof X)a.target=a.target||c;else{var e=a;a=new X(d,c);wd(a,e)}e=!0;if(b)for(var f=b.length-1;0<=f;f--){var h=a.f=b[f];e=h.kf(d,!0,a)&&e}h=a.f=c;e=h.kf(d,!0,a)&&e;e=h.kf(d,!1,a)&&e;if(b)for(f=0;f<b.length;f++)h=a.f=b[f],e=h.kf(d,!1,a)&&e;return e};Y.prototype.ga=function(){Y.ra.ga.call(this);this.xj();this.L=null};
Y.prototype.listen=function(a,b,c,d){return this.F.add(String(a),b,!1,c,d)};var lt=function(a,b,c,d,e){return a.F.add(String(b),c,!0,d,e)};Y.prototype.xj=function(a){this.F&&this.F.removeAll(a)};Y.prototype.kf=function(a,b,c){a=this.F.b[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==b){var h=f.listener,k=f.rb||f.src;f.ih&&Zs(this.F,f);d=!1!==h.call(k,c)&&d}}return d&&0!=c.hm};
Y.prototype.hasListener=function(a,b){return this.F.hasListener(Qa(a)?String(a):void 0,b)};var st=function(a,b){this.h=a;this.g=b;this.f=0;this.b=null};st.prototype.get=function(){if(0<this.f){this.f--;var a=this.b;this.b=a.next;a.next=null}else a=this.h();return a};var tt=function(a,b){a.g(b);100>a.f&&(a.f++,b.next=a.b,a.b=b)};var ut=function(a){Pa.setTimeout(function(){throw a;},0)},vt,wt=function(){var a=Pa.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!ed("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host;
a=p(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!ed("Trident")&&!ed("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(Qa(c.next)){c=c.next;var a=c.Jk;c.Jk=null;a()}};return function(a){d.next={Jk:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){Pa.setTimeout(a,0)}};var xt=function(){this.f=this.b=null},zt=new st(function(){return new yt},function(a){a.reset()});xt.prototype.add=function(a,b){var c=zt.get();c.set(a,b);this.f?this.f.next=c:this.b=c;this.f=c};xt.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};var yt=function(){this.next=this.scope=this.b=null};yt.prototype.set=function(a,b){this.b=a;this.scope=b;this.next=null};yt.prototype.reset=function(){this.next=this.scope=this.b=null};var Et=function(a,b){At||Bt();Ct||(At(),Ct=!0);Dt.add(a,b)},At,Bt=function(){if(Pa.Promise&&Pa.Promise.resolve){var a=Pa.Promise.resolve(void 0);At=function(){a.then(Ft)}}else At=function(){var a=Ft;!ib(Pa.setImmediate)||Pa.Window&&Pa.Window.prototype&&!ed("Edge")&&Pa.Window.prototype.setImmediate==Pa.setImmediate?(vt||(vt=wt()),vt(a)):Pa.setImmediate(a)}},Ct=!1,Dt=new xt,Ft=function(){for(var a;a=Dt.remove();){try{a.b.call(a.scope)}catch(b){ut(b)}tt(zt,a)}Ct=!1};var Gt=function(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0},Ht=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};var Kt=function(a,b){this.b=0;this.m=void 0;this.g=this.f=this.h=null;this.j=this.s=!1;if(a!=Za)try{var c=this;a.call(b,function(a){It(c,2,a)},function(a){if(!(a instanceof Jt))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(e){}It(c,3,a)})}catch(d){It(this,3,d)}},Lt=function(){this.next=this.context=this.f=this.g=this.b=null;this.h=!1};Lt.prototype.reset=function(){this.context=this.f=this.g=this.b=null;this.h=!1};
var Mt=new st(function(){return new Lt},function(a){a.reset()}),Nt=function(a,b,c){var d=Mt.get();d.g=a;d.f=b;d.context=c;return d},Ot=function(a){if(a instanceof Kt)return a;var b=new Kt(Za);It(b,2,a);return b},Pt=function(a){return new Kt(function(b,c){c(a)})},Rt=function(a,b,c){Qt(a,b,c,null)||Et(qb(b,a))},St=function(a){return new Kt(function(b,c){a.length||b(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Rt(e,b,c)})},Tt=function(a){return new Kt(function(b,c){var d=a.length,e=[];if(d)for(var f=
function(a,c){d--;e[a]=c;0==d&&b(e)},h=function(a){c(a)},k=0,n;k<a.length;k++)n=a[k],Rt(n,qb(f,k),h);else b(e)})},Ut=function(a){return new Kt(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{Qd:!0,value:f}:{Qd:!1,reason:f};0==c&&b(d)},f=0,h;f<a.length;f++)h=a[f],Rt(h,qb(e,f,!0),qb(e,f,!1));else b(d)})},Wt=function(){var a,b,c=new Kt(function(c,e){a=c;b=e});return new Vt(c,a,b)};Kt.prototype.then=function(a,b,c){return Xt(this,ib(a)?a:null,ib(b)?b:null,c)};Gt(Kt);
var Zt=function(a,b,c){b=Nt(b,b,c);b.h=!0;Yt(a,b);return a},$t=function(a,b,c){return Xt(a,null,b,c)};Kt.prototype.cancel=function(a){0==this.b&&Et(function(){var b=new Jt(a);au(this,b)},this)};
var au=function(a,b){if(0==a.b)if(a.h){var c=a.h;if(c.f){for(var d=0,e=null,f=null,h=c.f;h&&(h.h||(d++,h.b==a&&(e=h),!(e&&1<d)));h=h.next)e||(f=h);e&&(0==c.b&&1==d?au(c,b):(f?(d=f,d.next==c.g&&(c.g=d),d.next=d.next.next):bu(c),cu(c,e,3,b)))}a.h=null}else It(a,3,b)},Yt=function(a,b){a.f||2!=a.b&&3!=a.b||du(a);a.g?a.g.next=b:a.f=b;a.g=b},Xt=function(a,b,c,d){var e=Nt(null,null,null);e.b=new Kt(function(a,h){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(u){h(u)}}:a;e.f=c?function(b){try{var e=c.call(d,
b);!Qa(e)&&b instanceof Jt?h(b):a(e)}catch(u){h(u)}}:h});e.b.h=a;Yt(a,e);return e.b};Kt.prototype.u=function(a){this.b=0;It(this,2,a)};Kt.prototype.A=function(a){this.b=0;It(this,3,a)};
var It=function(a,b,c){0==a.b&&(a===c&&(b=3,c=new TypeError("Promise cannot resolve to itself")),a.b=1,Qt(c,a.u,a.A,a)||(a.m=c,a.b=b,a.h=null,du(a),3!=b||c instanceof Jt||eu(a,c)))},Qt=function(a,b,c,d){if(a instanceof Kt)return Yt(a,Nt(b||Za,c||null,d)),!0;if(Ht(a))return a.then(b,c,d),!0;if(jb(a))try{var e=a.then;if(ib(e))return fu(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1},fu=function(a,b,c,d,e){var f=!1,h=function(a){f||(f=!0,c.call(e,a))},k=function(a){f||(f=!0,d.call(e,a))};try{b.call(a,
h,k)}catch(n){k(n)}},du=function(a){a.s||(a.s=!0,Et(a.o,a))},bu=function(a){var b=null;a.f&&(b=a.f,a.f=b.next,b.next=null);a.f||(a.g=null);return b};Kt.prototype.o=function(){for(var a;a=bu(this);)cu(this,a,this.b,this.m);this.s=!1};
var cu=function(a,b,c,d){if(3==c&&b.f&&!b.h)for(;a&&a.j;a=a.h)a.j=!1;if(b.b)b.b.h=null,gu(b,c,d);else try{b.h?b.g.call(b.context):gu(b,c,d)}catch(e){hu.call(null,e)}tt(Mt,b)},gu=function(a,b,c){2==b?a.g.call(a.context,c):a.f&&a.f.call(a.context,c)},eu=function(a,b){a.j=!0;Et(function(){a.j&&hu.call(null,b)})},hu=ut,Jt=function(a){Ub.call(this,a)};t(Jt,Ub);Jt.prototype.name="cancel";var Vt=function(a,b,c){this.T=a;this.resolve=b;this.reject=c};var iu=function(a,b){Y.call(this);this.g=a||1;this.f=b||Pa;this.j=p(this.o,this);this.m=q()};t(iu,Y);iu.prototype.enabled=!1;iu.prototype.b=null;var ju=function(a,b){a.g=b;a.b&&a.enabled?(a.stop(),a.start()):a.b&&a.stop()};iu.prototype.o=function(){if(this.enabled){var a=q()-this.m;0<a&&a<.8*this.g?this.b=this.f.setTimeout(this.j,this.g-a):(this.b&&(this.f.clearTimeout(this.b),this.b=null),this.I("tick"),this.enabled&&(this.stop(),this.start()))}};
iu.prototype.start=function(){this.enabled=!0;this.b||(this.b=this.f.setTimeout(this.j,this.g),this.m=q())};iu.prototype.stop=function(){this.enabled=!1;this.b&&(this.f.clearTimeout(this.b),this.b=null)};iu.prototype.ga=function(){iu.ra.ga.call(this);this.stop();delete this.f};
var ku=function(a,b,c){if(ib(a))c&&(a=p(a,c));else if(a&&"function"==typeof a.handleEvent)a=p(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:Pa.setTimeout(a,b||0)},lu=function(a){Pa.clearTimeout(a)},mu=function(a){var b=null;return $t(new Kt(function(c,d){b=ku(function(){c(void 0)},a);-1==b&&d(Error("Failed to schedule timer."))}),function(a){lu(b);throw a;})};var nu=function(){this.l=ns("mr.cloud.slarti.Fetcher");this.b=0};nu.prototype.execute=function(a){var b="Fetch call "+ ++this.b;return ou(this,b,a)};
var ou=function(a,b,c){var d=c.uri.toString().replace(/\?.*/,"?<redacted>"),e=c.method+" "+d;W(a.l,b+": "+e);d=[Gs(c).then(function(a){return Promise.resolve(fetch(a))})];c.Kg&&d.push(mu(c.Kg).then(function(){throw Is("API call timed out",504);}));return Promise.race(d).then(function(d){if(!d.ok)return d.json().then(function(a){return a},function(){return null}).then(function(a){var b;a&&a instanceof Object&&a.error&&(b=a.error);throw new Hs(d,b);});var f=(q()-c.start)/1E3;W(a.l,b+" succeeded: "+
e+" duration = "+f+"s");return(f=d.headers.get("content-type"))&&f.includes("application/json")?d.json():f&&(f.includes("image")||f.includes("application/octet-stream"))?d.blob():d.text()},function(c){var d="";if(c instanceof Hs)d=", ("+c.status+"): "+c.message;else{try{d=", "+JSON.stringify(c,null,2)}catch(k){}c instanceof Error&&"Failed to fetch"==c.message&&(c=Is(c.message))}ps(a.l,b+" failed: "+d);throw c;})};var pu=function(a,b){this.b=cr.b;this.gb=a;this.f=b};var qu=function(a,b){pu.call(this,a,b)};l(qu,pu);qu.prototype.register=function(a){a=new Fs({method:"POST",rc:this.b,zc:["user:register"],gb:this.gb,body:{gcmId:a}});return this.f.execute(a)};qu.prototype.unregister=function(a){a=new Fs({method:"POST",rc:this.b,zc:["user:unregister"],gb:this.gb,body:{gcmId:a}});return this.f.execute(a)};var ru=function(a){var b=window.localStorage;this.l=vb("mr.cloud.slarti.GcmRegistration");this.h=a;this.f=b;this.b=null},tu=function(a){if(!a.b){var b=a.f["mr.cloud.slarti.GcmRegistration.ID"];a.b=new Promise(function(c,d){chrome.gcm.register(["307539924703"],function(e){if(e)if(e==b)Cb(a.l,"Slarti GCM ID unchanged: "+e),c();else{Cb(a.l,"Got new Slarti GCM ID: "+e);var f=b?su(a,b):Promise.resolve();c(f.then(function(){return a.h.register(e).then(function(){a.f["mr.cloud.slarti.GcmRegistration.ID"]=
e})}))}else f=chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error",v(a.l,"Error registering for GCM notifications: "+f),b&&su(a,b).catch(function(b){v(a.l,"Failed to unregister GCM ID with Slarti",b)}),d(Error(f))})});a.b.then(function(){a.b=null},function(){a.b=null})}return a.b},su=function(a,b){return a.h.unregister(b).then(function(){delete a.f["mr.cloud.slarti.GcmRegistration.ID"]},function(b){v(a.l,"Failed to unregister GCM ID with Slarti",b)})};var uu=null,vu=function(){lk.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.l=vb("mr.cloud.slarti.GcmEventListener")};l(vu,lk);vu.prototype.Ng=function(a){return a&&"307539924703"==a.from&&(a=a.data.data)&&(a=JSON.parse(a).type)?(this.l.info("Received Slarti GCM notification: "+a),!0):!1};var wu=function(){null==uu&&(uu=new vu);return uu};var xu=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];d=a;c=la(c);for(var e=c.next();!e.done;e=c.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var yu=function(){lk.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.l=vb("mr.WeaveGcmEventListener")};l(yu,lk);yu.prototype.Ng=function(a){if(!a||"919648714761"!=a.from)return!1;a=xu(a,"data","notification");if(!a)return this.l.error("Notification json not found"),!1;try{var b=JSON.parse(a);return!!b&&Array.isArray(b.events)&&0<b.events.length}catch(c){return this.l.error("Invalid json: "+a),!1}};
var Au=function(){zu||(zu=new yu);return zu},zu=null;var Bu=function(a){this.b=a;this.l=vb("mr.cloud.messaging.WeaveGcmMessageHandler")};Bu.prototype.onMessage=function(a){var b=this;a=JSON.parse(a.data.notification);var c=Nj();a.events.forEach(function(a){if(a.deviceId){var d=Oj(c,a.deviceId);switch(a.type){case "deviceCreated":Cu(b,a);break;case "deviceUpdated":Du(b,a,d);break;case "deviceDeleted":Eu(b.b,{sinkId:d});break;default:Cb(b.l,function(){return"[unhandled event] "+JSON.stringify(a)})}}else b.l.error("Device ID not provided")})};
var Cu=function(a,b){var c=xu(b,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof c?a.l.error("Receiver name not a string: "+c):(b=new Gr(b.deviceId,c,"owner","default",!0),a=a.b,a.b.b.set(b.Ea.id,b),a.b.f=Date.now(),Nr(a.f,[b.Ea]))},Du=function(a,b,c){b=xu(b,"statePatch","_cloudCast","appStatus");if("string"!=typeof b)a.l.error("App status not a string: "+b);else if(a=a.b,b="available"==b,c=a.b.ha(c))c.isAvailable=b||!1,a.b.f=Date.now(),Or(a.f,[c.Ea])};var Fu=function(a,b){this.h=a;this.f=b;this.b=new Jr(this.Qp.bind(this),b,2E4);this.g=new Bu(this);Au().addListener();tj(this);Ag("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};l(Fu,qg);g=Fu.prototype;g.Wd=function(){var a=this;Dr(this.h).then(function(b){Er(a.h,b)},function(){});return this.b.Wd().filter(function(a){return a.isAvailable})};g.ha=function(a){return this.b.ha(a)};
g.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.g.onMessage.apply(this.g,Na(c));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};
g.Qp=function(){return Br(this.h,{descriptionSubstring:"Chrome Streaming Receiver"}).then(function(a){return a.map(function(a){Qb("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=a.isAvailable()&&!(a.b.invitations&&0!=a.b.invitations.length);return new Gr(a.getId(),a.f(),a.b.personalizedInfo.maxRole,"default",b)})})};g.va=function(){return"WeaveSinkDiscoveryService"};g.Ta=function(){return[{cache:Rr(this.b)}]};g.ab=function(){var a=qj(this);a&&Sr(this.b,a.cache)};
var Eu=function(a,b){if(b=a.b.ha(b.sinkId))a.b.b.delete(b.Ea.id),a.b.f=Date.now(),Pr(a.f,[b.Ea])};var Gu=Pa.JSON.parse,Hu=Pa.JSON.stringify;var Iu=function(a,b,c,d,e,f,h,k){this.b=null;this.A=!1;this.u=Wt();this.f=[];this.o=a?encodeURIComponent(String(a)):null;this.B=null;!d&&b&&(this.B=b);this.L=c||null;this.g=!d;this.j=null!=e?e:null;this.m=f||null;this.D=!!h;this.F=k||null};t(Iu,Js);var Ju;var Ku=ee("https://apis.google.com/js/client.js");Ku instanceof de&&Ku.constructor===de&&Ku.f===ce?Ju=Ku.b:(Xb("expected object of type Const, got '"+Ku+"'"),Ju="type_error:Const");var Lu=qe(Ju);
Iu.prototype.init=function(){var a=p(function(a){this.b=a;var b=Ya("auth",a);Ya("client.request",a)&&b?this.C():a.load("client",p(this.C,this))},this),b=Mu("gapi");b?a(b.gapi):Nu(this,a);return this.u.T};
var Mu=function(a){for(var b=window,c=Ya(a,b);!c&&b!=window.top&&Ou(b.parent,a);)b=b.parent,c=Ya(a,b);return c?b:null},Ou=function(a,b){try{return!!a&&null!=a.location.href&&Cd(a,b)}catch(c){return!1}},Nu=function(a,b){var c=Mu("gapi_onload");if(c){var d=c.gapi_onload;c.gapi_onload=function(){d();b(c.gapi)}}else{window.gapi_onload=function(){b(window.gapi)};var e=document.createElement("SCRIPT");Ae(e,Lu);a.F&&Ve(e,Hu(a.F));document.getElementsByTagName("head")[0].appendChild(e)}};
Iu.prototype.C=function(){for(var a=0;a<this.f.length;a++)this.f[a].mb.resolve(Pu(this,this.f[a].requestData));this.A=!0;this.u.resolve(this.b)};Iu.prototype.sendRequest=function(a){if(this.A)return Pu(this,a);var b=Wt();this.f.push({requestData:a,mb:b});return b.T};
var Pu=function(a,b){var c,d=Ya("config.get",a.b);if(!a.g){var e=d("googleapis.config/auth/useFirstPartyAuth");var f=d("googleapis.config/auth/useOriginToken")}null!=a.j&&(c=d("client/cors"));try{var h=Ya("config.update",a.b);a.g||(h("googleapis.config/auth/useFirstPartyAuth",!1),h("googleapis.config/auth/useOriginToken",!1));null!=a.j&&h("client/cors",a.j);var k=Qu(a);b.headers&&wd(k,b.headers);var n={headers:k,root:a.L,path:b.path,method:b.method,body:b.body},u=b.params||{};a.o&&!a.m?wd(u,{key:a.o}):
a.m&&wd(u,{key:null});pd(u)||(n.params=u);var z=Ot(Ya("client.request",a.b)(n));b.callback&&z.then(function(a){b.callback.apply(null,[a.result,a])},function(a){b.callback.apply(null,[a.result,a])});return z}finally{d=Ya("config.update",a.b),a.g||(d("googleapis.config/auth/useFirstPartyAuth",e),d("googleapis.config/auth/useOriginToken",f)),null!=a.j&&d("client/cors",c)}},Qu=function(a){if(a.g){if(a.m)return{Authorization:"Bearer "+a.m};var b=Ya("auth.getAuthHeaderValueForFirstParty",a.b);return{Authorization:a.D?
b([]):b(),"X-Goog-AuthUser":a.B}}return{}};var Ru=function(a){this.b=a},or=function(a,b,c){var d="";b.forEach(function(a){d+="/"+encodeURIComponent(a)});a=new jq(a+d);c&&(c=zq(c),mq(a,c));return a},pr=function(a,b,c,d){return a.b.getAuthToken().then(function(e){var f=Su(e);return Tu(f,b,c,d).catch(function(f){if("INVALID_ACCESS_ERROR"==f)return Uu(a,e,b,c,d);throw f;})})},Uu=function(a,b,c,d,e){return Cs(b).then(function(){return pr(a,c,d,e)})},Tu=function(a,b,c,d){return new Promise(function(e,f){a.sendRequest(Vu(b,c,function(a){a&&!a.error?
e(a):a&&401==a.error.code?f("INVALID_ACCESS_ERROR"):f(a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a))},d))})},Su=function(a){a=new Iu(void 0,void 0,void 0,!1,!1,a);a.init();return a},Vu=function(a,b,c,d){a={callback:c,method:b,path:a.toString()};d&&(a.body=d);return a};var Wu={bt:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},at:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Xu=Wu;Xu=Wu;var Yu={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Zu={Pj:".",Xh:",",ek:"%",di:"0",qn:"+",Yj:"-",Tj:"E",fk:"\u2030",Yh:"\u221e",ln:"NaN",Lm:"#,##0.###",Tw:"#E0",fw:"#,##0%",lt:"\u00a4#,##0.00",Qj:"USD"},$u=Zu;$u=Zu;var bv=function(){this.B=40;this.f=1;this.o=3;this.F=this.j=0;this.D=!1;this.A=this.m="";this.h=$u.Yj;this.u="";this.b=1;this.s=!1;this.g=[];this.C=this.L=!1;var a=$u.Lm;a.replace(/ /g,"\u00a0");var b=[0];this.m=av(this,a,b);for(var c=b[0],d=-1,e=0,f=0,h=0,k=-1,n=a.length,u=!0;b[0]<n&&u;b[0]++)switch(a.charAt(b[0])){case "#":0<f?h++:e++;0<=k&&0>d&&k++;break;case "0":if(0<h)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.g.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+h;break;case "E":if(this.C)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.C=!0;this.F=0;b[0]+1<n&&"+"==a.charAt(b[0]+1)&&(b[0]++,this.D=!0);for(;b[0]+1<n&&"0"==a.charAt(b[0]+1);)b[0]++,this.F++;if(1>e+f||1>this.F)throw Error('Malformed exponential pattern "'+a+'"');u=!1;break;default:b[0]--,u=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,h=e-f,e=f-1,f=1);if(0>d&&0<h||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');h=e+f+h;this.o=0<=d?h-d:0;0<=d&&(this.j=e+f-d,0>this.j&&(this.j=0));this.f=(0<=d?d:h)-e;this.C&&(this.B=e+this.f,0==this.o&&0==this.f&&(this.f=1));this.g.push(Math.max(0,k));this.L=0==d||d==h;c=b[0]-c;this.A=av(this,a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.b&&(this.s=!0),this.h=av(this,a,b),b[0]+=c,this.u=av(this,a,b)):(this.h+=this.m,this.u+=this.A)};
bv.prototype.parse=function(a,b){b=b||[0];a=a.replace(/ /g,"\u00a0");var c=a.indexOf(this.m,b[0])==b[0],d=a.indexOf(this.h,b[0])==b[0];c&&d&&(this.m.length>this.h.length?d=!1:this.m.length<this.h.length&&(c=!1));c?b[0]+=this.m.length:d&&(b[0]+=this.h.length);if(a.indexOf($u.Yh,b[0])==b[0]){b[0]+=$u.Yh.length;var e=Infinity}else{e=a;for(var f=!1,h=!1,k=!1,n=-1,u=1,z=$u.Pj,B=$u.Xh,E=$u.Tj,Q="";b[0]<e.length;b[0]++){var na=e.charAt(b[0]),ma=cv(na);if(0<=ma&&9>=ma)Q+=ma,k=!0;else if(na==z.charAt(0)){if(f||
h)break;Q+=".";f=!0}else if(na==B.charAt(0)&&("\u00a0"!=B.charAt(0)||b[0]+1<e.length&&0<=cv(e.charAt(b[0]+1)))){if(f||h)break}else if(na==E.charAt(0)){if(h)break;Q+="E";h=!0;n=b[0]}else if("+"==na||"-"==na){if(k&&n!=b[0]-1)break;Q+=na}else if(1==this.b&&na==$u.ek.charAt(0)){if(1!=u)break;u=100;if(k){b[0]++;break}}else if(1==this.b&&na==$u.fk.charAt(0)){if(1!=u)break;u=1E3;if(k){b[0]++;break}}else break}1!=this.b&&(u=this.b);e=parseFloat(Q)/u}if(c){if(a.indexOf(this.A,b[0])!=b[0])return NaN;b[0]+=
this.A.length}else if(d){if(a.indexOf(this.u,b[0])!=b[0])return NaN;b[0]+=this.u.length}return d?-e:e};
bv.prototype.format=function(a){if(isNaN(a))return $u.ln;var b=[];var c=dv;a/=Math.pow(10,c.fp);b.push(c.prefix);var d=0>a||0==a&&0>1/a;b.push(d?this.h:this.m);if(isFinite(a))if(a=a*(d?-1:1)*this.b,this.C){var e=a;if(0==e)ev(this,e,this.f,b),fv(this,0,b);else{a=Math.floor(Math.log(e)/Math.log(10)+2E-15);var f=Math.pow(10,a);isFinite(f)&&0!==f?e/=f:(f=Math.pow(10,Math.floor(a/2)),e=e/f/f,1==a%2&&(e=0<a?e/10:10*e));f=this.f;if(1<this.B&&this.B>this.f){for(;0!=a%this.B;)e*=10,a--;f=1}else 1>this.f?(a++,
e/=10):(a-=this.f-1,e*=Math.pow(10,this.f-1));ev(this,e,f,b);fv(this,a,b)}}else ev(this,a,this.f,b);else b.push($u.Yh);b.push(d?this.u:this.A);b.push(c.Ar);return b.join("")};
var ev=function(a,b,c,d){if(a.j>a.o)throw Error("Min value must be less than max value");d||(d=[]);var e=Math.pow(10,a.o);var f=Math.round(b*e);isFinite(f)?(b=Math.floor(f/e),f=Math.floor(f-b*e)):f=0;var h=e=b;b=f;var k=0<a.j||0<b||!1;e=a.j;k&&(e=a.j);var n="";for(f=h;1E20<f;)n="0"+n,f=Math.round(f/10);n=f+n;var u=$u.Pj;f=$u.di.charCodeAt(0);var z=n.length,B=0;if(0<h||0<c){for(h=z;h<c;h++)d.push(String.fromCharCode(f));if(2<=a.g.length)for(c=1;c<a.g.length;c++)B+=a.g[c];c=z-B;if(0<c){h=a.g;B=z=0;
for(var E,Q=$u.Xh,na=n.length,ma=0;ma<na;ma++)if(d.push(String.fromCharCode(f+1*Number(n.charAt(ma)))),1<na-ma)if(E=h[B],ma<c){var kb=c-ma;(1===E||0<E&&1===kb%E)&&d.push(Q)}else B<h.length&&(ma===c?B+=1:E===ma-c-z+1&&(d.push(Q),z+=E,B+=1))}else{c=n;n=a.g;h=$u.Xh;E=c.length;Q=[];for(z=n.length-1;0<=z&&0<E;z--){B=n[z];for(na=0;na<B&&0<=E-na-1;na++)Q.push(String.fromCharCode(f+1*Number(c.charAt(E-na-1))));E-=B;0<E&&Q.push(h)}d.push.apply(d,Q.reverse())}}else k||d.push(String.fromCharCode(f));(a.L||k)&&
d.push(u);k=String(b);b=k.split("e+");if(2==b.length){if(k=parseFloat(b[0])){u=k;if(isFinite(u)){for(c=0;1<=(u/=10);)c++;u=c}else u=0<u?u:0;u=0-u-1;-1>u?(u=Math.pow(10,1),k=Math.round(k/u)*u):(u=Math.pow(10,u),k=Math.round(k*u)/u)}k=String(k);k=k.replace(".","");k+=Tc("0",parseInt(b[1],10)-k.length+1)}a.o+1>k.length&&(k="1"+Tc("0",a.o-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(h=1;h<a;h++)d.push(String.fromCharCode(f+1*Number(k.charAt(h))))},fv=function(a,b,c){c.push($u.Tj);0>
b?(b=-b,c.push($u.Yj)):a.D&&c.push($u.qn);b=""+b;for(var d=$u.di,e=b.length;e<a.F;e++)c.push(d);c.push(b)},cv=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=$u.di.charCodeAt(0);return b<=a&&a<b+10?a-b:-1},av=function(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var h=b.charAt(c[0]);if("'"==h)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=h;else switch(h){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1)?
(c[0]++,d+=$u.Qj):d+=Yu[$u.Qj][1];break;case "%":if(!a.s&&1!=a.b)throw Error("Too many percent/permill");if(a.s&&100!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=100;a.s=!1;d+=$u.ek;break;case "\u2030":if(!a.s&&1!=a.b)throw Error("Too many percent/permill");if(a.s&&1E3!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=1E3;a.s=!1;d+=$u.fk;break;default:d+=h}}return d},dv={prefix:"",Ar:"",fp:0};var gv=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},hv=gv;hv=gv;var iv=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},jv=iv;jv=iv;var ov=function(){this.g=kv;this.f=this.b=this.j=null;var a=$u,b=Xu;if(lv!==a||mv!==b)lv=a,mv=b,nv=new bv;this.s=nv},lv=null,mv=null,nv=null,pv=/'([{}#].*?)'/g,qv=/''/g;ov.prototype.format=function(a){if(this.g){this.j=[];var b=rv(this,this.g);this.f=sv(this,b);this.g=null}if(this.f&&0!=this.f.length)for(this.b=x(this.j),b=[],tv(this,this.f,a,!1,b),a=b.join("");0<this.b.length;)a=a.replace(this.h(this.b),this.b.pop());else a="";return a};
var tv=function(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var h=b[f].value,k=a,n=e,u=c[h];Qa(u)?(k.b.push(u),n.push(k.h(k.b))):n.push("Undefined parameter - "+h);break;case 2:h=b[f].value;k=e;n=h.gh;Qa(c[n])?(n=h[c[n]],Qa(n)||(n=h.other),tv(a,n,c,d,k)):k.push("Undefined parameter - "+n);break;case 0:h=b[f].value;uv(a,h,c,jv,d,e);break;case 1:h=b[f].value;uv(a,h,c,hv,d,e);break;default:Xb("Unrecognized block type: "+b[f].type)}},uv=function(a,b,
c,d,e,f){var h=b.gh,k=b.Dk,n=+c[h];isNaN(n)?f.push("Undefined or invalid parameter - "+h):(k=n-k,h=b[c[h]],Qa(h)||(d=d(k),h=b[d],Qa(h)||(h=b.other)),b=[],tv(a,h,c,e,b),c=b.join(""),e?f.push(c):(a=a.s.format(k),f.push(c.replace(/#/g,a))))},rv=function(a,b){var c=a.j,d=p(a.h,a);b=b.replace(qv,function(){c.push("'");return d(c)});return b=b.replace(pv,function(a,b){c.push(b);return d(c)})},vv=function(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var h=f.index;"}"==f[0]?(c.pop(),
0==c.length&&(f={type:1},f.value=a.substring(b,h),d.push(f),b=h+1)):(0==c.length&&(b=a.substring(b,h),""!=b&&d.push({type:0,value:b}),b=h+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d},wv=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,xv=/^\s*(\w+)\s*,\s*selectordinal\s*,/,yv=/^\s*(\w+)\s*,\s*select\s*,/,sv=function(a,b){var c=[];b=vv(b);for(var d=0;d<b.length;d++){var e={};if(0==b[d].type)e.type=4,e.value=b[d].value;else if(1==b[d].type){var f=b[d].value;switch(wv.test(f)?
0:xv.test(f)?1:yv.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=zv(a,b[d].value);break;case 0:e.type=0;e.value=Av(a,b[d].value);break;case 1:e.type=1;e.value=Bv(a,b[d].value);break;case 3:e.type=3;e.value=b[d].value;break;default:Xb("Unknown block type for pattern: "+b[d].value)}}else Xb("Unknown part of the pattern.");c.push(e)}return c},zv=function(a,b){var c="";b=b.replace(yv,function(a,b){c=b;return""});var d={};d.gh=c;b=vv(b);for(var e=0;e<b.length;){var f=b[e].value;e++;if(1==
b[e].type)var h=sv(a,b[e].value);else Xb("Expected block type.");d[f.replace(/\s/g,"")]=h;e++}return d},Av=function(a,b){var c="",d=0;b=b.replace(wv,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.gh=c;e.Dk=d;b=vv(b);for(var f=0;f<b.length;){var h=b[f].value;f++;if(1==b[f].type)var k=sv(a,b[f].value);else Xb("Expected block type.");e[h.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},Bv=function(a,b){var c="";b=b.replace(xv,function(a,b){c=b;return""});var d={};d.gh=c;d.Dk=0;b=vv(b);
for(var e=0;e<b.length;){var f=b[e].value;e++;if(1==b[e].type)var h=sv(a,b[e].value);else Xb("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=h;e++}return d};ov.prototype.h=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Cv=chrome.i18n.getMessage("1522140683318860351"),Dv=chrome.i18n.getMessage("4246483347873264186"),Ev=chrome.i18n.getMessage("5991427458288444010"),Pf=chrome.i18n.getMessage("6063910461797960050"),Fv=chrome.i18n.getMessage("7735695102441495789"),Gv=chrome.i18n.getMessage("4575332923598659024"),kv=chrome.i18n.getMessage("2297080986956220930"),Hv=new ov;var Iv=function(a){this.b=a;this.l=vb("mr.cloud.mesi.MesiService")},vs=function(a){var b=er.b;.1>Math.random()&&(b=b.replace("v1","v1_preprod"));b=or(b,["hangouts","search"]);a.l.info("Retrieving Hangouts from MESI: "+b);return pr(a.b,b,"POST",Jv).then(function(a){var b=[];a.result&&(b=a.result.map(function(a){var b=a.hangout,c=b.meeting_room_name,d;b.meeting_domain?d=b.meeting_domain:"BUSINESS"==b.type&&b.company_title&&(d=b.company_title.toLowerCase());var e=Hv.format({ORGANIZER:"",PARTICIPANTS:0});
if((a=a.participant)&&0<a.length){var u=a[0].display_name;e=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(u=b.display_name);return a},new Set);e=Hv.format({ORGANIZER:u,PARTICIPANTS:e.size})}return c&&d?new gr(!1,c+"@"+d,d,c,e,b.hangout_id):new gr(!1,b.hangout_id,d,c,e,b.hangout_id)}));return b})},Jv={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var Kv=function(a,b){this.f=a;this.b=b},Nv=function(a,b,c,d){switch(b.type){case "REFRESH_AUTH":var e=d.Kc,f=d.deviceId,h=d.Oe;return Ds(a.f).then(function(){Lv(a.b,new bh("AUTH_READY",{Kc:e,Ya:f,Oe:h}),c.id)});case "LOCAL_PRESENT":return Lv(a.b,new bh("AUTH_READY",{Kc:d.Kc,Ya:d.deviceId,Oe:d.Oe,Nd:!b.data.local}),c.id),Promise.resolve();case "STATUS_REQUEST":return Lv(a.b,b,c.id),Promise.resolve();case "STATUS_RESPONSE":return Lv(a.b,b,c.id,!0),b.data.routeDescription||Lv(a.b,b,c.id),Promise.resolve();
case "HANGOUT_INACTIVE":return Mv(a.b,c,4,new Of(Fv,"warning"));case "HANGOUT_INVALID":return Mv(a.b,c,3,new Of(Gv,"warning"));default:return Promise.reject(Error("Unknown type: "+b.type))}};var Ov=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),Pv=function(a,b){pu.call(this,a,b)};l(Pv,pu);Pv.prototype.get=function(a){a=new Fs({method:"GET",rc:this.b,zc:["commands",a],gb:this.gb});return this.f.execute(a).then(function(a){return a})};Pv.prototype.list=function(a){a=new Fs({method:"GET",rc:this.b,zc:["commands"],Xl:{deviceId:a},gb:this.gb});return this.f.execute(a).then(function(a){return a.command||[]})};
Pv.prototype.send=function(a,b){a=new Fs({method:"POST",rc:this.b,zc:["commands:send"],gb:this.gb,body:{command:b,deviceId:a}});return this.f.execute(a).then(function(a){return a})};Pv.prototype.update=function(a,b){for(var c=[],d={},e=la(Ov.keys()),f=e.next();!f.done;f=e.next())f=f.value,b[f]&&(d[f]=b[f],c.push(Ov.get(f)));d.id=a;a=new Fs({method:"PUT",rc:this.b,zc:["commands",a],gb:this.gb,body:{command:d,updateMask:c}});return this.f.execute(a).then(function(a){return a})};var Qv=Pa.JSON.parse;var Rv=function(){};Rv.prototype.b=null;var Tv=function(a){var b;(b=a.b)||(b={},Sv(a)&&(b[0]=!0,b[1]=!0),b=a.b=b);return b};var Uv,Vv=function(){};t(Vv,Rv);var Wv=function(a){return(a=Sv(a))?new ActiveXObject(a):new XMLHttpRequest},Sv=function(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.f};Uv=new Vv;var Xv=function(a){Y.call(this);this.headers=new Hk;this.R=a||null;this.f=!1;this.M=this.b=null;this.ka=this.D="";this.o=0;this.g="";this.j=this.aa=this.C=this.U=!1;this.m=0;this.A=null;this.u="";this.K=this.B=!1};t(Xv,Y);Xv.prototype.l=ns("goog.net.XhrIo");var Yv=/^https?$/i,Zv=["POST","PUT"],$v=[],aw=function(a,b,c,d,e,f,h){var k=new Xv;$v.push(k);b&&k.listen("complete",b);lt(k,"ready",k.wa);f&&(k.m=Math.max(0,f));h&&(k.B=h);k.send(a,c,d,e);return k};Xv.prototype.wa=function(){this.Ra();rc($v,this)};
Xv.prototype.send=function(a,b,c,d){if(this.b)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);b=b?b.toUpperCase():"GET";this.D=a;this.g="";this.o=0;this.ka=b;this.U=!1;this.f=!0;this.b=this.R?Wv(this.R):Wv(Uv);this.M=this.R?Tv(this.R):Tv(Uv);this.b.onreadystatechange=p(this.sa,this);try{rs(this.l,bw(this,"Opening Xhr")),this.aa=!0,this.b.open(b,String(a),!0),this.aa=!1}catch(f){rs(this.l,bw(this,"Error opening Xhr: "+f.message));cw(this,f);return}a=c||"";
var e=this.headers.clone();d&&Nl(d,function(a,b){e.set(b,a)});d=hc(e.xb(),dw);c=Pa.FormData&&a instanceof Pa.FormData;!jc(Zv,b)||d||c||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(a,b){this.b.setRequestHeader(b,a)},this);this.u&&(this.b.responseType=this.u);"withCredentials"in this.b&&this.b.withCredentials!==this.B&&(this.b.withCredentials=this.B);try{ew(this),0<this.m&&(this.K=fw(this.b),rs(this.l,bw(this,"Will abort after "+this.m+"ms if incomplete, xhr2 "+
this.K)),this.K?(this.b.timeout=this.m,this.b.ontimeout=p(this.ua,this)):this.A=ku(this.ua,this.m,this)),rs(this.l,bw(this,"Sending request")),this.C=!0,this.b.send(a),this.C=!1}catch(f){rs(this.l,bw(this,"Send error: "+f.message)),cw(this,f)}};var fw=function(a){return Gd&&$d(9)&&m(a.timeout)&&Qa(a.ontimeout)},dw=function(a){return Jc("Content-Type",a)};
Xv.prototype.ua=function(){"undefined"!=typeof Oa&&this.b&&(this.g="Timed out after "+this.m+"ms, aborting",this.o=8,rs(this.l,bw(this,this.g)),this.I("timeout"),this.abort(8))};var cw=function(a,b){a.f=!1;a.b&&(a.j=!0,a.b.abort(),a.j=!1);a.g=b;a.o=5;gw(a);hw(a)},gw=function(a){a.U||(a.U=!0,a.I("complete"),a.I("error"))};Xv.prototype.abort=function(a){this.b&&this.f&&(rs(this.l,bw(this,"Aborting")),this.f=!1,this.j=!0,this.b.abort(),this.j=!1,this.o=a||7,this.I("complete"),this.I("abort"),hw(this))};
Xv.prototype.ga=function(){this.b&&(this.f&&(this.f=!1,this.j=!0,this.b.abort(),this.j=!1),hw(this,!0));Xv.ra.ga.call(this)};Xv.prototype.sa=function(){this.s||(this.aa||this.C||this.j?iw(this):this.xa())};Xv.prototype.xa=function(){iw(this)};
var iw=function(a){if(a.f&&"undefined"!=typeof Oa)if(a.M[1]&&4==jw(a)&&2==a.Ja())rs(a.l,bw(a,"Local request error detected and ignored"));else if(a.C&&4==jw(a))ku(a.sa,0,a);else if(a.I("readystatechange"),4==jw(a)){rs(a.l,bw(a,"Request complete"));a.f=!1;try{if(kw(a))a.I("complete"),a.I("success");else{a.o=6;try{var b=2<jw(a)?a.b.statusText:""}catch(c){rs(a.l,"Can not get status: "+c.message),b=""}a.g=b+" ["+a.Ja()+"]";gw(a)}}finally{hw(a)}}},hw=function(a,b){if(a.b){ew(a);var c=a.b,d=a.M[0]?Za:null;
a.b=null;a.M=null;b||a.I("ready");try{c.onreadystatechange=d}catch(e){ps(a.l,"Problem encountered resetting onreadystatechange: "+e.message)}}},ew=function(a){a.b&&a.K&&(a.b.ontimeout=null);a.A&&(lu(a.A),a.A=null)},kw=function(a){var b=a.Ja();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}if(!c){if(b=0===b)a=String(a.D).match(dq)[1]||null,!a&&Pa.self&&Pa.self.location&&(a=Pa.self.location.protocol,a=a.substr(0,a.length-1)),b=!Yv.test(a?a.toLowerCase():
"");c=b}return c},jw=function(a){return a.b?a.b.readyState:0};Xv.prototype.Ja=function(){try{return 2<jw(this)?this.b.status:-1}catch(a){return-1}};
var lw=function(a){try{return a.b?a.b.responseText:""}catch(b){return rs(a.l,"Can not get responseText: "+b.message),""}},mw=function(a){if(a.b)return Qv(a.b.responseText)},nw=function(a){try{if(!a.b)return null;if("response"in a.b)return a.b.response;switch(a.u){case "":case "text":return a.b.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.b)return a.b.mozResponseArrayBuffer}ps(a.l,"Response type "+a.u+" is not supported on this browser");return null}catch(b){return rs(a.l,"Can not get response: "+
b.message),null}};Xv.prototype.getResponseHeader=function(a){if(this.b&&4==jw(this))return a=this.b.getResponseHeader(a),null===a?void 0:a};var ow=function(a){var b={};a=(a.b&&4==jw(a)?a.b.getAllResponseHeaders()||"":"").split("\r\n");for(var c=0;c<a.length;c++)if(!Kc(a[c])){var d=$c(a[c],": ",2);b[d[0]]=b[d[0]]?b[d[0]]+(", "+d[1]):d[1]}return b},bw=function(a,b){return b+" ["+a.ka+" "+a.D+" "+a.Ja()+"]"};var pw=function(){this.l=vb("mr.cloud.CredentialService")},sw=function(a){var b=new Tb,c=fr.b+"/iceconfig?key="+fr.f;a.l.info("Requesting TURN credentials from "+c);var d=aw(c,function(){kw(d)?(a.l.info("Got TURN credentials: "+lw(d)),b.resolve(qw(a,mw(d)))):b.resolve(rw(a))},"POST",void 0,{"Content-Type":"application/json"});return b.b},qw=function(a,b){try{var c=[];b.iceServers.forEach(function(a){a.urls.forEach(function(b){0==b.indexOf("turn:")&&c.push({url:b,credential:a.credential,username:a.username})})});
return c}catch(d){return a.l.error("Error parsing TURN credentials.",d),[]}},rw=function(a){a.l.error("XHR failed fetching TURN credentials.",null);return[]};var tw=function(a,b,c){this.l=vb("mr.cloud.slarti.MessageHandler");this.h=a;this.g=b;this.b=c;this.f=new Map},uw=function(a,b,c,d){var e=d.deviceId,f=c.zb&&c.zb.tabId,h=b.data;return(null==f?Promise.resolve():new Promise(function(a){chrome.tabs.get(f,a)})).then(function(b){b={id:null,issuer:null,name:"stream",status:null,results:null,expirationTime:null,parameters:JSON.stringify({info:{title:b&&b.title||"",url:b&&b.url||""},sessionDescription:h.description,mediaConstraints:h.mediaConstraints,settings:h.settings})};
return a.h.send(e,b).then(function(b){return new Promise(function(d,e){a.f.set(b.id,{routeId:c.id,resolve:d,reject:e,Cp:"PENDING_APPROVAL"==b.status})})},function(){var b=a.b,d=Rf(new Of(Cv,"warning"));d.routeId=c.id;b.b.xd(d);Lv(a.b,new bh("STOP"),c.id)})})},vw=function(a,b){return sw(a.g).then(function(c){Lv(a.b,new bh("TURN_CREDENTIALS",{credentials:c}),b.id)})};var ww=function(a,b,c,d){this.f=a;this.h=b;this.g=c;this.b=d},zw=function(a,b,c,d,e){return new Promise(function(f){switch(b){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+b);}if(!c.type)throw Error("Message has no type");switch(c.type){case "STOP":f(Mv(a.b,d,1,null));return;case "SESSION_START_SUCCESS":Yq(0);break;case "SESSION_END":break;case "SESSION_FAILURE":Yq(1);f(Mv(a.b,d,2,new Of(Cv,"warning")));return;case "__webrtc_stats__":break;case "PRESENTATION_CONNECTION_MESSAGE":Lv(a.b,
c.data,d.id,!0);break;case "OFFER":switch(b){case "slarti":f(uw(a.f,c,d,e));return;case "weave":f(xw(a.h,c,d,e));return;default:throw Error("Unexpected channel type: "+b);}case "GET_TURN_CREDENTIALS":switch(b){case "slarti":f(vw(a.f,d));return;case "weave":f(yw(a.h,d));return;default:throw Error("Unexpected channel type: "+b);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(Nv(a.g,c,d,e));return;case "new_session":Lv(a.b,
c,d.id,!0);break;case "remove_session":Lv(a.b,c,d.id,!0);a.b.terminateRoute(d.id);break;default:throw Error("Unknown type: "+c.type);}f()})};var Aw=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},Bw=function(a){this.b=a},Ew=function(a,b,c,d){return Cw(a,xr,b,c,d,35E3).then(function(b){return Dw(a,b)})},Gw=function(a,b,c,d){return Cw(a,yr,b,c,d,23E3).then(function(a){var b=a.state;return"done"==b?(a=Fw(a),new Aw(b,a.type,new ur(a.sessionDescription))):new Aw(b)})},Cw=function(a,b,c,d,e,f){var h={_webrtcMessage:JSON.stringify(d.presentationUrl?new ur(d.description,null,d.presentationUrl,d.presentationId):
new ur(d.description))};d.settings&&(h._settings=Zg(d.settings));d.mediaConstraints&&(h._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(h._user=JSON.stringify(e));return Hw(a,c,b,h,f)},Dw=function(a,b){var c=b.state;switch(c){case "done":return Promise.resolve(Iw(b));case "queued":case "inProgress":return Jw(a,b).then(function(b){return Dw(a,b)});default:return Promise.resolve(new Aw(c))}},Jw=function(a,b){return new Promise(function(c){var d=setInterval(function(){Kw(a,b.id).then(function(a){"queued"!=
a.state&&"inProgress"!=a.state&&(clearInterval(d),c(a))})},2E3)})},Iw=function(a){a=Fw(a);return"__cloud_webrtc_session_message__"==a.type?new Aw("done","knocking_cloud_webrtc_session_message",new ur(a.sessionDescription)):new Aw("done",a.type)},Hw=function(a,b,c,d,e){b={deviceId:b,name:"_cloudCast."+c.name,parameters:d,expirationTimeoutMs:e||1E4};c={};e&&(c.responseAwaitMs=Math.min(e+5E3,25E3));e=or(br.b,["commands"],c);return pr(a.b,e,"POST",b)},Fw=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Kw=function(a,b){b=or(br.b,["commands",b]);return pr(a.b,b,"GET")};Bw.$inject=["gapiService"];var Lw=function(a,b,c,d){this.f=a;this.h=b;this.g=c;this.b=d},xw=function(a,b,c,d){return Mw(a,b,d).then(function(b){a:{var d=c.id;if("done"!=b.state)d=Promise.reject(Error("Offer not executed by receiver. State: "+b.state));else{switch(b.type){case "__cloud_webrtc_session_message__":b=new bh("ANSWER",b.results.sessionDescription);Lv(a.b,b,d);break;case "knocking_cloud_webrtc_session_message":Xq(0);b=new bh("KNOCK_ANSWER",b.results.sessionDescription);Lv(a.b,b,d);break;case "knock_denied":Xq(1);Nw(a,
Dv,d);break;case "knock_timeout":Xq(2);Nw(a,Ev,d);break;default:d=Promise.reject(Error("Invalid message type: "+b.type));break a}d=Promise.resolve()}}return d})},yw=function(a,b){return sw(a.g).then(function(c){Lv(a.b,new bh("TURN_CREDENTIALS",{credentials:c}),b.id)})},Mw=function(a,b,c){var d=c.deviceId,e=a.h.b;e=e?new sr(e):void 0;b=b.data;switch(c.ki){case "owner":$q(0);break;case "manager":$q(1);break;case "user":$q(2);break;case "viewer":$q(3)}return"viewer"==c.ki?Ew(a.f,d,b,e):Gw(a.f,d,b,e)},
Nw=function(a,b,c){b=new Of(b,"warning");Rf(b);a.b.b.xd(b);Lv(a.b,new bh("STOP"),c)};var Ow=function(){var a=this;this.l=vb("mr.cloud.settings.SettingsService");this.b=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){Dg(13);if(a.b){b=la(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.b.call(null,c.value);break}}})},Pw=function(a,b){a.b=b},Qw=function(a){var b=a.l;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&v(b,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
Sw=function(a){return Rw().catch(function(){return Rw().catch(function(b){v(a.l,"Error retrieving cloud on setting.",b);return!1})})},Rw=function(){return Tw("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},Tw=function(a){return new Promise(function(b,c){chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})},Vw=function(a){return Uw().catch(function(){return Uw().catch(function(b){v(a.l,"Error retrieving cloud enabled setting.",
b);return!1})})},Uw=function(){return Ww().then(function(a){return!!a.value})},Ww=function(){return new Promise(function(a,b){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(c){chrome.runtime.lastError?b(chrome.runtime.lastError):a(c)})})},Xw=function(a){var b=a.l;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&v(b,"Error setting notified Hangout privacy.",chrome.runtime.lastError)})},Zw=function(a){return Yw().catch(function(){return Yw().catch(function(b){v(a.l,
"Error retrieving hangouts notified setting.",b);return!1})})},Yw=function(){return Tw("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var $w=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),ax=function(a,b){pu.call(this,a,b)};l(ax,pu);g=ax.prototype;g.act=function(a,b){a=new Fs({method:"POST",rc:this.b,zc:["devices:act"],gb:this.gb,body:{gcmId:b,id:a}});return this.f.execute(a).then(function(a){return a})};g.create=function(a){a=new Fs({method:"POST",rc:this.b,zc:["devices"],gb:this.gb,body:a});return this.f.execute(a).then(function(a){return a})};
g.delete=function(a){a=new Fs({method:"DELETE",rc:this.b,zc:["devices",a],gb:this.gb});return this.f.execute(a)};g.get=function(a){a=new Fs({method:"GET",rc:this.b,zc:["devices",a],gb:this.gb});return this.f.execute(a).then(function(a){return a})};g.list=function(a){var b=a.type,c=a.status;a=a.permission;var d={};b&&(d.type=b);c&&(d.status=c);a&&(d.permission=a);b=new Fs({method:"GET",rc:this.b,zc:["devices"],Xl:d,gb:this.gb});return this.f.execute(b).then(function(a){return a.device||[]})};
g.update=function(a,b){for(var c=[],d={},e=la($w.keys()),f=e.next();!f.done;f=e.next())f=f.value,b[f]&&(d[f]=b[f],c.push($w.get(f)));d.id=a;a=new Fs({method:"PUT",rc:this.b,zc:["devices",a],gb:this.gb,body:{device:d,updateMask:c}});return this.f.execute(a).then(function(a){return a})};var bx=function(a,b,c,d,e,f){f=void 0===f?null:f;this.l=vb("mr.cloud.slarti.SinkDiscoveryService");this.s=a;this.h=b;this.f=c;this.j=d;this.g=e;this.b=f||new Jr(this.m.bind(this),c,36E5);wu().addListener();tj(this);Ag("mr.cloud.slarti.SinkDiscoveryService",this)};l(bx,qg);bx.prototype.Wd=function(){tu(this.g).catch(function(){});return this.b.Wd().filter(function(a){return a.isAvailable})};bx.prototype.ha=function(a){return this.b.ha(a)};
bx.prototype.handleEvent=function(a,b){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");cx(this,b)};
var cx=function(a,b){b=JSON.parse(b.data.data);Cb(a.l,"Got notification: "+JSON.stringify(b));switch(b.type){case "DEVICE_ADDED":dx(a,b).then(function(b){"cast-receiver"==b.type&&(b=new Ir(b.id,b.displayName,"ONLINE"==b.status),a.b.b.set(b.Ea.id,b),Nr(a.f,[b.Ea]))});break;case "DEVICE_CHANGED":dx(a,b).then(function(b){if("cast-receiver"==b.type){var c=Oj(Nj(),b.id);if(c=a.b.ha(c))c.displayName=b.displayName,c.isAvailable="ONLINE"==b.status,Or(a.f,[c.Ea])}});break;case "DEVICE_REMOVED":ex(a,fx(b));
Promise.resolve();break;case "COMMAND_CHANGED":gx(a,b).then(function(b){var c=a.j,e=b.id,f=c.f.get(e);if(f){var h=f.routeId,k=f.resolve,n=f.reject,u=f.Cp;f=!0;try{var z=JSON.parse(b.results||"{}"),B=z.sessionDescription,E=z.errorCode,Q=z.errorText;switch(b.status){case "SUCCESS":k(Lv(c.b,new bh("ANSWER",B),h));u&&Xq(0);break;case "ERROR":case "TIMEOUT":var na="TIMEOUT"==b.status;k=Cv;"KNOCK_DENIED"==E&&(Xq(na?2:1),k=na?Ev:Dv);var ma=c.b,kb=Rf(new Of(k,"warning"));kb.routeId=h;ma.b.xd(kb);Lv(c.b,new bh("STOP"),
h);throw Error("Slarti command "+e+" failed with status: "+(b.status+", errorCode: "+E+", ")+("errorText: "+Q));default:f=!1}}catch(Ua){n(Ua)}f&&c.f.delete(e)}else v(c.l,"Received update to unknown command with "+("name = "+b.name+" and id = "+e))});break;default:Promise.resolve()}};bx.prototype.m=function(){return this.h.list({type:"cast-receiver"}).then(function(a){return a.map(function(a){return new Ir(a.id,a.displayName,"ONLINE"==a.status)})})};bx.prototype.va=function(){return"SlartiSinkDiscoveryService"};
bx.prototype.Ta=function(){return[{cache:Rr(this.b)}]};bx.prototype.ab=function(){var a=qj(this);a&&Sr(this.b,a.cache)};var ex=function(a,b){b=Oj(Nj(),b);var c=a.b.ha(b);c&&(a.b.b.delete(b),Pr(a.f,[c.Ea]))},fx=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},dx=function(a,b){b=b.deviceInfo;return b.device?Promise.resolve(b.device):a.h.get(b.deviceId)},gx=function(a,b){b=b.commandInfo;return b.command?Promise.resolve(b.command):a.s.get(b.commandId)};var hx=function(){this.b=null},ix=function(a,b){if(!a.b||O(a.b,2)<O(b,2))a.b=Ui(b)},jx=function(a){return a.b?O(a.b,2)+";"+O(a.b,1):null};var kx=function(){this.s=this.L=this.F=this.B=this.A=this.h=this.u=this.g=this.f=this.j=this.aa=this.U=this.K=this.C=this.M=this.R=this.la=this.D=this.m=this.o=this.b=null},lx=function(){var a=kx.Ia();null==a.s&&(a.s=new hx);return a.s},mx=function(a){null==a.b&&(a.b=new As);return a.b},nx=function(a){null==a.o&&(a.o=new Ru(mx(a)));return a.o},ox=function(a){null==a.m&&(a.m=new nu(mx(a)));return a.m},px=function(a){null==a.D&&(a.D=new Pv(mx(a),ox(a)));return a.D},rx=function(a,b){null==a.C&&(a.C=
new tw(px(a),qx(a),b));return a.C},sx=function(a){null==a.u&&(a.u=new Bw(nx(a)));return a.u},qx=function(a){null==a.L&&(a.L=new pw(nx(a)));return a.L};$a(kx);var wx=function(a,b){this.g=a;this.m=b;this.s=new Tb;this.f=this.s.b;this.b=tx(a.id);this.h=new Tb;this.j=!1;ux(this);vx(this);this.b.sendMessage(new bh("GET_TURN_CREDENTIALS"))};wx.prototype.start=function(){var a=this;return this.f.then(function(b){if(b.f)return Promise.reject(Error("Presentation already started"));b.start();return a.h.b})};wx.prototype.stop=function(){var a=this;this.j=!1;return this.f.then(function(b){b.stop();a.f=Promise.reject(Error("Peer connection has already been stopped"))})};
var ux=function(a){a.b.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.s.resolve(new gh(a.g.id,b.data.credentials));break;case "ANSWER":a.f.then(function(a){oh(a,b.data)});break;case "STOP":a.h.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.f.then(function(a){var c={type:"PRESENTATION_CONNECTION_MESSAGE",data:b};"string"==typeof c?a.j.send(c):a.j.send(JSON.stringify(c))})}},vx=function(a){a.f.then(function(b){kh(b,
function(b){a.b.sendMessage(new bh("OFFER",new dh(b,null,null,a.m,a.g.id)))});lh(b,function(b){b=ch(b);"STOP"==b.type&&a.stop();a.b.sendMessage(b)});hh(b,function(){a.j=!0;a.b.sendMessage(new bh("SESSION_START_SUCCESS"));a.h.resolve(a.g)});jh(b,function(){a.b.sendMessage(new bh("SESSION_END"))});ih(b,function(b){a.j||a.h.reject(b);a.b.sendMessage(new bh("SESSION_FAILURE"))})})};var xx=function(a){this.b=a;this.f=new Map;this.F=new Map;this.C=new Map;this.o=[];this.j=this.D=this.A=this.L=this.s=null;this.m=this.g=this.h=!1;this.B=new Map;this.u=new Map;tj(this)};xx.prototype.getName=function(){return"cloud"};
xx.prototype.Za=function(){var a=this;this.l.info("Initializing Cloud MRP");var b=kx.Ia();null==b.aa&&(null==b.U&&(b.U=new Ar(nx(b))),b.aa=new Fu(b.U,this));this.o.push(b.aa);if(null==b.M){var c=px(b);null==b.la&&(b.la=new ax(mx(b),ox(b)));var d=b.la,e=rx(b,this);null==b.K&&(null==b.R&&(b.R=new qu(mx(b),ox(b))),b.K=new ru(b.R));b.M=new bx(c,d,this,e,b.K)}this.o.push(b.M);null==b.g&&(null==b.f&&(b.f=new hr(nx(b),mx(b))),c=b.f,null==b.j&&(b.j=new Iv(nx(b))),b.g=new us(c,b.j,this));this.s=b.g;this.o.push(this.s);
this.L=sx(b);rx(b,this);this.A=mx(b);null==b.B&&(c=rx(b,this),null==b.h&&(b.h=new Lw(sx(b),mx(b),qx(b),this)),d=b.h,null==b.A&&(b.A=new Kv(mx(b),this)),b.B=new ww(c,d,b.A,this));this.D=b.B;null==b.F&&(b.F=new Ow);this.j=b.F;Vw(this.j).then(function(b){a.h=b;a.l.info("Cloud enabled setting: "+a.h)});Sw(this.j).then(function(b){a.g=b;a.l.info("Cloud on setting: "+a.g)});Pw(this.j,function(b){a.h=b;a.l.info("Cloud enabled setting: "+a.h);a.h&&yx(a)});Zw(this.j).then(function(b){a.m=b;a.l.info("Privacy notified setting: "+
a.m)})};xx.prototype.sd=function(){return Array.from(this.f.values())};
xx.prototype.kg=function(a){if(!zx(this,a))return Mo;Cb(this.l,"GetAvailableSinks for "+a);var b=[];if(this.g||Ax())b=yx(this);this.u.clear();for(var c={},d=la(this.B.values()),e=d.next();!e.done;c={Mf:c.Mf,sh:c.sh},e=d.next())c.Mf=e.value,c.sh=!1,b.forEach(function(a){return function(b){b.Ea.id==a.Mf.Ea.id&&(a.sh=!0,b.Ea.friendlyName=a.Mf.Ea.friendlyName)}}(c)),c.sh||this.u.set(c.Mf.Ea.id,c.Mf);b=b.concat.apply(b,Na(this.u.values()));Cb(this.l,function(){return"Available sinks are..."+JSON.stringify(b)});
c=b.map(function(a){return a.Ea});this.s&&(c=c.concat(Bx));return new Lo(c,-1!=a.indexOf("0F5096E8")?Ig:null)};var yx=function(a){var b=[];a.l.info("Checking cloud discovery services");Nj().g=q();a.o.forEach(function(a){a=a.Wd();b=b.concat(a)});return b};g=xx.prototype;g.startObservingMediaSinks=function(){};g.stopObservingMediaSinks=function(){};g.startObservingMediaRoutes=function(){};g.stopObservingMediaRoutes=function(){};g.ha=function(a){return(a=Cx(this,a))?a.Ea:null};
g.createRoute=function(a,b,c,d,e,f,h){var k=this;this.l.info("createRoute called");Cb(this.l,"urn: "+a+" sinkId:"+b);if(e=this.F.get(b))return Tf(this.b.xl(this,e,a,c,function(b){b.mediaSource=a;b.zb.tabId=h;return Uf(b)}),function(a){k.b.Ke(a);return a});e=Cx(this,b);return Dx(this,a,e,b,c,d,h)};
var Ex=function(a,b,c,d,e){b instanceof Ko&&2==b.errorCode?Mv(a,c,6,null):(a.l.error("Error on start session",b instanceof Error?b:Error("Expected an Error value, got "+b)),a.f.has(c.id)&&Mv(a,c,e,new Of(Cv,"warning")));if(b=a.s)b=a.s,b.f.delete(d.deviceId)?(b.b.b.delete(d.Ea.id),b=!0):b=!1;b&&Pr(a,[d.Ea])},Dx=function(a,b,c,d,e,f,h){if(f)return Vf(Error("not supported"));f=!1;switch(c.b){case "slarti":case "weave":Zq(1);break;case "mesi":f=!0;if(!a.m){a.m=!0;Xw(a.j);var k=Qf();a.b.xd(k)}Zq(0)}Nj().h=
new Kj(c.model,null);var n=Mn(e,a.getName(),d,b,!0,"");f&&(n.customControllerPath="cloud_route_details/view.html?routeId="+n.id,n.controllerType=mojo.RouteControllerType&&mojo.RouteControllerType.kHangouts);a.f.set(n.id,n);a.F.set(d,n);a.B.set(n.id,c);a.C.set(n.id,c.b);a.b.Ff(a,n);a.b.Jf(a.va(),!0);if(Hg(b)&&!f)return a.l.info("starting presentation on route: "+n.id),Fx(n,b).catch(function(b){Ex(a,b,n,c,7);throw b;});a.l.info("starting mirroring on route: "+n.id);n.zb={tabId:h,sessionId:"",Jg:"",
Te:c.model};Hg(b)&&(n.isOffscreenPresentation=!0);return a.b.Vi(a,n,e).catch(function(b){Ex(a,b,n,c,5);throw b;})};xx.prototype.terminateRoute=function(a){var b=this.f.get(a);return b?Mv(this,b,0,null):Promise.reject(new Ko(3,"Route in cloud provider not found for routeId "+a))};
var Mv=function(a,b,c,d){a.l.info("terminating route: "+b.id);a.f.delete(b.id);a.F.delete(b.sinkId);var e=a.B.get(b.id);a.B.delete(b.id);d&&a.b.xd(d);Rb("MediaRouter.Cloud.Session.End",c,Uq);switch(c){case 1:break;default:switch(e.b){case "weave":Hw(a.L,e.deviceId,zr,{})}}a.b.ug(b);0==a.f.size&&a.b.Jf(a.va(),!1);a.b.onPresentationConnectionStateChanged(b.id,"terminated");a.u.has(b.sinkId)&&(c=a.u.get(b.sinkId),Pr(a,[c.Ea]),a.u.delete(b.sinkId));return Promise.resolve()};g=xx.prototype;
g.sendRouteMessage=function(a,b){var c=this.C.get(a);if(c){var d=(a=this.f.get(a)||void 0)?Cx(this,a.sinkId):void 0;return zw(this.D,c,b,a,d)}return Ra(b)?(Lv(this,b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};g.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
g.tf=function(a){var b=new $g;5>b.minFrameRate&&(b.minFrameRate=5);var c=this.De(a);"hangouts"!=c&&"meetings"!=c&&(b.senderSideLetterboxing=!0);ah(b);Object.freeze(b);this.l.info("Settings for "+a+": "+Zg(b));if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return b};g.De=function(a){var b=null;a=Cx(this,a);switch(a.b){case "slarti":case "weave":b="webrtc";break;case "mesi":b=a.Kc?"meetings":"hangouts"}return b};g.Ih=function(){};
g.eg=function(a,b){Cb(this.l,"Checking canRoute: "+a+" for sinkId: "+b);return zx(this,a)&&!!this.ha(b)};g.cf=function(a,b){return("https://hangouts.google.com/cloudmrp-mirroring"==a||Hg(a))&&this.f.has(b)};g.joinRoute=function(a,b){return(a=this.f.get(b))?(this.l.info("joining route: "+a.id),Uf(a)):Vf(Error("not supported"))};g.connectRouteByRouteId=function(){return Vf(Error("not supported"))};g.detachRoute=function(){};
var Nr=function(a,b){a.l.info(b.length+" sinks added");0<b.length&&!a.g&&(Qw(a.j),a.g=!0);b=Cx(a,b[0].id);Nj().f=new Kj(b.model,null);a.b.Wc();a.b.onSinkAvailabilityUpdated(a,2);a.l.info("sinkAvailability changed to AVAILABLE")},Pr=function(a,b){a.l.info(b.length+" sinks removed");a.o.some(function(a){return 0<a.Wd().length})||(a.b.onSinkAvailabilityUpdated(a,0),a.l.info("sinkAvailability changed to UNAVAILABLE"));a.b.Wc()},Or=function(a,b){a.l.info(b.length+" sinks updated");a.b.Wc()},Lv=function(a,
b,c,d){(void 0===d?0:d)?a.b.Vd(c,b):a.b.Hh(c,b)},Cx=function(a,b){var c=Gx(a,b);c||(c=null,(b=a.F.get(b))&&(c=a.B.get(b.id)));return c},Gx=function(a,b){var c=null;a.o.some(function(a){c=a.ha(b);return!!c});return c},Ax=function(){var a=Nj().g;return 3E5<=Date.now()-a},zx=function(a,b){var c=Gg(b);b=Hg(b);if(a.A.h&&!a.A.f&&c)return a.b.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.h&&a.A.f&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.A,e=!(a.h||a.f&&a.b&&(-1!=Es.indexOf(a.b)||-1!=Es.indexOf(Bs(a))))&&
b;return e?!1:d&&(c||b)};xx.prototype.searchSinks=function(a,b){var c=this;if(!zx(this,a))return Promise.reject(Error("err"));a=xs(this.s,b);a.then(function(a){Nr(c,[a])});return a};var Hx=function(a,b){b=a.f.get(b);if(!b)return Promise.reject(Error("Route not found"));a=a.De(b.sinkId);return"hangouts"!=a&&"meetings"!=a?Promise.reject(Error("Unsupported sink channel type")):Rq(rg.get("mr.ProviderManager")||null,a)};g=xx.prototype;
g.createMediaRouteController=function(a,b,c){return Hx(this,a).then(function(d){return d.createMediaRouteController(a,b,c)})};g.provideSinks=function(){};g.va=function(){return"CloudProvider"};g.Ta=function(){return[void 0,{cloudEnabled:this.h,cloudOn:this.g,notifiedHangoutsPrivacy:this.m}]};g.ab=function(){var a=rj(this);a&&(a.cloudEnabled&&(this.h=a.cloudEnabled),a.cloudOn&&(this.g=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.m=a.notifiedHangoutsPrivacy))};var Fx=function(a,b){a=new wx(a,b);return Wf(a.start())};
xx.prototype.l=vb("mr.CloudProvider");var Bx=new mj("pseudo:cloud","","meeting","","default");var Ix=function(){lk.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};l(Ix,lk);Ix.prototype.Ng=function(a,b){return b.id&&-1!=Jx.indexOf(b.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};Ix.prototype.vi=function(){return!0};var Lx=function(){Kx||(Kx=new Ix);return Kx},Kx=null,Jx=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var Mx=function(){lk.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};l(Mx,lk);Mx.prototype.Ng=function(a,b){return"retrieve_log_data"==a.type&&b.id==chrome.runtime.id&&b.url=="chrome-extension://"+b.id+"/feedback.html"};Mx.prototype.vi=function(){return!0};var Ox=function(){Nx||(Nx=new Mx);return Nx},Nx=null;function Px(){var a=Qx;var b=new No(a);var c=new Xp(a,b);b=[b,c];b.push(new xx(a));return b};var Rx=function(a,b){this.routeId=a;this.message=b},Sx=function(a){return"string"!=typeof a.message};var Tx=function(a){this.A=a;this.g=this.j=null},Ux=function(a){if(null==a.g)if(null==a.j||Date.now()-a.j>=a.A)a.s();else{var b=Math.max(a.j+a.A-Date.now(),5);a.g=setTimeout(a.s.bind(a),b)}};Tx.prototype.s=function(){null!=this.g&&(clearTimeout(this.g),this.g=null);this.u();this.j=Date.now()};Tx.prototype.u=function(){};var Vx=function(a,b){Tx.call(this,20);this.b=new Map;this.f=new Set;this.o=null;this.m=this.h=0;this.B=!1;this.C=a;this.F=b;this.l=vb("mr.RouteMessageSender")};l(Vx,Tx);Vx.prototype.init=function(a){this.o=a;tj(this)};Vx.prototype.stopListeningForRouteMessages=function(a){this.f.delete(a)};
Vx.prototype.send=function(a,b){var c=this.b.get(a);c||(c=[],this.b.set(a,c));b=new Rx(a,b);c.push(b);50<c.length&&1==c.length%50&&v(this.l,function(){return"Message queue length is excessively large "+("("+c.length+") for route "+a)});this.h+=Sx(b)?0:b.message.length;Sx(b)&&this.m++;Wx(this);this.f.has(a)&&Ux(this)};
var Xx=function(a,b){if(0!=b.length){b=la(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.h-=Sx(c)?0:c.message.length,Sx(c)&&a.m--}},Wx=function(a){var b=0<a.m||a.h>a.F;b!=a.B&&(a.B=b,a.C.Jf(a.va(),b))};Vx.prototype.u=function(){if(this.o){for(var a=la(this.f),b=a.next();!b.done;b=a.next()){b=b.value;var c=this.b.get(b);c&&0!=c.length&&(this.o(b,c),Xx(this,c),this.b.set(b,[]))}Wx(this)}else this.l.error("sendMessagesCallback not set. Messages not delivered.")};Vx.prototype.va=function(){return"mr.RouteMessageSender"};
Vx.prototype.Ta=function(){var a=[].concat(Na(this.b.entries())).map(function(a){return[a[0],a[1].map(function(a){return a.message})]});return[new Yx(a,Array.from(this.f),this.h)]};Vx.prototype.ab=function(){var a=qj(this);if(a){this.b=new Map;for(var b={},c=la(a.f),d=c.next();!d.done;b={routeId:b.routeId},d=c.next())d=d.value,b.routeId=d[0],d=d[1].map(function(a){return function(b){return new Rx(a.routeId,b)}}(b)),this.b.set(b.routeId,d);this.f=new Set(a.b);this.h=a.h}};
var Yx=function(a,b,c){this.f=a;this.b=b;this.h=c};var Zx=function(a,b){this.type="internal_message";this.routeId=a;this.message=b};var $x=function(a,b,c){this.b=a;this.g=b;this.h=c;this.onMessage=function(){};c.listen("internal_message",this.f,this)};$x.prototype.sendMessage=function(a,b){return this.g(this.b,a,b)};$x.prototype.f=function(a){if(a.routeId==this.b)this.onMessage(a.message)};$x.prototype.Ra=function(){this.onMessage=function(){};gp(this.h,this.f,this)};
var ay=new $x("",function(){return Promise.resolve()},new fp),by=function(a){this.b=a},tx=function(a){var b=Mf,c=b.b.Ci(a);return c?new $x(a,c.sendRouteMessage.bind(c),b.b.Ei()):ay};var cy=function(a,b){this.s=null!=b?a.bind(b):a;this.j=this.m.bind(this);this.g=[];this.b=!1;this.f=null};cy.prototype.h=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];this.g=[].concat(Na(b));null==this.f?dy(this):this.b=!0};var dy=function(a){a.f=setTimeout(a.j,500);a.s.apply(a,Na(a.g))};cy.prototype.m=function(){this.f=null;this.b&&(this.b=!1,dy(this))};var ey=function(){this.l=vb("mr.ProviderManager");this.h=[];this.b=new Map;this.m=new Map;this.j=new Set;this.g=new Set;this.A=new Map;this.f=this.u=null;this.la=new fp;this.K=new cy(this.lm,this);this.U=new cy(this.D,this);this.s=new Vx(this,524288);this.L=0;this.o=new Map;this.C=-1==window.navigator.userAgent.indexOf("Windows");this.F=[];this.B=[];var a=new Mq(this);this.R=a.onMessage.bind(a);a=new Dq(this);this.M=a.onMessage.bind(a);this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=
this.createRoute;this.joinRoute=this.joinRoute;this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;
this.startObservingMediaRoutes=this.startObservingMediaRoutes;this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.enableMdnsDiscovery=this.enableMdnsDiscovery;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};l(ey,qg);
ey.prototype.handleEvent=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.R.apply(this,Na(c));else if(a==chrome.runtime.onMessageExternal)this.M.apply(this,Na(c));else throw Error("Unhandled event");};
var Rq=function(a,b){b=a.A.get(b);return ug(b).then(function(b){b.Za(a);return b})},fy=function(a,b,c){b.forEach(function(b){if(Qq(a,b.getName()))v(a.l,"Provider "+b.getName()+" already registered.");else try{b.Za(c),a.h.push(b),a.o.set(b.getName(),0)}catch(e){v(a.l,"Provider "+b.getName()+" failed to initialize.",e)}})};
ey.prototype.Za=function(a,b,c){this.A.set("webrtc","mr.mirror.webrtc.WebRtcService");this.A.set("cast_streaming","mr.mirror.cast.Service");this.A.set("hangouts","mr.mirror.hangouts.HangoutsService");this.A.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new by(this);Mf||(Mf=d);this.f=a;this.s.init(this.f.onRouteMessagesReceived.bind(this.f));fy(this,b,c);tj(this);Ag("mr.ProviderManager",this)};
var hy=function(a,b,c){return new Promise(function(d,e){var f=null;a.L++;gy(a);f=window.setTimeout(function(){f=null;b.cancel(new Ko(2,"timeout after "+c+" ms."))},c);b.b.then(function(b){a.L--;gy(a);null!=f&&window.clearTimeout(f);d(b)},function(b){a.L--;gy(a);null!=f&&window.clearTimeout(f);e(b instanceof Ko?b:b instanceof Error?new Ko(0,b.message,b.stack):new Ko(0))})})};ey.prototype.onBeforeInvokeHandler=function(){Dg(0)};
var iy=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};g=ey.prototype;
g.createRoute=function(a,b,c,d,e,f,h){var k=this;h=void 0===h?!1:h;var n=jy(this,a,b);if(!n)return Promise.reject(new Ko(7,"No provider supports createRoute with source: "+a+" and sink: "+b));var u=void 0;void 0!==d&&(u=iy(d));f=f&&0<f?f:6E4;a=n.createRoute(a,b,c,h,f,u,e);return hy(this,a,f).then(function(a){return a},function(a){k.l.error("Error creating route.",a);throw a;})};
g.connectRouteByRouteId=function(a,b,c,d,e,f){var h=this.b.get(b);if(!h)return Promise.reject(new Ko(7,"No provider supports join "+b));a=h.connectRouteByRouteId(a,b,c,iy(d),e);return hy(this,a,f&&0<f?f:3E4)};g.joinRoute=function(a,b,c,d,e,f){f=void 0===f?!1:f;var h=ky(this,a,b);if(!h)return Promise.reject(new Ko(7,"No provider supports join "+b));e=e&&0<e?e:3E4;a=h.joinRoute(a,b,f,e,iy(c),d);return hy(this,a,e)};
g.terminateRoute=function(a){var b=this.b.get(a);return b?ly(this,a).then(function(){return b.terminateRoute(a)}):Promise.reject(new Ko(3,"Route not found for routeId "+a))};g.startObservingMediaSinks=function(a){this.j.has(a)||(this.j.add(a),this.h.forEach(function(b){b.startObservingMediaSinks(a)}));my(this,a)};g.stopObservingMediaSinks=function(a){this.j.delete(a)?ny(this,a):this.l.info("No existing query "+a)};
var ny=function(a,b){a.h.forEach(function(a){a.stopObservingMediaSinks(b)})},my=function(a,b){if("urn:x-org.chromium.media:source:tab:-1"==b)v(a.l,"No sinks for sourceUrn: "+b);else{var c=new Map,d=[];a.h.forEach(function(e){var f=e.kg(b);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(b){c.has(b.id)?v(a.l,"Detected duplicate sink "+b.id+" from provider: "+e.getName()):c.set(b.id,b)})});oy(a,b,Array.from(c.values()),d||[])}},oy=function(a,b,c,d){a.l.info("Sending "+c.length+" sinks to MR for "+
b);a.f.onSinksReceived(b,c,d.map(Hm))};g=ey.prototype;g.sendRouteMessage=function(a,b,c){var d=this.b.get(a);d?(a=d.sendRouteMessage(a,b,c),a=hy(this,Wf(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};g.sendRouteBinaryMessage=function(a,b){var c=this.b.get(a);c?(a=c.sendRouteBinaryMessage(a,b),a=hy(this,Wf(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
g.startListeningForRouteMessages=function(a){var b=this.s;b.f.has(a)||(b.f.add(a),(a=b.b.get(a))&&0<a.length&&Ux(b))};g.stopListeningForRouteMessages=function(a){this.s.stopListeningForRouteMessages(a)};g.detachRoute=function(a){var b=this.b.get(a);b?b.detachRoute(a):this.l.info("Route "+a+" does not exist.")};g.enableMdnsDiscovery=function(){this.C=!0;this.F.forEach(function(a){a()});this.F.length=0};
var jy=function(a,b,c){return a.h.find(function(a){return a.eg(b,c)})||null},ky=function(a,b,c){return a.h.find(function(a){return a.cf(b,c)})||null};ey.prototype.D=function(){var a=this;this.j.forEach(function(b){my(a,b)})};var gy=function(a){a.f.setKeepAlive(0<a.L||0<a.B.length)};g=ey.prototype;g.startObservingMediaRoutes=function(a){this.g.has(a)||(this.g.add(a),this.h.forEach(function(b){b.startObservingMediaRoutes(a)}));this.K.h()};
g.stopObservingMediaRoutes=function(a){this.g.delete(a)?this.h.forEach(function(b){b.stopObservingMediaRoutes(a)}):this.l.info("No existing route query "+a)};g.lm=function(){var a=this;if(0!=this.g.size){var b=[];this.h.forEach(function(a){b=b.concat(a.sd())});this.g.forEach(function(c){var d=[];a.h.forEach(function(a){a.sd().forEach(function(b){!b.gf&&a.cf(c,void 0,b)&&d.push(b.id)})});a.f.onRoutesUpdated(b,c,d)})}};g.va=function(){return"ProviderManager"};
g.Ta=function(){return[new py(this.h.map(function(a){return a.getName()}),Array.from(this.j),Array.from(this.g),Array.from(this.b,function(a){var b=la(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.o),this.C,this.u)]};g.ab=function(){var a=qj(this);if(a){this.j=new Set(a.s);this.g=new Set(a.g);for(var b=la(a.h),c=b.next();!c.done;c=b.next()){var d=la(c.value);c=d.next().value;d=d.next().value;d=Qq(this,d);this.b.set(c,d)}this.o=new Map(a.j);this.u=a.b||null;a.f&&this.enableMdnsDiscovery()}};
g.Ci=function(a){return this.b.get(a)};g.Ff=function(a,b){this.b.set(b.id,a);this.Ke(b)};g.ug=function(a){ly(this,a.id);this.b.delete(a.id);var b=this.s,c=a.id;b.f.delete(c);var d=b.b.get(c);d&&(b.b.delete(c),Xx(b,d),Wx(b));this.Ke(a)};g.Ke=function(){0<this.g.size&&this.K.h()};g.nl=function(a){var b=this.b.get(a.id);b&&(b.Ih(a.id),0<this.g.size&&this.lm())};
g.Vd=function(a,b){this.b.has(a)?("string"===typeof b||b instanceof Uint8Array||(b=JSON.stringify(b)),this.s.send(a,b)):v(this.l,"Got route message for closed route "+a)};g.onPresentationConnectionStateChanged=function(a,b){"terminated"==b&&this.s.s();this.f.onPresentationConnectionStateChanged(a,b)};g.onPresentationConnectionClosed=function(a,b,c){this.s.s();this.f.onPresentationConnectionClosed(a,b,c)};g.ej=function(a){this.m.delete(a);var b=this.b.get(a);b&&b.terminateRoute(a)};
g.Hh=function(a,b){hp(this.la,new Zx(a,b))};g.Wc=function(){this.U.h()};g.onSinkAvailabilityUpdated=function(a,b){var c=this;if(this.o.get(a.getName())!=b){var d=qy(this);this.o.set(a.getName(),b);a=qy(this);d!=a&&(0==a&&this.D(),this.f.onSinkAvailabilityUpdated(a),0==a&&(this.j.forEach(function(a){ny(c,a)}),this.j.clear()))}};var qy=function(a){return Array.from(a.o.values()).reduce(function(a,c){return Math.max(a,c)},0)};ey.prototype.Ei=function(){return this.la};ey.prototype.xd=function(a){this.f.onIssue(a)};
var ly=function(a,b){return a.m.has(b)?Rq(a,a.m.get(b)).then(function(c){a.m.delete(b);return Lg(c)}):Promise.resolve(!1)};g=ey.prototype;g.Vi=function(a,b,c,d){var e=this,f=a.De(b.sinkId);this.l.info("Starting mirroring using service: "+f);this.m.set(b.id,f);return Xf(Rq(this,f),function(h){e.u=f;return Og(h,b,b.mediaSource,a.tf(b.sinkId),c,d).catch(function(a){if(a instanceof Zf&&3==a.reason)throw new Ko(8);throw a;})})};
g.xl=function(a,b,c,d,e){var f=this,h=this.m.get(b.id);return h?Xf(Rq(this,h),function(k){f.u=h;var n=a.tf(b.sinkId);k.J.info("Update mirroring on route "+b.id);return k.g?Wf(Pg(k,b,c,n,d,e)):Vf(Error("Not initialized"))}):Vf(Error("Route "+b.id+" is not mirroring"))};g.vj=function(a){this.C?a():-1==this.F.indexOf(a)&&this.F.push(a)};g.Pi=function(){return this.C};g.Jf=function(a,b){var c=this.B.indexOf(a),d=0<=c;b&&!d?this.B.push(a):!b&&d&&this.B.splice(c,1);gy(this)};
var Qq=function(a,b){return a.h.find(function(a){return a.getName()==b})||null};g=ey.prototype;g.searchSinks=function(a,b,c){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?Qq(this,d):null)?d.searchSinks(b,c).then(function(a){return a.id}):Promise.reject(Error("No provider supports "+a))};g.provideSinks=function(a,b){var c=Qq(this,a);c?c.provideSinks(b):this.l.error("provideSinks: Provider not found for providerName "+a)};g.updateMediaSinks=function(a){this.j.has(a)||my(this,a)};
g.createMediaRouteController=function(a,b,c){var d=this,e=this.b.get(a);return e?e.createMediaRouteController(a,b,c).catch(function(a){d.l.error("createMediaRouteController failed: "+a.message);b.close();c.ptr.reset();throw a;}):(a="createMediaRouteController: Provider not found for "+a,this.l.error(a),b.close(),c.ptr.reset(),Promise.reject(Error(a)))};g.onMediaRemoterCreated=function(a,b,c){this.f.onMediaRemoterCreated(a,b,c)};
g.getMediaSinkServiceStatus=function(){return"function"!=typeof this.f.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.f.getMediaSinkServiceStatus()};var py=function(a,b,c,d,e,f,h){this.s=b;this.g=c;this.h=d;this.j=e;this.f=f;this.b=h};
